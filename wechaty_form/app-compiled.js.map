{"version":3,"sources":["app.js"],"names":[],"mappings":"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","file":"app-compiled.js","sourcesContent":["/**\r\n * Created by zhuozhuo on 2017/5/16.\r\n */\r\n//express_demo.js 文件\r\nvar express = require('express');\r\n//var router = express.Router()\r\nvar app = express();\r\nvar MongoClient = require('mongodb').MongoClient;\r\nvar DB_CONN_STR = 'mongodb://localhost:27017/runoob';\r\n//var contact=\"\"\r\napp.use(express.static('public'));\r\n\r\napp.get('/form', function (req, res) {\r\n    response={\r\n        contact:req.query.contact\r\n    }\r\n    contact=req.query.contact\r\n    console.log(req.query.contact)\r\n    //  res.render(contact:req.query.contact)\r\n    res.sendFile( __dirname + \"/public/\"+ \"form.html\" );\r\n})\r\n\r\n/*--------------------------form submit-----------------------*/\r\n\r\napp.get('/process_get', function (req, res) {\r\n   // console.log(response);\r\n    // 输出 JSON 格式\r\n    response = {\r\n        contact:contact,\r\n        name:req.query.name,\r\n        sex:req.query.sex,\r\n        age:req.query.age,\r\n        job:req.query.job,\r\n        hobby:req.query.hobby\r\n    };\r\n\r\n    var insertData = function(db, callback) {\r\n        //连接到表 site\r\n        var collection = db.collection('site');\r\n        //插入数据\r\n        var data = [{\"contact\":contact,\"name\":req.query.name,\"sex\":req.query.sex,\"age\":req.query.age,\"job\":req.query.job,\"hobby\":req.query.hobby,\"status\":0}];\r\n        collection.insert(data, function(err, result) {\r\n            if(err)\r\n            {\r\n                console.log('Error:'+ err);\r\n                return;\r\n            }\r\n            callback(result);\r\n        });\r\n    }\r\n\r\n    MongoClient.connect(DB_CONN_STR, function(err, db) {\r\n        console.log(\"连接成功！\");\r\n        insertData(db, function(result) {\r\n            console.log(result);\r\n            db.close();\r\n        });\r\n    });\r\n\r\n    console.log(response);\r\n    res.end(JSON.stringify(response));\r\n})\r\n\r\n\r\n/*-----------------------check---------------------------------*/\r\napp.get('/check', function (req, res) {\r\n    res.sendFile( __dirname + \"/public/\"+ \"check.html\" );\r\n})\r\n\r\napp.get('/check_get', function (req, res) {\r\n    // console.log(response);\r\n    // 输出 JSON 格式\r\n\r\n\r\n    var selectData = function (db, callback) {\r\n        //连接到表\r\n        var collection = db.collection('site');\r\n        //查询数据\r\n        var array = {\"status\": 0};\r\n        collection.find(array).toArray(function (err, result) {\r\n            if (err) {\r\n                console.log('Error:' + err);\r\n                return;\r\n            }\r\n            callback(result);\r\n\r\n        });\r\n    }\r\n\r\n    MongoClient.connect(DB_CONN_STR, function (err, db) {\r\n        console.log(\"连接成功！\");\r\n        selectData(db, function (result) {\r\n            console.log(result);\r\n            response = {\r\n                contact: result.contact,\r\n                name: result.name,\r\n                sex: result.sex,\r\n                age: result.age,\r\n                job: result.job,\r\n                hobby: result.hobby\r\n            };\r\n            res.end(JSON.stringify(result));\r\n            db.close();\r\n        });\r\n    });\r\n})\r\n\r\napp.get('/accept_get', function (req, res) {\r\n   // console.log(response);\r\n    var updateData = function(db, callback) {\r\n     //连接到表\r\n     var collection = db.collection('site');\r\n     //更新数据\r\n     var whereStr = {\"contact\":req.query.contact};\r\n        console.log(req.query.contact)\r\n     var updateStr=\"\";\r\n        if(req.query.accept=1){\r\n            updateStr = {$set: { \"status\" : 1 }};\r\n        }\r\n        else if(req.query.accept=2){\r\n            updateStr = {$set: { \"status\" : 2 }};\r\n        }\r\n     collection.update(whereStr,updateStr, function(err, result) {\r\n     if(err)\r\n     {\r\n     console.log('Error:'+ err);\r\n     return;\r\n     }\r\n     callback(result);\r\n     });\r\n     }\r\n\r\n     MongoClient.connect(DB_CONN_STR, function(err, db) {\r\n     console.log(\"连接成功！\");\r\n     updateData(db, function(result) {\r\n     console.log(result);\r\n     db.close();\r\n     });\r\n     });\r\n})\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nvar server = app.listen(8081, function () {\r\n\r\n    var host = server.address().address\r\n    var port = server.address().port\r\n\r\n    console.log(`应用实例，访问地址为 http://%s:%s`, host, port)\r\n})"]}