{"version":3,"sources":["pre.test.js"],"names":[],"mappings":"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","file":"pre.test-compiled.js","sourcesContent":["var assert = require('assert');\nvar Kareem = require('../');\n\ndescribe('execPre', function() {\n  var hooks;\n\n  beforeEach(function() {\n    hooks = new Kareem();\n  });\n\n  it('handles errors with multiple pres', function(done) {\n    var execed = {};\n\n    hooks.pre('cook', function(done) {\n      execed.first = true;\n      done();\n    });\n\n    hooks.pre('cook', function(done) {\n      execed.second = true;\n      done('error!');\n    });\n\n    hooks.pre('cook', function(done) {\n      execed.third = true;\n      done();\n    });\n\n    hooks.execPre('cook', null, function(err) {\n      assert.equal('error!', err);\n      assert.equal(2, Object.keys(execed).length);\n      assert.ok(execed.first);\n      assert.ok(execed.second);\n      done();\n    });\n  });\n\n  it('handles async errors', function(done) {\n    var execed = {};\n\n    hooks.pre('cook', true, function(next, done) {\n      execed.first = true;\n      setTimeout(\n        function() {\n          done('error!');\n        },\n        5);\n\n      next();\n    });\n\n    hooks.pre('cook', true, function(next, done) {\n      execed.second = true;\n      setTimeout(\n        function() {\n          done('other error!');\n        },\n        10);\n\n      next();\n    });\n\n    hooks.execPre('cook', null, function(err) {\n      assert.equal('error!', err);\n      assert.equal(2, Object.keys(execed).length);\n      assert.ok(execed.first);\n      assert.ok(execed.second);\n      done();\n    });\n  });\n\n  it('handles async errors in next()', function(done) {\n    var execed = {};\n\n    hooks.pre('cook', true, function(next, done) {\n      execed.first = true;\n      setTimeout(\n        function() {\n          done('other error!');\n        },\n        15);\n\n      next();\n    });\n\n    hooks.pre('cook', true, function(next, done) {\n      execed.second = true;\n      setTimeout(\n        function() {\n          next('error!');\n          done('another error!');\n        },\n        5);\n    });\n\n    hooks.execPre('cook', null, function(err) {\n      assert.equal('error!', err);\n      assert.equal(2, Object.keys(execed).length);\n      assert.ok(execed.first);\n      assert.ok(execed.second);\n      done();\n    });\n  });\n\n  it('handles async errors in next() when already done', function(done) {\n    var execed = {};\n\n    hooks.pre('cook', true, function(next, done) {\n      execed.first = true;\n      setTimeout(\n        function() {\n          done('other error!');\n        },\n        5);\n\n      next();\n    });\n\n    hooks.pre('cook', true, function(next, done) {\n      execed.second = true;\n      setTimeout(\n        function() {\n          next('error!');\n          done('another error!');\n        },\n        25);\n    });\n\n    hooks.execPre('cook', null, function(err) {\n      assert.equal('other error!', err);\n      assert.equal(2, Object.keys(execed).length);\n      assert.ok(execed.first);\n      assert.ok(execed.second);\n      done();\n    });\n  });\n\n  it('async pres with clone()', function(done) {\n    var execed = false;\n\n    hooks.pre('cook', true, function(next, done) {\n      execed = true;\n      setTimeout(\n        function() {\n          done();\n        },\n        5);\n\n      next();\n    });\n\n    hooks.clone().execPre('cook', null, function(err) {\n      assert.ifError(err);\n      assert.ok(execed);\n      done();\n    });\n  });\n\n  it('returns correct error when async pre errors', function(done) {\n    var execed = {};\n\n    hooks.pre('cook', true, function(next, done) {\n      execed.first = true;\n      setTimeout(\n        function() {\n          done('other error!');\n        },\n        5);\n\n      next();\n    });\n\n    hooks.pre('cook', function(next) {\n      execed.second = true;\n      setTimeout(\n        function() {\n          next('error!');\n        },\n        15);\n    });\n\n    hooks.execPre('cook', null, function(err) {\n      assert.equal('other error!', err);\n      assert.equal(2, Object.keys(execed).length);\n      assert.ok(execed.first);\n      assert.ok(execed.second);\n      done();\n    });\n  });\n\n  it('lets async pres run when fully sync pres are done', function(done) {\n    var execed = {};\n\n    hooks.pre('cook', true, function(next, done) {\n      execed.first = true;\n      setTimeout(\n        function() {\n          done();\n        },\n        5);\n\n      next();\n    });\n\n    hooks.pre('cook', function() {\n      execed.second = true;\n    });\n\n    hooks.execPre('cook', null, function(err) {\n      assert.ifError(err);\n      assert.equal(2, Object.keys(execed).length);\n      assert.ok(execed.first);\n      assert.ok(execed.second);\n      done();\n    });\n  });\n\n  it('allows passing arguments to the next pre', function(done) {\n    var execed = {};\n\n    hooks.pre('cook', function(next) {\n      execed.first = true;\n      next(null, 'test');\n    });\n\n    hooks.pre('cook', function(next, p) {\n      execed.second = true;\n      assert.equal(p, 'test');\n      next();\n    });\n\n    hooks.pre('cook', function(next, p) {\n      execed.third = true;\n      assert.ok(!p);\n      next();\n    });\n\n    hooks.execPre('cook', null, function(err) {\n      assert.ifError(err);\n      assert.equal(3, Object.keys(execed).length);\n      assert.ok(execed.first);\n      assert.ok(execed.second);\n      assert.ok(execed.third);\n      done();\n    });\n  });\n});\n\ndescribe('execPreSync', function() {\n  var hooks;\n\n  beforeEach(function() {\n    hooks = new Kareem();\n  });\n\n  it('executes hooks synchronously', function() {\n    var execed = {};\n\n    hooks.pre('cook', function() {\n      execed.first = true;\n    });\n\n    hooks.pre('cook', function() {\n      execed.second = true;\n    });\n\n    hooks.execPreSync('cook', null);\n    assert.ok(execed.first);\n    assert.ok(execed.second);\n  });\n\n  it('works with no hooks specified', function() {\n    assert.doesNotThrow(function() {\n      hooks.execPreSync('cook', null);\n    });\n  });\n});\n"]}