{"version":3,"sources":["promise_flow_test.js"],"names":[],"mappings":"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","file":"promise_flow_test-compiled.js","sourcesContent":["// Licensed to the Software Freedom Conservancy (SFC) under one\n// or more contributor license agreements.  See the NOTICE file\n// distributed with this work for additional information\n// regarding copyright ownership.  The SFC licenses this file\n// to you under the Apache License, Version 2.0 (the\n// \"License\"); you may not use this file except in compliance\n// with the License.  You may obtain a copy of the License at\n//\n//   http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing,\n// software distributed under the License is distributed on an\n// \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n// KIND, either express or implied.  See the License for the\n// specific language governing permissions and limitations\n// under the License.\n\n'use strict';\n\nconst assert = require('assert');\nconst fail = assert.fail;\nconst sinon = require('sinon');\n\nconst testutil = require('./testutil');\nconst {TimeoutError} = require('../../lib/error');\nconst promise = require('../../lib/promise');\nconst {enablePromiseManager} = require('../../lib/test/promise');\n\nconst NativePromise = Promise;\n\n// Aliases for readability.\nconst StubError = testutil.StubError;\nconst assertIsStubError = testutil.assertIsStubError;\nconst callbackPair = testutil.callbackPair;\nconst throwStubError = testutil.throwStubError;\n\ndescribe('promise control flow', function() {\n  enablePromiseManager(() => {\n    let flow, flowHistory, messages, uncaughtExceptions;\n\n    beforeEach(function setUp() {\n      promise.LONG_STACK_TRACES = false;\n      flow = new promise.ControlFlow();\n      promise.setDefaultFlow(flow);\n      messages = [];\n      flowHistory = [];\n\n      uncaughtExceptions = [];\n      flow.on(promise.ControlFlow.EventType.UNCAUGHT_EXCEPTION,\n              onUncaughtException);\n    });\n\n    afterEach(function tearDown() {\n      flow.removeAllListeners(\n          promise.ControlFlow.EventType.UNCAUGHT_EXCEPTION);\n      assert.deepEqual([], uncaughtExceptions,\n          'There were uncaught exceptions');\n      flow.reset();\n      promise.LONG_STACK_TRACES = false;\n    });\n\n    function onUncaughtException(e) {\n      uncaughtExceptions.push(e);\n    }\n\n    function defer() {\n      let d = {};\n      let promise = new Promise((resolve, reject) => {\n        Object.assign(d, {resolve, reject});\n      });\n      d.promise = promise;\n      return d;\n    }\n\n    function waitForAbort(opt_flow) {\n      var theFlow = opt_flow || flow;\n      theFlow.removeAllListeners(\n          promise.ControlFlow.EventType.UNCAUGHT_EXCEPTION);\n      return new NativePromise(function(fulfill, reject) {\n        theFlow.once(promise.ControlFlow.EventType.IDLE, function() {\n          reject(Error('expected flow to report an unhandled error'));\n        });\n        theFlow.once(\n            promise.ControlFlow.EventType.UNCAUGHT_EXCEPTION,\n            fulfill);\n      });\n    }\n\n    function waitForIdle(opt_flow) {\n      var theFlow = opt_flow || flow;\n      return new NativePromise(function(fulfill, reject) {\n        theFlow.once(promise.ControlFlow.EventType.IDLE, fulfill);\n        theFlow.once(\n            promise.ControlFlow.EventType.UNCAUGHT_EXCEPTION, reject);\n      });\n    }\n\n    function timeout(ms) {\n      return new NativePromise(function(fulfill) {\n        setTimeout(fulfill, ms);\n      });\n    }\n\n\n    function schedule(msg, opt_return) {\n      return scheduleAction(msg, function() {\n        return opt_return;\n      });\n    }\n\n    /**\n     * @param {string} value The value to push.\n     * @param {promise.Promise=} opt_taskPromise Promise to return from\n     *     the task.\n     * @return {!promise.Promise} The result.\n     */\n    function schedulePush(value, opt_taskPromise) {\n      return scheduleAction(value, function() {\n        messages.push(value);\n        return opt_taskPromise;\n      });\n    }\n\n    /**\n     * @param {string} msg Debug message.\n     * @param {!Function} actionFn The function.\n     * @return {!promise.Promise} The function result.\n     */\n    function scheduleAction(msg, actionFn) {\n      return promise.controlFlow().execute(function() {\n        flowHistory.push(msg);\n        return actionFn();\n      }, msg);\n    }\n\n    /**\n     * @param {!Function} condition The condition function.\n     * @param {number=} opt_timeout The timeout.\n     * @param {string=} opt_message Optional message.\n     * @return {!promise.Promise} The wait result.\n     */\n    function scheduleWait(condition, opt_timeout, opt_message) {\n      var msg = opt_message || '';\n      // It's not possible to hook into when the wait itself is scheduled, so\n      // we record each iteration of the wait loop.\n      var count = 0;\n      return promise.controlFlow().wait(function() {\n        flowHistory.push((count++) + ': ' + msg);\n        return condition();\n      }, opt_timeout, msg);\n    }\n\n    function asyncRun(fn, opt_self) {\n      NativePromise.resolve().then(() => fn.call(opt_self));\n    }\n\n    function assertFlowHistory(var_args) {\n      var expected = Array.prototype.slice.call(arguments, 0);\n      assert.deepEqual(expected, flowHistory);\n    }\n\n    function assertMessages(var_args) {\n      var expected = Array.prototype.slice.call(arguments, 0);\n      assert.deepEqual(expected, messages);\n    }\n\n    function assertingMessages(var_args) {\n      var args = Array.prototype.slice.call(arguments, 0);\n      return () => assertMessages.apply(null, args);\n    }\n\n    function assertFlowIs(flow) {\n      assert.equal(flow, promise.controlFlow());\n    }\n\n    describe('testScheduling', function() {\n      it('aSimpleFunction', function() {\n        schedule('go');\n        return waitForIdle().then(function() {\n          assertFlowHistory('go');\n        });\n      });\n\n      it('aSimpleFunctionWithANonPromiseReturnValue', function() {\n        schedule('go', 123).then(function(value) {\n          assert.equal(123, value);\n        });\n        return waitForIdle().then(function() {\n          assertFlowHistory('go');\n        });\n      });\n\n      it('aSimpleSequence', function() {\n        schedule('a');\n        schedule('b');\n        schedule('c');\n        return waitForIdle().then(function() {\n          assertFlowHistory('a', 'b', 'c');\n        });\n      });\n\n      it('invokesCallbacksWhenTaskIsDone', function() {\n        var d = new promise.Deferred();\n        var called = false;\n        var done = schedule('a', d.promise).then(function(value) {\n          called = true;\n          assert.equal(123, value);\n        });\n        return timeout(5).then(function() {\n          assert.ok(!called);\n          d.fulfill(123);\n          return done;\n        }).\n        then(function() {\n          assertFlowHistory('a');\n        });\n      });\n\n      it('blocksUntilPromiseReturnedByTaskIsResolved', function() {\n        var done = promise.defer();\n        schedulePush('a', done.promise);\n        schedulePush('b');\n        setTimeout(function() {\n          done.fulfill();\n          messages.push('c');\n        }, 25);\n        return waitForIdle().then(assertingMessages('a', 'c', 'b'));\n      });\n\n      it('waitsForReturnedPromisesToResolve', function() {\n        var d1 = new promise.Deferred();\n        var d2 = new promise.Deferred();\n\n        var callback = sinon.spy();\n        schedule('a', d1.promise).then(callback);\n\n        return timeout(5).then(function() {\n          assert(!callback.called);\n          d1.fulfill(d2.promise);\n          return timeout(5);\n        }).then(function() {\n          assert(!callback.called);\n          d2.fulfill('fluffy bunny');\n          return waitForIdle();\n        }).then(function() {\n          assert(callback.called);\n          assert.equal('fluffy bunny', callback.getCall(0).args[0]);\n          assertFlowHistory('a');\n        });\n      });\n\n      it('executesTasksInAFutureTurnAfterTheyAreScheduled', function() {\n        var count = 0;\n        function incr() { count++; }\n\n        scheduleAction('', incr);\n        assert.equal(0, count);\n        return waitForIdle().then(function() {\n          assert.equal(1, count);\n        });\n      });\n\n      it('executesOneTaskPerTurnOfTheEventLoop', function() {\n        var order = [];\n        function go() {\n          order.push(order.length / 2);\n          asyncRun(function() {\n            order.push('-');\n          });\n        }\n\n        scheduleAction('', go);\n        scheduleAction('', go);\n        return waitForIdle().then(function() {\n          assert.deepEqual([0, '-', 1, '-'], order);\n        })\n      });\n\n      it('firstScheduledTaskIsWithinACallback', function() {\n        promise.fulfilled().then(function() {\n          schedule('a');\n          schedule('b');\n          schedule('c');\n        }).then(function() {\n          assertFlowHistory('a', 'b', 'c');\n        });\n        return waitForIdle();\n      });\n\n      it('newTasksAddedWhileWaitingOnTaskReturnedPromise1', function() {\n        scheduleAction('a', function() {\n          var d = promise.defer();\n          setTimeout(function() {\n            schedule('c');\n            d.fulfill();\n          }, 10);\n          return d.promise;\n        });\n        schedule('b');\n        return waitForIdle().then(function() {\n          assertFlowHistory('a', 'b', 'c');\n        });\n      });\n\n      it('newTasksAddedWhileWaitingOnTaskReturnedPromise2', function() {\n        scheduleAction('a', function() {\n          var d = promise.defer();\n          setTimeout(function() {\n            schedule('c');\n            asyncRun(d.fulfill);\n          }, 10);\n          return d.promise;\n        });\n        schedule('b');\n        return waitForIdle().then(function() {\n          assertFlowHistory('a', 'c', 'b');\n        });\n      });\n    });\n\n    describe('testFraming', function() {\n      it('callbacksRunInANewFrame', function() {\n        schedule('a').then(function() {\n          schedule('c');\n        });\n        schedule('b');\n        return waitForIdle().then(function() {\n          assertFlowHistory('a', 'c', 'b');\n        });\n      });\n\n      it('lotsOfNesting', function() {\n        schedule('a').then(function() {\n          schedule('c').then(function() {\n            schedule('e').then(function() {\n              schedule('g');\n            });\n            schedule('f');\n          });\n          schedule('d');\n        });\n        schedule('b');\n\n        return waitForIdle().then(function() {\n          assertFlowHistory('a', 'c', 'e', 'g', 'f', 'd', 'b');\n        });\n      });\n\n      it('callbackReturnsPromiseThatDependsOnATask_1', function() {\n        schedule('a').then(function() {\n          schedule('b');\n          return promise.delayed(5).then(function() {\n            return schedule('c');\n          });\n        });\n        schedule('d');\n\n        return waitForIdle().then(function() {\n          assertFlowHistory('a', 'b', 'c', 'd');\n        });\n      });\n\n      it('callbackReturnsPromiseThatDependsOnATask_2', function() {\n        schedule('a').then(function() {\n          schedule('b');\n          return promise.delayed(5).\n              then(function() { return promise.delayed(5) }).\n              then(function() { return promise.delayed(5) }).\n              then(function() { return promise.delayed(5) }).\n              then(function() { return schedule('c'); });\n        });\n        schedule('d');\n\n        return waitForIdle().then(function() {\n          assertFlowHistory('a', 'b', 'c', 'd');\n        });\n      });\n\n      it('eachCallbackWaitsForAllScheduledTasksToComplete', function() {\n        schedule('a').\n            then(function() {\n              schedule('b');\n              schedule('c');\n            }).\n            then(function() {\n              schedule('d');\n            });\n        schedule('e');\n\n        return waitForIdle().then(function() {\n          assertFlowHistory('a', 'b', 'c', 'd', 'e');\n        });\n      });\n\n      it('eachCallbackWaitsForReturnTasksToComplete', function() {\n        schedule('a').\n            then(function() {\n              schedule('b');\n              return schedule('c');\n            }).\n            then(function() {\n              schedule('d');\n            });\n        schedule('e');\n\n        return waitForIdle().then(function() {\n          assertFlowHistory('a', 'b', 'c', 'd', 'e');\n        });\n      });\n\n      it('callbacksOnAResolvedPromiseInsertIntoTheCurrentFlow', function() {\n        promise.fulfilled().then(function() {\n          schedule('b');\n        });\n        schedule('a');\n\n        return waitForIdle().then(function() {\n          assertFlowHistory('b', 'a');\n        });\n      });\n\n      it('callbacksInterruptTheFlowWhenPromiseIsResolved', function() {\n        schedule('a').then(function() {\n          schedule('c');\n        });\n        schedule('b');\n\n        return waitForIdle().then(function() {\n          assertFlowHistory('a', 'c', 'b');\n        });\n      });\n\n      it('allCallbacksInAFrameAreScheduledWhenPromiseIsResolved', function() {\n        var a = schedule('a');\n        a.then(function() { schedule('b'); });\n        schedule('c');\n        a.then(function() { schedule('d'); });\n        schedule('e');\n\n        return waitForIdle().then(function() {\n          assertFlowHistory('a', 'b', 'c', 'd', 'e');\n        });\n      });\n\n      it('tasksScheduledInInActiveFrameDoNotGetPrecedence', function() {\n        var d = promise.fulfilled();\n        schedule('a');\n        schedule('b');\n        d.then(function() { schedule('c'); });\n\n        return waitForIdle().then(function() {\n          assertFlowHistory('a', 'b', 'c');\n        });\n      });\n\n      it('tasksScheduledInAFrameGetPrecedence_1', function() {\n        var a = schedule('a');\n        schedule('b').then(function() {\n          a.then(function() {\n            schedule('c');\n            schedule('d');\n          });\n          var e = schedule('e');\n          a.then(function() {\n            schedule('f');\n            e.then(function() {\n              schedule('g');\n            });\n            schedule('h');\n          });\n          schedule('i');\n        });\n        schedule('j');\n\n        return waitForIdle().then(function() {\n          assertFlowHistory('a', 'b', 'c', 'd', 'e', 'f', 'g', 'h', 'i', 'j');\n        });\n      });\n    });\n\n    describe('testErrorHandling', function() {\n      it('thrownErrorsArePassedToTaskErrback', function() {\n        scheduleAction('function that throws', throwStubError).\n            then(fail, assertIsStubError);\n        return waitForIdle();\n      });\n\n      it('thrownErrorsPropagateThroughPromiseChain', function() {\n        scheduleAction('function that throws', throwStubError).\n            then(fail).\n            then(fail, assertIsStubError);\n        return waitForIdle();\n      });\n\n      it('catchesErrorsFromFailedTasksInAFrame', function() {\n        schedule('a').then(function() {\n          schedule('b');\n          scheduleAction('function that throws', throwStubError);\n        }).\n        then(fail, assertIsStubError);\n        return waitForIdle();\n      });\n\n      it('abortsIfOnlyTaskReturnsAnUnhandledRejection', function() {\n        scheduleAction('function that returns rejected promise', function() {\n          return promise.rejected(new StubError);\n        });\n        return waitForAbort().then(assertIsStubError);\n      });\n\n      it('abortsIfThereIsAnUnhandledRejection', function() {\n        promise.rejected(new StubError);\n        schedule('this should not run');\n        return waitForAbort().\n            then(assertIsStubError).\n            then(function() {\n              assertFlowHistory(/* none */);\n            });\n      });\n\n      it('abortsSequenceIfATaskFails', function() {\n        schedule('a');\n        schedule('b');\n        scheduleAction('c', throwStubError);\n        schedule('d');  // Should never execute.\n\n        return waitForAbort().\n            then(assertIsStubError).\n            then(function() {\n              assertFlowHistory('a', 'b', 'c');\n            });\n      });\n\n      it('abortsFromUnhandledFramedTaskFailures_1', function() {\n        schedule('outer task').then(function() {\n          scheduleAction('inner task', throwStubError);\n        });\n        schedule('this should not run');\n        return waitForAbort().\n            then(assertIsStubError).\n            then(function() {\n              assertFlowHistory('outer task', 'inner task');\n            });\n      });\n\n      it('abortsFromUnhandledFramedTaskFailures_2', function() {\n        schedule('a').then(function() {\n          schedule('b').then(function() {\n            scheduleAction('c', throwStubError);\n            // This should not execute.\n            schedule('d');\n          });\n        });\n\n        return waitForAbort().\n            then(assertIsStubError).\n            then(function() {\n              assertFlowHistory('a', 'b', 'c');\n            });\n      });\n\n      it('abortsWhenErrorBubblesUpFromFullyResolvingAnObject', function() {\n        var callback = sinon.spy();\n\n        scheduleAction('', function() {\n          var obj = {'foo': promise.rejected(new StubError)};\n          return promise.fullyResolved(obj).then(callback);\n        });\n\n        return waitForAbort().\n            then(assertIsStubError).\n            then(() => assert(!callback.called));\n      });\n\n      it('abortsWhenErrorBubblesUpFromFullyResolvingAnObject_withCallback', function() {\n        var callback1 = sinon.spy();\n        var callback2 = sinon.spy();\n\n        scheduleAction('', function() {\n          var obj = {'foo': promise.rejected(new StubError)};\n          return promise.fullyResolved(obj).then(callback1);\n        }).then(callback2);\n\n        return waitForAbort().\n            then(assertIsStubError).\n            then(() => assert(!callback1.called)).\n            then(() => assert(!callback2.called));\n      });\n\n      it('canCatchErrorsFromNestedTasks', function() {\n        var errback = sinon.spy();\n        schedule('a').\n            then(function() {\n              return scheduleAction('b', throwStubError);\n            }).\n            catch(errback);\n        return waitForIdle().then(function() {\n          assert(errback.called);\n          assertIsStubError(errback.getCall(0).args[0]);\n        });\n      });\n\n      it('nestedCommandFailuresCanBeCaughtAndSuppressed', function() {\n        var errback = sinon.spy();\n        schedule('a').then(function() {\n          return schedule('b').then(function() {\n            return schedule('c').then(function() {\n              throw new StubError;\n            });\n          });\n        }).catch(errback);\n        schedule('d');\n        return waitForIdle().\n            then(function() {\n              assert(errback.called);\n              assertIsStubError(errback.getCall(0).args[0]);\n              assertFlowHistory('a', 'b', 'c', 'd');\n            });\n      });\n\n      it('aTaskWithAnUnhandledPromiseRejection', function() {\n        schedule('a');\n        scheduleAction('sub-tasks', function() {\n          promise.rejected(new StubError);\n        });\n        schedule('should never run');\n\n        return waitForAbort().\n            then(assertIsStubError).\n            then(function() {\n              assertFlowHistory('a', 'sub-tasks');\n            });\n      });\n\n      it('aTaskThatReutrnsARejectedPromise', function() {\n        schedule('a');\n        scheduleAction('sub-tasks', function() {\n          return promise.rejected(new StubError);\n        });\n        schedule('should never run');\n\n        return waitForAbort().\n            then(assertIsStubError).\n            then(function() {\n              assertFlowHistory('a', 'sub-tasks');\n            });\n      });\n\n      it('discardsSubtasksIfTaskThrows', function() {\n        var pair = callbackPair(null, assertIsStubError);\n        scheduleAction('a', function() {\n          schedule('b');\n          schedule('c');\n          throwStubError();\n        }).then(pair.callback, pair.errback);\n        schedule('d');\n\n        return waitForIdle().\n            then(pair.assertErrback).\n            then(function() {\n              assertFlowHistory('a', 'd');\n            });\n      });\n\n      it('discardsRemainingSubtasksIfASubtaskFails', function() {\n        var pair = callbackPair(null, assertIsStubError);\n        scheduleAction('a', function() {\n          schedule('b');\n          scheduleAction('c', throwStubError);\n          schedule('d');\n        }).then(pair.callback, pair.errback);\n        schedule('e');\n\n        return waitForIdle().\n            then(pair.assertErrback).\n            then(function() {\n              assertFlowHistory('a', 'b', 'c', 'e');\n            });\n      });\n    });\n\n    describe('testTryModelingFinally', function() {\n      it('happyPath', function() {\n        /* Model:\n           try {\n             doFoo();\n             doBar();\n           } finally {\n             doBaz();\n           }\n         */\n        schedulePush('foo').\n            then(() => schedulePush('bar')).\n            finally(() => schedulePush('baz'));\n        return waitForIdle().then(assertingMessages('foo', 'bar', 'baz'));\n      });\n\n      it('firstTryFails', function() {\n        /* Model:\n           try {\n             doFoo();\n             doBar();\n           } finally {\n             doBaz();\n           }\n         */\n\n        scheduleAction('doFoo and throw', function() {\n          messages.push('foo');\n          throw new StubError;\n        }).\n        then(function() { schedulePush('bar'); }).\n        finally(function() { schedulePush('baz'); });\n\n        return waitForAbort().\n            then(assertIsStubError).\n            then(assertingMessages('foo', 'baz'));\n      });\n\n      it('secondTryFails', function() {\n        /* Model:\n           try {\n             doFoo();\n             doBar();\n           } finally {\n             doBaz();\n           }\n         */\n\n        schedulePush('foo').\n            then(function() {\n              return scheduleAction('doBar and throw', function() {\n                messages.push('bar');\n                throw new StubError;\n              });\n            }).\n            finally(function() {\n              return schedulePush('baz');\n            });\n        return waitForAbort().\n            then(assertIsStubError).\n            then(assertingMessages('foo', 'bar', 'baz'));\n      });\n    });\n\n    describe('testTaskCallbacksInterruptFlow', function() {\n      it('(base case)', function() {\n        schedule('a').then(function() {\n          schedule('b');\n        });\n        schedule('c');\n        return waitForIdle().then(function() {\n          assertFlowHistory('a', 'b', 'c');\n        });\n      });\n\n      it('taskDependsOnImmediatelyFulfilledPromise', function() {\n        scheduleAction('a', function() {\n          return promise.fulfilled();\n        }).then(function() {\n          schedule('b');\n        });\n        schedule('c');\n        return waitForIdle().then(function() {\n          assertFlowHistory('a', 'b', 'c');\n        });\n      });\n\n      it('taskDependsOnPreviouslyFulfilledPromise', function() {\n        var aPromise = promise.fulfilled(123);\n        scheduleAction('a', function() {\n          return aPromise;\n        }).then(function(value) {\n          assert.equal(123, value);\n          schedule('b');\n        });\n        schedule('c');\n        return waitForIdle().then(function() {\n          assertFlowHistory('a', 'b', 'c');\n        });\n      });\n\n      it('taskDependsOnAsyncPromise', function() {\n        scheduleAction('a', function() {\n          return promise.delayed(25);\n        }).then(function() {\n          schedule('b');\n        });\n        schedule('c');\n        return waitForIdle().then(function() {\n          assertFlowHistory('a', 'b', 'c');\n        });\n      });\n\n      it('promiseChainedToTaskInterruptFlow', function() {\n        schedule('a').then(function() {\n          return promise.fulfilled();\n        }).then(function() {\n          return promise.fulfilled();\n        }).then(function() {\n          schedule('b');\n        });\n        schedule('c');\n        return waitForIdle().then(function() {\n          assertFlowHistory('a', 'b', 'c');\n        });\n      });\n\n      it('nestedTaskCallbacksInterruptFlowWhenResolved', function() {\n        schedule('a').then(function() {\n          schedule('b').then(function() {\n            schedule('c');\n          });\n        });\n        schedule('d');\n        return waitForIdle().then(function() {\n          assertFlowHistory('a', 'b', 'c', 'd');\n        });\n      });\n    });\n\n    describe('testDelayedNesting', function() {\n\n      it('1', function() {\n        var a = schedule('a');\n        schedule('b').then(function() {\n          a.then(function() { schedule('c'); });\n          schedule('d');\n        });\n        schedule('e');\n\n        return waitForIdle().then(function() {\n          assertFlowHistory('a', 'b', 'c', 'd', 'e');\n        });\n      });\n\n      it('2', function() {\n        var a = schedule('a');\n        schedule('b').then(function() {\n          a.then(function() { schedule('c'); });\n          schedule('d');\n          a.then(function() { schedule('e'); });\n        });\n        schedule('f');\n\n        return waitForIdle().then(function() {\n          assertFlowHistory('a', 'b', 'c', 'd', 'e', 'f');\n        });\n      });\n\n      it('3', function() {\n        var a = schedule('a');\n        schedule('b').then(function() {\n          a.then(function() { schedule('c'); });\n          a.then(function() { schedule('d'); });\n        });\n        schedule('e');\n\n        return waitForIdle().then(function() {\n          assertFlowHistory('a', 'b', 'c', 'd', 'e');\n        });\n      });\n\n      it('4', function() {\n        var a = schedule('a');\n        schedule('b').then(function() {\n          a.then(function() { schedule('c'); }).then(function() {\n            schedule('d');\n          });\n          a.then(function() { schedule('e'); });\n        });\n        schedule('f');\n\n        return waitForIdle().then(function() {\n          assertFlowHistory('a', 'b', 'c', 'd', 'e', 'f');\n        });\n      });\n\n      it('5', function() {\n        var a = schedule('a');\n        schedule('b').then(function() {\n          var c;\n          a.then(function() { c = schedule('c'); }).then(function() {\n            schedule('d');\n            a.then(function() { schedule('e'); });\n            c.then(function() { schedule('f'); });\n            schedule('g');\n          });\n          a.then(function() { schedule('h'); });\n        });\n        schedule('i');\n\n        return waitForIdle().then(function() {\n          assertFlowHistory('a', 'b', 'c', 'd', 'e', 'f', 'g', 'h', 'i');\n        });\n      });\n    });\n\n    describe('testWaiting', function() {\n      it('onAConditionThatIsAlwaysTrue', function() {\n        scheduleWait(function() { return true;}, 0, 'waiting on true');\n        return waitForIdle().then(function() {\n          assertFlowHistory('0: waiting on true');\n        });\n      });\n\n      it('aSimpleCountingCondition', function() {\n        var count = 0;\n        scheduleWait(function() {\n          return ++count == 3;\n        }, 100, 'counting to 3');\n\n        return waitForIdle().then(function() {\n          assert.equal(3, count);\n        });\n      });\n\n      it('aConditionThatReturnsAPromise', function() {\n        var d = new promise.Deferred();\n        var count = 0;\n\n        scheduleWait(function() {\n          count += 1;\n          return d.promise;\n        }, 0, 'waiting for promise');\n\n        return timeout(50).then(function() {\n          assert.equal(1, count);\n          d.fulfill(123);\n          return waitForIdle();\n        });\n      });\n\n      it('aConditionThatReturnsAPromise_2', function() {\n        var count = 0;\n        scheduleWait(function() {\n          return promise.fulfilled(++count == 3);\n        }, 100, 'waiting for promise');\n\n        return waitForIdle().then(function() {\n          assert.equal(3, count);\n        });\n      });\n\n      it('aConditionThatReturnsATaskResult', function() {\n        var count = 0;\n        scheduleWait(function() {\n          return scheduleAction('increment count', function() {\n            return ++count == 3;\n          });\n        }, 100, 'counting to 3');\n        schedule('post wait');\n\n        return waitForIdle().then(function() {\n          assert.equal(3, count);\n          assertFlowHistory(\n              '0: counting to 3', 'increment count',\n              '1: counting to 3', 'increment count',\n              '2: counting to 3', 'increment count',\n              'post wait');\n        });\n      });\n\n      it('conditionContainsASubtask', function() {\n        var count = 0;\n        scheduleWait(function() {\n          schedule('sub task');\n          return ++count == 3;\n        }, 100, 'counting to 3');\n        schedule('post wait');\n\n        return waitForIdle().then(function() {\n          assert.equal(3, count);\n          assertFlowHistory(\n              '0: counting to 3', 'sub task',\n              '1: counting to 3', 'sub task',\n              '2: counting to 3', 'sub task',\n              'post wait');\n        });\n      });\n\n      it('cancelsWaitIfScheduledTaskFails', function() {\n        var pair = callbackPair(null, assertIsStubError);\n        scheduleWait(function() {\n          scheduleAction('boom', throwStubError);\n          schedule('this should not run');\n          return true;\n        }, 100, 'waiting to go boom').then(pair.callback, pair.errback);\n        schedule('post wait');\n\n        return waitForIdle().\n            then(pair.assertErrback).\n            then(function() {\n              assertFlowHistory(\n                  '0: waiting to go boom', 'boom',\n                  'post wait');\n            });\n      });\n\n      it('failsIfConditionThrows', function() {\n        var callbacks = callbackPair(null, assertIsStubError);\n        scheduleWait(throwStubError, 0, 'goes boom').\n            then(callbacks.callback, callbacks.errback);\n        schedule('post wait');\n\n        return waitForIdle().\n            then(callbacks.assertErrback).\n            then(function() {\n              assertFlowHistory('0: goes boom', 'post wait');\n            });\n      });\n\n      it('failsIfConditionReturnsARejectedPromise', function() {\n        var callbacks = callbackPair(null, assertIsStubError);\n        scheduleWait(function() {\n          return promise.rejected(new StubError);\n        }, 0, 'goes boom').then(callbacks.callback, callbacks.errback);\n        schedule('post wait');\n\n        return waitForIdle().\n            then(callbacks.assertErrback).\n            then(function() {\n              assertFlowHistory('0: goes boom', 'post wait');\n            });\n      });\n\n      it('failsIfConditionHasUnhandledRejection', function() {\n        var callbacks = callbackPair(null, assertIsStubError);\n        scheduleWait(function() {\n          promise.controlFlow().execute(throwStubError);\n        }, 0, 'goes boom').then(callbacks.callback, callbacks.errback);\n        schedule('post wait');\n\n        return waitForIdle().\n            then(callbacks.assertErrback).\n            then(function() {\n              assertFlowHistory('0: goes boom', 'post wait');\n            });\n      });\n\n      it('failsIfConditionHasAFailedSubtask', function() {\n        var callbacks = callbackPair(null, assertIsStubError);\n        var count = 0;\n        scheduleWait(function() {\n          scheduleAction('maybe throw', function() {\n            if (++count == 2) {\n              throw new StubError;\n            }\n          });\n        }, 100, 'waiting').then(callbacks.callback, callbacks.errback);\n        schedule('post wait');\n\n        return waitForIdle().then(function() {\n          assert.equal(2, count);\n          assertFlowHistory(\n              '0: waiting', 'maybe throw',\n              '1: waiting', 'maybe throw',\n              'post wait');\n        });\n      });\n\n      it('pollingLoopWaitsForAllScheduledTasksInCondition', function() {\n        var count = 0;\n        scheduleWait(function() {\n          scheduleAction('increment count', function() { ++count; });\n          return count >= 3;\n        }, 100, 'counting to 3');\n        schedule('post wait');\n\n        return waitForIdle().then(function() {\n          assert.equal(4, count);\n          assertFlowHistory(\n              '0: counting to 3', 'increment count',\n              '1: counting to 3', 'increment count',\n              '2: counting to 3', 'increment count',\n              '3: counting to 3', 'increment count',\n              'post wait');\n        });\n      });\n\n      it('waitsForeverOnAZeroTimeout', function() {\n        var done = false;\n        setTimeout(function() {\n          done = true;\n        }, 150);\n        var waitResult = scheduleWait(function() {\n          return done;\n        }, 0);\n\n        return timeout(75).then(function() {\n          assert.ok(!done);\n          return timeout(100);\n        }).then(function() {\n          assert.ok(done);\n          return waitResult;\n        });\n      });\n\n      it('waitsForeverIfTimeoutOmitted', function() {\n        var done = false;\n        setTimeout(function() {\n          done = true;\n        }, 150);\n        var waitResult = scheduleWait(function() {\n          return done;\n        });\n\n        return timeout(75).then(function() {\n          assert.ok(!done);\n          return timeout(100);\n        }).then(function() {\n          assert.ok(done);\n          return waitResult;\n        });\n      });\n\n      it('timesOut_nonZeroTimeout', function() {\n        var count = 0;\n        scheduleWait(function() {\n          count += 1;\n          var ms = count === 2 ? 65 : 5;\n          return promise.delayed(ms).then(function() {\n            return false;\n          });\n        }, 60, 'counting to 3');\n        return waitForAbort().then(function(e) {\n          switch (count) {\n            case 1:\n              assertFlowHistory('0: counting to 3');\n              break;\n            case 2:\n              assertFlowHistory('0: counting to 3', '1: counting to 3');\n              break;\n            default:\n              fail('unexpected polling count: ' + count);\n          }\n          assert.ok(e instanceof TimeoutError, 'Unexpected error: ' + e);\n          assert.ok(\n              /^counting to 3\\nWait timed out after \\d+ms$/.test(e.message));\n        });\n      });\n\n      it('shouldFailIfConditionReturnsARejectedPromise', function() {\n        scheduleWait(function() {\n          return promise.rejected(new StubError);\n        }, 100, 'returns rejected promise on first pass');\n        return waitForAbort().then(assertIsStubError);\n      });\n\n      it('scheduleWithIntermittentWaits', function() {\n        schedule('a');\n        scheduleWait(function() { return true; }, 0, 'wait 1');\n        schedule('b');\n        scheduleWait(function() { return true; }, 0, 'wait 2');\n        schedule('c');\n        scheduleWait(function() { return true; }, 0, 'wait 3');\n\n        return waitForIdle().then(function() {\n          assertFlowHistory('a', '0: wait 1', 'b', '0: wait 2', 'c', '0: wait 3');\n        });\n      });\n\n      it('scheduleWithIntermittentAndNestedWaits', function() {\n        schedule('a');\n        scheduleWait(function() { return true; }, 0, 'wait 1').\n            then(function() {\n              schedule('d');\n              scheduleWait(function() { return true; }, 0, 'wait 2');\n              schedule('e');\n            });\n        schedule('b');\n        scheduleWait(function() { return true; }, 0, 'wait 3');\n        schedule('c');\n        scheduleWait(function() { return true; }, 0, 'wait 4');\n\n        return waitForIdle().then(function() {\n          assertFlowHistory(\n              'a', '0: wait 1', 'd', '0: wait 2', 'e', 'b', '0: wait 3', 'c',\n              '0: wait 4');\n        });\n      });\n\n      it('requiresConditionToBeAPromiseOrFunction', function() {\n        assert.throws(function() {\n          flow.wait(1234, 0);\n        });\n        flow.wait(function() { return true;}, 0);\n        flow.wait(promise.fulfilled(), 0);\n        return waitForIdle();\n      });\n\n      it('promiseThatDoesNotResolveBeforeTimeout', function() {\n        var d = promise.defer();\n        flow.wait(d.promise, 5).then(fail, function(e) {\n          assert.ok(e instanceof TimeoutError, 'Unexpected error: ' + e);\n          assert.ok(\n              /Timed out waiting for promise to resolve after \\d+ms/\n                  .test(e.message),\n              'unexpected error message: ' + e.message);\n        });\n        return waitForIdle();\n      });\n\n      it('unboundedWaitOnPromiseResolution', function() {\n        var messages = [];\n        var d = promise.defer();\n        var waitResult = flow.wait(d.promise).then(function(value) {\n          messages.push('b');\n          assert.equal(1234, value);\n        });\n        setTimeout(function() {\n          messages.push('a');\n        }, 5);\n\n        timeout(10).then(function() {\n          assert.deepEqual(['a'], messages);\n          d.fulfill(1234);\n          return waitResult;\n        }).then(function() {\n          assert.deepEqual(['a', 'b'], messages);\n        });\n\n        return waitForIdle();\n      });\n    });\n\n    describe('testSubtasks', function() {\n      it('(base case)', function() {\n        schedule('a');\n        scheduleAction('sub-tasks', function() {\n          schedule('c');\n          schedule('d');\n        });\n        schedule('b');\n\n        return waitForIdle().then(function() {\n          assertFlowHistory('a', 'sub-tasks', 'c', 'd', 'b');\n        });\n      });\n\n      it('nesting', function() {\n        schedule('a');\n        scheduleAction('sub-tasks', function() {\n          schedule('b');\n          scheduleAction('sub-sub-tasks', function() {\n            schedule('c');\n            schedule('d');\n          });\n          schedule('e');\n        });\n        schedule('f');\n\n        return waitForIdle().then(function() {\n          assertFlowHistory(\n              'a', 'sub-tasks', 'b', 'sub-sub-tasks', 'c', 'd', 'e', 'f');\n        });\n      });\n\n      it('taskReturnsSubTaskResult_1', function() {\n        schedule('a');\n        scheduleAction('sub-tasks', function() {\n          return schedule('c');\n        });\n        schedule('b');\n\n        return waitForIdle().then(function() {\n          assertFlowHistory('a', 'sub-tasks', 'c', 'b');\n        });\n      });\n\n      it('taskReturnsSubTaskResult_2', function() {\n        let pair = callbackPair((value) => assert.equal(123, value));\n        schedule('a');\n        schedule('sub-tasks', promise.fulfilled(123)).then(pair.callback);\n        schedule('b');\n\n        return waitForIdle().then(function() {\n          assertFlowHistory('a', 'sub-tasks','b');\n          pair.assertCallback();\n        });\n      });\n\n      it('taskReturnsPromiseThatDependsOnSubtask_1', function() {\n        scheduleAction('a', function() {\n          return promise.delayed(10).then(function() {\n            schedule('b');\n          });\n        });\n        schedule('c');\n        return waitForIdle().then(function() {\n          assertFlowHistory('a', 'b', 'c');\n        });\n      });\n\n      it('taskReturnsPromiseThatDependsOnSubtask_2', function() {\n        scheduleAction('a', function() {\n          return promise.fulfilled().then(function() {\n            schedule('b');\n          });\n        });\n        schedule('c');\n        return waitForIdle().then(function() {\n          assertFlowHistory('a', 'b', 'c');\n        });\n      });\n\n      it('taskReturnsPromiseThatDependsOnSubtask_3', function() {\n        scheduleAction('a', function() {\n          return promise.delayed(10).then(function() {\n            return schedule('b');\n          });\n        });\n        schedule('c');\n        return waitForIdle().then(function() {\n          assertFlowHistory('a', 'b', 'c');\n        });\n      });\n\n      it('taskReturnsPromiseThatDependsOnSubtask_4', function() {\n        scheduleAction('a', function() {\n          return promise.delayed(5).then(function() {\n            return promise.delayed(5).then(function() {\n              return schedule('b');\n            });\n          });\n        });\n        schedule('c');\n        return waitForIdle().then(function() {\n          assertFlowHistory('a', 'b', 'c');\n        });\n      });\n\n      it('taskReturnsPromiseThatDependsOnSubtask_5', function() {\n        scheduleAction('a', function() {\n          return promise.delayed(5).then(function() {\n            return promise.delayed(5).then(function() {\n              return promise.delayed(5).then(function() {\n                return promise.delayed(5).then(function() {\n                  return schedule('b');\n                });\n              });\n            });\n          });\n        });\n        schedule('c');\n        return waitForIdle().then(function() {\n          assertFlowHistory('a', 'b', 'c');\n        });\n      });\n\n      it('taskReturnsPromiseThatDependsOnSubtask_6', function() {\n        scheduleAction('a', function() {\n          return promise.delayed(5).\n              then(function() { return promise.delayed(5) }).\n              then(function() { return promise.delayed(5) }).\n              then(function() { return promise.delayed(5) }).\n              then(function() { return schedule('b'); });\n        });\n        schedule('c');\n        return waitForIdle().then(function() {\n          assertFlowHistory('a', 'b', 'c');\n        });\n      });\n\n      it('subTaskFails_1', function() {\n        schedule('a');\n        scheduleAction('sub-tasks', function() {\n          scheduleAction('sub-task that fails', throwStubError);\n        });\n        schedule('should never execute');\n\n        return waitForAbort().\n            then(assertIsStubError).\n            then(function() {\n              assertFlowHistory('a', 'sub-tasks', 'sub-task that fails');\n            });\n      });\n\n      it('subTaskFails_2', function() {\n        schedule('a');\n        scheduleAction('sub-tasks', function() {\n          return promise.rejected(new StubError);\n        });\n        schedule('should never execute');\n\n        return waitForAbort().\n            then(assertIsStubError).\n            then(function() {\n              assertFlowHistory('a', 'sub-tasks');\n            });\n      });\n\n      it('subTaskFails_3', function() {\n        var callbacks = callbackPair(null, assertIsStubError);\n\n        schedule('a');\n        scheduleAction('sub-tasks', function() {\n          return promise.rejected(new StubError);\n        }).then(callbacks.callback, callbacks.errback);\n        schedule('b');\n\n        return waitForIdle().\n            then(function() {\n              assertFlowHistory('a', 'sub-tasks', 'b');\n              callbacks.assertErrback();\n            });\n      });\n    });\n\n    describe('testEventLoopWaitsOnPendingPromiseRejections', function() {\n      it('oneRejection', function() {\n        var d = new promise.Deferred;\n        scheduleAction('one', function() {\n          return d.promise;\n        });\n        scheduleAction('two', function() {});\n\n        return timeout(50).then(function() {\n          assertFlowHistory('one');\n          d.reject(new StubError);\n          return waitForAbort();\n        }).\n        then(assertIsStubError).\n        then(function() {\n          assertFlowHistory('one');\n        });\n      });\n\n      it('multipleRejections', function() {\n        var once = Error('once');\n        var twice = Error('twice');\n\n        scheduleAction('one', function() {\n          promise.rejected(once);\n          promise.rejected(twice);\n        });\n        var twoResult = scheduleAction('two', function() {});\n\n        flow.removeAllListeners(\n            promise.ControlFlow.EventType.UNCAUGHT_EXCEPTION);\n        return new NativePromise(function(fulfill, reject) {\n          setTimeout(function() {\n            reject(Error('Should have reported the two errors by now'));\n          }, 50);\n          flow.on(\n              promise.ControlFlow.EventType.UNCAUGHT_EXCEPTION,\n              fulfill);\n        }).then(function(e) {\n          assert.ok(e instanceof promise.MultipleUnhandledRejectionError,\n              'Not a MultipleUnhandledRejectionError');\n          let errors = Array.from(e.errors);\n          assert.deepEqual([once, twice], errors);\n          assertFlowHistory('one');\n        });\n      });\n    });\n\n    describe('testCancelsPromiseReturnedByCallbackIfFrameFails', function() {\n      it('promiseCallback', function() {\n        var chainPair = callbackPair(null, assertIsStubError);\n        var deferredPair = callbackPair(null, function(e) {\n          assert.equal('CancellationError: StubError', e.toString(),\n              'callback result should be cancelled');\n        });\n\n        var d = new promise.Deferred();\n        d.promise.then(deferredPair.callback, deferredPair.errback);\n\n        promise.fulfilled().\n            then(function() {\n              scheduleAction('boom', throwStubError);\n              schedule('this should not run');\n              return d.promise;\n            }).\n            then(chainPair.callback, chainPair.errback);\n\n        return waitForIdle().then(function() {\n          assertFlowHistory('boom');\n          chainPair.assertErrback('chain errback not invoked');\n          deferredPair.assertErrback('deferred errback not invoked');\n        });\n      });\n\n      it('taskCallback', function() {\n        var chainPair = callbackPair(null, assertIsStubError);\n        var deferredPair = callbackPair(null, function(e) {\n          assert.equal('CancellationError: StubError', e.toString(),\n              'callback result should be cancelled');\n        });\n\n        var d = new promise.Deferred();\n        d.promise.then(deferredPair.callback, deferredPair.errback);\n\n        schedule('a').\n            then(function() {\n              scheduleAction('boom', throwStubError);\n              schedule('this should not run');\n              return d.promise;\n            }).\n            then(chainPair.callback, chainPair.errback);\n\n        return waitForIdle().then(function() {\n          assertFlowHistory('a', 'boom');\n          chainPair.assertErrback('chain errback not invoked');\n          deferredPair.assertErrback('deferred errback not invoked');\n        });\n      });\n    });\n\n    it('testMaintainsOrderInCallbacksWhenATaskReturnsAPromise', function() {\n      schedule('__start__', promise.fulfilled()).\n          then(function() {\n            messages.push('a');\n            schedulePush('b');\n            messages.push('c');\n          }).\n          then(function() {\n            messages.push('d');\n          });\n      schedulePush('e');\n\n      return waitForIdle().then(function() {\n        assertFlowHistory('__start__', 'b', 'e');\n        assertMessages('a', 'c', 'b', 'd', 'e');\n      });\n    });\n\n    it('testOwningFlowIsActivatedForExecutingTasks', function() {\n      var defaultFlow = promise.controlFlow();\n      var order = [];\n\n      promise.createFlow(function(flow) {\n        assertFlowIs(flow);\n        order.push(0);\n\n        defaultFlow.execute(function() {\n          assertFlowIs(defaultFlow);\n          order.push(1);\n        });\n      });\n\n      return waitForIdle().then(function() {\n        assertFlowIs(defaultFlow);\n        assert.deepEqual([0, 1], order);\n      });\n    });\n\n    it('testCreateFlowReturnsPromisePairedWithCreatedFlow', function() {\n      return new NativePromise(function(fulfill, reject) {\n        var newFlow;\n        promise.createFlow(function(flow) {\n          newFlow = flow;\n          assertFlowIs(newFlow);\n        }).then(function() {\n          assertFlowIs(newFlow);\n          waitForIdle(newFlow).then(fulfill, reject);\n        });\n      });\n    });\n\n    it('testDeferredFactoriesCreateForActiveFlow_defaultFlow', function() {\n      var e = Error();\n      var defaultFlow = promise.controlFlow();\n      promise.fulfilled().then(function() {\n        assertFlowIs(defaultFlow);\n      });\n      promise.rejected(e).then(null, function(err) {\n        assert.equal(e, err);\n        assertFlowIs(defaultFlow);\n      });\n      promise.defer().promise.then(function() {\n        assertFlowIs(defaultFlow);\n      });\n\n      return waitForIdle();\n    });\n\n    it('testDeferredFactoriesCreateForActiveFlow_newFlow', function() {\n      var e = Error();\n      var newFlow = new promise.ControlFlow;\n      newFlow.execute(function() {\n        promise.fulfilled().then(function() {\n          assertFlowIs(newFlow);\n        });\n\n        promise.rejected(e).then(null, function(err) {\n          assert.equal(e, err);\n          assertFlowIs(newFlow);\n        });\n\n        let d = promise.defer();\n        d.promise.then(function() {\n          assertFlowIs(newFlow);\n        });\n        d.fulfill();\n      }).then(function() {\n        assertFlowIs(newFlow);\n      });\n\n      return waitForIdle(newFlow);\n    });\n\n    it('testFlowsSynchronizeWithThemselvesNotEachOther', function() {\n      var defaultFlow = promise.controlFlow();\n      schedulePush('a', 'a');\n      promise.controlFlow().timeout(500);\n      schedulePush('b', 'b');\n\n      promise.createFlow(function(flow2) {\n        assertFlowIs(flow2);\n        schedulePush('c', 'c');\n        schedulePush('d', 'd');\n      });\n\n      return waitForIdle().then(function() {\n        assertMessages('a', 'c', 'd', 'b');\n      });\n    });\n\n    it('testUnhandledErrorsAreReportedToTheOwningFlow', function() {\n      var error1 = Error('e1');\n      var error2 = Error('e2');\n\n      var defaultFlow = promise.controlFlow();\n      defaultFlow.removeAllListeners('uncaughtException');\n\n      var flow1Error = defer();\n      flow1Error.promise.then(function(value) {\n        assert.equal(error2, value);\n      });\n\n      var flow2Error = defer();\n      flow2Error.promise.then(function(value) {\n        assert.equal(error1, value);\n      });\n\n      promise.createFlow(function(flow) {\n        flow.once('uncaughtException', flow2Error.resolve);\n        promise.rejected(error1);\n\n        defaultFlow.once('uncaughtException', flow1Error.resolve);\n        defaultFlow.execute(function() {\n          promise.rejected(error2);\n        });\n      });\n\n      return NativePromise.all([flow1Error.promise, flow2Error.promise]);\n    });\n\n    it('testCanSynchronizeFlowsByReturningPromiseFromOneToAnother', function() {\n      var flow1 = new promise.ControlFlow;\n      var flow1Done = defer();\n      flow1.once('idle', flow1Done.resolve);\n      flow1.once('uncaughtException', flow1Done.reject);\n\n      var flow2 = new promise.ControlFlow;\n      var flow2Done = defer();\n      flow2.once('idle', flow2Done.resolve);\n      flow2.once('uncaughtException', flow2Done.reject);\n\n      flow1.execute(function() {\n        schedulePush('a', 'a');\n        return promise.delayed(25);\n      }, 'start flow 1');\n\n      flow2.execute(function() {\n        schedulePush('b', 'b');\n        schedulePush('c', 'c');\n        flow2.execute(function() {\n          return flow1.execute(function() {\n            schedulePush('d', 'd');\n          }, 'flow 1 task');\n        }, 'inject flow1 result into flow2');\n        schedulePush('e', 'e');\n      }, 'start flow 2');\n\n      return NativePromise.all([flow1Done.promise, flow2Done.promise]).\n          then(function() {\n            assertMessages('a', 'b', 'c', 'd', 'e');\n          });\n    });\n\n    it('testFramesWaitToCompleteForPendingRejections', function() {\n      return new NativePromise(function(fulfill, reject) {\n\n        promise.controlFlow().execute(function() {\n          promise.rejected(new StubError);\n        }).then(fulfill, reject);\n\n      }).\n      then(() => fail('expected to fail'), assertIsStubError);\n    });\n\n    it('testSynchronizeErrorsPropagateToOuterFlow', function() {\n      var outerFlow = new promise.ControlFlow;\n      var innerFlow = new promise.ControlFlow;\n\n      var block = defer();\n      innerFlow.execute(function() {\n        return block.promise;\n      }, 'block inner flow');\n\n      outerFlow.execute(function() {\n        block.resolve();\n        return innerFlow.execute(function() {\n          promise.rejected(new StubError);\n        }, 'trigger unhandled rejection error');\n      }, 'run test');\n\n      return NativePromise.all([\n        waitForIdle(innerFlow),\n        waitForAbort(outerFlow).then(assertIsStubError)\n      ]);\n    });\n\n    it('testFailsIfErrbackThrows', function() {\n      promise.rejected('').then(null, throwStubError);\n      return waitForAbort().then(assertIsStubError);\n    });\n\n    it('testFailsIfCallbackReturnsRejectedPromise', function() {\n      promise.fulfilled().then(function() {\n        return promise.rejected(new StubError);\n      });\n      return waitForAbort().then(assertIsStubError);\n    });\n\n    it('testAbortsFrameIfTaskFails', function() {\n      promise.fulfilled().then(function() {\n        promise.controlFlow().execute(throwStubError);\n      });\n      return waitForAbort().then(assertIsStubError);\n    });\n\n    it('testAbortsFramePromisedChainedFromTaskIsNotHandled', function() {\n      promise.fulfilled().then(function() {\n        promise.controlFlow().execute(function() {}).\n            then(throwStubError);\n      });\n      return waitForAbort().then(assertIsStubError);\n    });\n\n    it('testTrapsChainedUnhandledRejectionsWithinAFrame', function() {\n      var pair = callbackPair(null, assertIsStubError);\n      promise.fulfilled().then(function() {\n        promise.controlFlow().execute(function() {}).\n            then(throwStubError);\n      }).then(pair.callback, pair.errback);\n\n      return waitForIdle().then(pair.assertErrback);\n    });\n\n    it('testCancelsRemainingTasksIfFrameThrowsDuringScheduling', function() {\n      var task1, task2;\n      var pair = callbackPair(null, assertIsStubError);\n      var flow = promise.controlFlow();\n      flow.execute(function() {\n        task1 = flow.execute(function() {});\n        task2 = flow.execute(function() {});\n        throw new StubError;\n      }).then(pair.callback, pair.errback);\n\n      return waitForIdle().\n          then(pair.assertErrback).\n          then(function() {\n            pair = callbackPair();\n            return task1.then(pair.callback, pair.errback);\n          }).\n          then(function() {\n            pair.assertErrback();\n            pair = callbackPair();\n            return task2.then(pair.callback, pair.errback);\n          }).\n          then(function() {\n            pair.assertErrback();\n          });\n    });\n\n    it('testCancelsRemainingTasksInFrameIfATaskFails', function() {\n      var task;\n      var pair = callbackPair(null, assertIsStubError);\n      var flow = promise.controlFlow();\n      flow.execute(function() {\n        flow.execute(throwStubError);\n        task = flow.execute(function() {});\n      }).then(pair.callback, pair.errback);\n\n      return waitForIdle().then(pair.assertErrback).then(function() {\n        pair = callbackPair();\n        task.then(pair.callback, pair.errback);\n      }).then(function() {\n        pair.assertErrback();\n      });\n    });\n\n    it('testDoesNotModifyRejectionErrorIfPromiseNotInsideAFlow', function() {\n      var error = Error('original message');\n      var originalStack = error.stack;\n      var originalStr = error.toString();\n\n      var pair = callbackPair(null, function(e) {\n        assert.equal(error, e);\n        assert.equal('original message', e.message);\n        assert.equal(originalStack, e.stack);\n        assert.equal(originalStr, e.toString());\n      });\n\n      promise.rejected(error).then(pair.callback, pair.errback);\n      return waitForIdle().then(pair.assertErrback);\n    });\n\n    /** See https://github.com/SeleniumHQ/selenium/issues/444 */\n    it('testMaintainsOrderWithPromiseChainsCreatedWithinAForeach_1', function() {\n      var messages = [];\n      flow.execute(function() {\n        return promise.fulfilled(['a', 'b', 'c', 'd']);\n      }, 'start').then(function(steps) {\n        steps.forEach(function(step) {\n          promise.fulfilled(step)\n          .then(function() {\n            messages.push(step + '.1');\n          }).then(function() {\n            messages.push(step + '.2');\n          });\n        })\n      });\n      return waitForIdle().then(function() {\n        assert.deepEqual(\n            ['a.1', 'a.2', 'b.1', 'b.2', 'c.1', 'c.2', 'd.1', 'd.2'],\n            messages);\n      });\n    });\n\n    /** See https://github.com/SeleniumHQ/selenium/issues/444 */\n    it('testMaintainsOrderWithPromiseChainsCreatedWithinAForeach_2', function() {\n      var messages = [];\n      flow.execute(function() {\n        return promise.fulfilled(['a', 'b', 'c', 'd']);\n      }, 'start').then(function(steps) {\n        steps.forEach(function(step) {\n          promise.fulfilled(step)\n          .then(function() {\n            messages.push(step + '.1');\n          }).then(function() {\n            flow.execute(function() {}, step + '.2').then(function() {\n              messages.push(step + '.2');\n            });\n          });\n        })\n      });\n      return waitForIdle().then(function() {\n        assert.deepEqual(\n            ['a.1', 'a.2', 'b.1', 'b.2', 'c.1', 'c.2', 'd.1', 'd.2'],\n            messages);\n      });\n    });\n\n    /** See https://github.com/SeleniumHQ/selenium/issues/444 */\n    it('testMaintainsOrderWithPromiseChainsCreatedWithinAForeach_3', function() {\n      var messages = [];\n      flow.execute(function() {\n        return promise.fulfilled(['a', 'b', 'c', 'd']);\n      }, 'start').then(function(steps) {\n        steps.forEach(function(step) {\n          promise.fulfilled(step)\n          .then(function(){})\n          .then(function() {\n            messages.push(step + '.1');\n            return flow.execute(function() {}, step + '.1');\n          }).then(function() {\n            flow.execute(function() {}, step + '.2').then(function(text) {\n              messages.push(step + '.2');\n            });\n          });\n        })\n      });\n      return waitForIdle().then(function() {\n        assert.deepEqual(\n            ['a.1', 'a.2', 'b.1', 'b.2', 'c.1', 'c.2', 'd.1', 'd.2'],\n            messages);\n      });\n    });\n\n    /** See https://github.com/SeleniumHQ/selenium/issues/363 */\n    it('testTasksScheduledInASeparateTurnOfTheEventLoopGetASeparateTaskQueue_2', function() {\n      scheduleAction('a', () => promise.delayed(10));\n      schedule('b');\n      setTimeout(() => schedule('c'), 0);\n\n      return waitForIdle().then(function() {\n        assertFlowHistory('a', 'c', 'b');\n      });\n    });\n\n    /** See https://github.com/SeleniumHQ/selenium/issues/363 */\n    it('testTasksScheduledInASeparateTurnOfTheEventLoopGetASeparateTaskQueue_2', function() {\n      scheduleAction('a', () => promise.delayed(10));\n      schedule('b');\n      schedule('c');\n      setTimeout(function() {\n        schedule('d');\n        scheduleAction('e', () => promise.delayed(10));\n        schedule('f');\n      }, 0);\n\n      return waitForIdle().then(function() {\n        assertFlowHistory('a', 'd', 'e', 'b', 'c', 'f');\n      });\n    });\n\n    /** See https://github.com/SeleniumHQ/selenium/issues/363 */\n    it('testCanSynchronizeTasksFromAdjacentTaskQueues', function() {\n      var task1 = scheduleAction('a', () => promise.delayed(10));\n      schedule('b');\n      setTimeout(function() {\n        scheduleAction('c', () => task1);\n        schedule('d');\n      }, 0);\n\n      return waitForIdle().then(function() {\n        assertFlowHistory('a', 'c', 'd', 'b');\n      });\n    });\n\n    describe('testCancellingAScheduledTask', function() {\n      it('1', function() {\n        var called = false;\n        var task1 = scheduleAction('a', () => called = true);\n        task1.cancel('no soup for you');\n\n        return waitForIdle().then(function() {\n          assert.ok(!called);\n          assertFlowHistory();\n          return task1.catch(function(e) {\n            assert.ok(e instanceof promise.CancellationError);\n            assert.equal('no soup for you', e.message);\n          });\n        });\n      });\n\n      it('2', function() {\n        schedule('a');\n        var called = false;\n        var task2 = scheduleAction('b', () => called = true);\n        schedule('c');\n\n        task2.cancel('no soup for you');\n\n        return waitForIdle().then(function() {\n          assert.ok(!called);\n          assertFlowHistory('a', 'c');\n          return task2.catch(function(e) {\n            assert.ok(e instanceof promise.CancellationError);\n            assert.equal('no soup for you', e.message);\n          });\n        });\n      });\n\n      it('3', function() {\n        var called = false;\n        var task = scheduleAction('a', () => called = true);\n        task.cancel(new StubError);\n\n        return waitForIdle().then(function() {\n          assert.ok(!called);\n          assertFlowHistory();\n          return task.catch(function(e) {\n            assert.ok(e instanceof promise.CancellationError);\n          });\n        });\n      });\n\n      it('4', function() {\n        var seen = [];\n        var task = scheduleAction('a', () => seen.push(1))\n            .then(() => seen.push(2))\n            .then(() => seen.push(3))\n            .then(() => seen.push(4))\n            .then(() => seen.push(5));\n        task.cancel(new StubError);\n\n        return waitForIdle().then(function() {\n          assert.deepEqual([], seen);\n          assertFlowHistory();\n          return task.catch(function(e) {\n            assert.ok(e instanceof promise.CancellationError);\n          });\n        });\n      });\n\n      it('fromWithinAnExecutingTask', function() {\n        var called = false;\n        var task;\n        scheduleAction('a', function() {\n          task.cancel('no soup for you');\n        });\n        task = scheduleAction('b', () => called = true);\n        schedule('c');\n\n        return waitForIdle().then(function() {\n          assert.ok(!called);\n          assertFlowHistory('a', 'c');\n          return task.catch(function(e) {\n            assert.ok(e instanceof promise.CancellationError);\n            assert.equal('no soup for you', e.message);\n          });\n        });\n      });\n    });\n\n    it('testCancellingAPendingTask', function() {\n      var order = [];\n      var unresolved = promise.defer();\n\n      var innerTask;\n      var outerTask = scheduleAction('a', function() {\n        order.push(1);\n\n        // Schedule a task that will never finish.\n        innerTask = scheduleAction('a.1', function() {\n          return unresolved.promise;\n        });\n\n        // Since the outerTask is cancelled below, innerTask should be cancelled\n        // with a DiscardedTaskError, which means its callbacks are silently\n        // dropped - so this should never execute.\n        innerTask.catch(function(e) {\n          order.push(2);\n        });\n      });\n      schedule('b');\n\n      outerTask.catch(function(e) {\n        order.push(3);\n        assert.ok(e instanceof promise.CancellationError);\n        assert.equal('no soup for you', e.message);\n      });\n\n      unresolved.promise.catch(function(e) {\n        order.push(4);\n        assert.ok(e instanceof promise.CancellationError);\n      });\n\n      return timeout(10).then(function() {\n        assert.deepEqual([1], order);\n\n        outerTask.cancel('no soup for you');\n        return waitForIdle();\n      }).then(function() {\n        assertFlowHistory('a', 'a.1', 'b');\n        assert.deepEqual([1, 3, 4], order);\n      });\n    });\n\n    it('testCancellingAPendingPromiseCallback', function() {\n      var called = false;\n\n      var root = promise.fulfilled();\n      root.then(function() {\n        cb2.cancel('no soup for you');\n      });\n\n      var cb2 = root.then(fail, fail);  // These callbacks should never be called.\n      cb2.then(fail, function(e) {\n        called = true;\n        assert.ok(e instanceof promise.CancellationError);\n        assert.equal('no soup for you', e.message);\n      });\n\n      return waitForIdle().then(function() {\n        assert.ok(called);\n      });\n    });\n\n    describe('testResetFlow', function() {\n      it('1', function() {\n        var called = 0;\n        var task = flow.execute(() => called++);\n        task.finally(() => called++);\n\n        return new Promise(function(fulfill) {\n          flow.once('reset', fulfill);\n          flow.reset();\n\n        }).then(function() {\n          assert.equal(0, called);\n          return task;\n\n        }).then(fail, function(e) {\n          assert.ok(e instanceof promise.CancellationError);\n          assert.equal('ControlFlow was reset', e.message);\n        });\n      });\n\n      it('2', function() {\n        var called = 0;\n        var task1 = flow.execute(() => called++);\n        task1.finally(() => called++);\n\n        var task2 = flow.execute(() => called++);\n        task2.finally(() => called++);\n\n        var task3 = flow.execute(() => called++);\n        task3.finally(() => called++);\n\n        return new Promise(function(fulfill) {\n          flow.once('reset', fulfill);\n          flow.reset();\n\n        }).then(function() {\n          assert.equal(0, called);\n        });\n      });\n    });\n\n    describe('testPromiseFulfilledInsideTask', function() {\n      it('1', function() {\n        var order = [];\n\n        flow.execute(function() {\n          var d = promise.defer();\n\n          d.promise.then(() => order.push('a'));\n          d.promise.then(() => order.push('b'));\n          d.promise.then(() => order.push('c'));\n          d.fulfill();\n\n          flow.execute(() => order.push('d'));\n\n        }).then(() => order.push('fin'));\n\n        return waitForIdle().then(function() {\n          assert.deepEqual(['a', 'b', 'c', 'd', 'fin'], order);\n        });\n      });\n\n      it('2', function() {\n        var order = [];\n\n        flow.execute(function() {\n          flow.execute(() => order.push('a'));\n          flow.execute(() => order.push('b'));\n\n          var d = promise.defer();\n          d.promise.then(() => order.push('c'));\n          d.promise.then(() => order.push('d'));\n          d.fulfill();\n\n          flow.execute(() => order.push('e'));\n\n        }).then(() => order.push('fin'));\n\n        return waitForIdle().then(function() {\n          assert.deepEqual(['a', 'b', 'c', 'd', 'e', 'fin'], order);\n        });\n      });\n\n      it('3', function() {\n        var order = [];\n        var d = promise.defer();\n        d.promise.then(() => order.push('c'));\n        d.promise.then(() => order.push('d'));\n\n        flow.execute(function() {\n          flow.execute(() => order.push('a'));\n          flow.execute(() => order.push('b'));\n\n          d.promise.then(() => order.push('e'));\n          d.fulfill();\n\n          flow.execute(() => order.push('f'));\n\n        }).then(() => order.push('fin'));\n\n        return waitForIdle().then(function() {\n          assert.deepEqual(['c', 'd', 'a', 'b', 'e', 'f', 'fin'], order);\n        });\n      });\n\n      it('4', function() {\n        var order = [];\n        var d = promise.defer();\n        d.promise.then(() => order.push('a'));\n        d.promise.then(() => order.push('b'));\n\n        flow.execute(function() {\n          flow.execute(function() {\n            order.push('c');\n            flow.execute(() => order.push('d'));\n            d.promise.then(() => order.push('e'));\n          });\n          flow.execute(() => order.push('f'));\n\n          d.promise.then(() => order.push('g'));\n          d.fulfill();\n\n          flow.execute(() => order.push('h'));\n\n        }).then(() => order.push('fin'));\n\n        return waitForIdle().then(function() {\n          assert.deepEqual(['a', 'b', 'c', 'd', 'e', 'f', 'g', 'h', 'fin'], order);\n        });\n      });\n    });\n\n    describe('testSettledPromiseCallbacksInsideATask', function() {\n      it('1', function() {\n        var order = [];\n        var p = promise.fulfilled();\n\n        flow.execute(function() {\n          flow.execute(() => order.push('a'));\n          p.then(() => order.push('b'));\n          flow.execute(() => order.push('c'));\n          p.then(() => order.push('d'));\n        }).then(() => order.push('fin'));\n\n        return waitForIdle().then(function() {\n          assert.deepEqual(['a', 'b', 'c', 'd', 'fin'], order);\n        });\n      });\n\n      it('2', function() {\n        var order = [];\n\n        flow.execute(function() {\n          flow.execute(() => order.push('a'))\n              .then(   () => order.push('c'));\n          flow.execute(() => order.push('b'));\n        }).then(() => order.push('fin'));\n\n        return waitForIdle().then(function() {\n          assert.deepEqual(['a', 'c', 'b', 'fin'], order);\n        });\n      });\n    });\n\n    it('testTasksDoNotWaitForNewlyCreatedPromises', function() {\n      var order = [];\n\n      flow.execute(function() {\n        var d = promise.defer();\n\n        // This is a normal promise, not a task, so the task for this callback is\n        // considered volatile. Volatile tasks should be skipped when they reach\n        // the front of the task queue.\n        d.promise.then(() => order.push('a'));\n\n        flow.execute(() => order.push('b'));\n        flow.execute(function() {\n          flow.execute(() => order.push('c'));\n          d.promise.then(() => order.push('d'));\n          d.fulfill();\n        });\n        flow.execute(() => order.push('e'));\n\n      }).then(() => order.push('fin'));\n\n      return waitForIdle().then(function() {\n        assert.deepEqual(['b', 'a', 'c', 'd', 'e', 'fin'], order);\n      });\n    });\n\n    it('testCallbackDependenciesDoNotDeadlock', function() {\n      var order = [];\n      var root = promise.defer();\n      var dep = promise.fulfilled().then(function() {\n        order.push('a');\n        return root.promise.then(function() {\n          order.push('b');\n        });\n      });\n      // This callback depends on |dep|, which depends on another callback\n      // attached to |root| via a chain.\n      root.promise.then(function() {\n        order.push('c');\n        return dep.then(() => order.push('d'));\n      }).then(() => order.push('fin'));\n\n      setTimeout(() => root.fulfill(), 20);\n\n      return waitForIdle().then(function() {\n        assert.deepEqual(['a', 'b', 'c', 'd', 'fin'], order);\n      });\n    });\n  });\n});\n"]}