{"version":3,"sources":["until_test.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA,MAAM,SAAS,QAAQ,QAAR,CAAf;;AAEA,MAAM,KAAK,QAAQ,cAAR,EAAwB,EAAnC;AACA,MAAM,cAAc,QAAQ,mBAAR,EAA6B,IAAjD;AACA,MAAM,QAAQ,QAAQ,iBAAR,CAAd;AACA,MAAM,UAAU,QAAQ,mBAAR,CAAhB;AACA,MAAM,QAAQ,QAAQ,iBAAR,CAAd;AACA,MAAM,YAAY,QAAQ,qBAAR,CAAlB;AAAA,MACM,aAAa,UAAU,UAD7B;;AAGA,SAAS,OAAT,EAAkB,YAAW;AAC3B,MAAI,MAAJ,EAAY,QAAZ;;AAEA,QAAM,YAAN,CAAmB;AACjB,kBAAc;AACZ,WAAK,SAAL,GAAiB,EAAjB;AACD;;AAED,OAAG,GAAH,EAAQ,OAAR,EAAiB;AACf,WAAK,SAAL,CAAe,GAAf,IAAsB,OAAtB;AACA,aAAO,IAAP;AACD;;AAED,YAAQ,GAAR,EAAa;AACX,UAAI,OAAO,IAAX;AACA,aAAO,QAAQ,OAAR,GAAkB,IAAlB,CAAuB,YAAW;AACvC,YAAI,CAAC,KAAK,SAAL,CAAe,IAAI,OAAJ,EAAf,CAAL,EAAoC;AAClC,gBAAM,IAAI,MAAM,mBAAV,CAA8B,IAAI,OAAJ,EAA9B,CAAN;AACD;AACD,eAAO,KAAK,SAAL,CAAe,IAAI,OAAJ,EAAf,EAA8B,GAA9B,CAAP;AACD,OALM,CAAP;AAMD;AAlBgB;;AAqBnB,WAAS,IAAT,CAAc,OAAd,EAAuB;AACrB,UAAM,IAAI,OAAO,cAAX,CAA0B,EAAC,SAAS,OAAV,EAA1B,CAAN;AACD;;AAED,aAAW,SAAS,KAAT,GAAiB;AAC1B,eAAW,IAAI,YAAJ,EAAX;AACA,aAAS,IAAI,UAAU,SAAd,CAAwB,YAAxB,EAAsC,QAAtC,CAAT;AACD,GAHD;;AAKA,WAAS,qBAAT,EAAgC,YAAW;AACzC,OAAG,6BAAH,EAAkC,YAAW;AAC3C,UAAI,IAAI,MAAM,MAAN,CAAR;AACA,eAAS,EAAT,CAAY,YAAY,eAAxB,EAAyC,YAAW;AAClD,cAAM,CAAN;AACD,OAFD;AAGA,aAAO,OAAO,IAAP,CAAY,MAAM,mBAAN,CAA0B,CAA1B,CAAZ,EAA0C,GAA1C,EACF,IADE,CACG,IADH,EACU,EAAD,IAAQ,OAAO,WAAP,CAAmB,EAAnB,EAAuB,CAAvB,CADjB,CAAP;AAED,KAPD;;AASA,UAAM,aAAa,iBAAnB;AACA,UAAM,gBAAgB,IAAtB;;AAEA,aAAS,aAAT,CAAuB,UAAvB,EAAmC;AACjC,UAAI,OAAO,UAAP,KAAsB,QAA1B,EAAoC;AAClC,qBAAa,WAAW,OAAX,CAAmB,UAAnB,CAAb;AACD,OAFD,MAEO;AACL,eAAO,KAAP,CAAa,OAAO,UAApB,EAAgC,QAAhC,EAA0C,0BAA1C;AACD;AACD,aAAO,OAAO;AACZ,eAAO,SAAP,CACI,IAAI,YAAJ,CAAiB,IAAjB,CADJ,EAC4B,UAD5B,EACwC,wBADxC;AAEA,eAAO,IAAP;AACD,OAJD;AAKD;;AAED,OAAG,SAAH,EAAc,YAAW;AACvB,eAAS,EAAT,CAAY,YAAY,eAAxB,EAAyC,cAAc,aAAd,CAAzC;AACA,aAAO,OAAO,IAAP,CAAY,MAAM,mBAAN,CAA0B,aAA1B,CAAZ,EAAsD,GAAtD,CAAP;AACD,KAHD;;AAKA,OAAG,cAAH,EAAmB,YAAW;AAC5B,eAAS,EAAT,CAAY,YAAY,eAAxB,EAAyC,cAAc,UAAd,CAAzC;;AAEA,UAAI,KAAK,IAAI,UAAU,UAAd,CAAyB,MAAzB,EAAiC,UAAjC,CAAT;AACA,aAAO,OAAO,IAAP,CAAY,MAAM,mBAAN,CAA0B,EAA1B,CAAZ,EAA2C,GAA3C,CAAP;AACD,KALD;;AAOA,OAAG,qBAAH,EAA0B,YAAW;AACnC,eAAS,EAAT,CAAY,YAAY,eAAxB,EAAyC,cAAc,UAAd,CAAzC;AACA,UAAI,KAAK,IAAI,UAAU,iBAAd,CAAgC,MAAhC,EACL,QAAQ,OAAR,CAAgB,IAAI,UAAU,UAAd,CAAyB,MAAzB,EAAiC,UAAjC,CAAhB,CADK,CAAT;AAEA,aAAO,OAAO,IAAP,CAAY,MAAM,mBAAN,CAA0B,EAA1B,CAAZ,EAA2C,GAA3C,CAAP;AACD,KALD;;AAOA,OAAG,WAAH,EAAgB,YAAW;AACzB,eAAS,EAAT,CAAY,YAAY,aAAxB,EAAuC,MAAM,CAAC,WAAW,OAAX,CAAmB,UAAnB,CAAD,CAA7C;AACA,eAAS,EAAT,CAAY,YAAY,eAAxB,EAAyC,cAAc,UAAd,CAAzC;AACA,aAAO,OAAO,IAAP,CAAY,MAAM,mBAAN,CAA0B,GAAG,EAAH,CAAM,KAAN,CAA1B,CAAZ,EAAqD,GAArD,CAAP;AACD,KAJD;;AAMA,OAAG,oCAAH,EAAyC,YAAW;AAClD,UAAI,iBAAiB,CAAC,EAAD,EAAK,EAAL,EAAS,CAAC,WAAW,OAAX,CAAmB,UAAnB,CAAD,CAAT,CAArB;AACA,eAAS,EAAT,CAAY,YAAY,aAAxB,EAAuC,MAAM,eAAe,KAAf,EAA7C;AACA,eAAS,EAAT,CAAY,YAAY,eAAxB,EAAyC,cAAc,UAAd,CAAzC;;AAEA,aAAO,OAAO,IAAP,CAAY,MAAM,mBAAN,CAA0B,GAAG,EAAH,CAAM,KAAN,CAA1B,CAAZ,EAAqD,IAArD,EACF,IADE,CACG,MAAM,OAAO,SAAP,CAAiB,cAAjB,EAAiC,EAAjC,CADT,CAAP;AAED,KAPD;;AASA,OAAG,mCAAH,EAAwC,YAAW;AACjD,UAAI,QAAQ,CAAZ;AACA,eAAS,EAAT,CAAY,YAAY,eAAxB,EAAyC,YAAW;AAClD,iBAAS,CAAT;AACA,cAAM,IAAI,MAAM,gBAAV,EAAN;AACD,OAHD;;AAKA,aAAO,OAAO,IAAP,CAAY,MAAM,mBAAN,CAA0B,CAA1B,CAAZ,EAA0C,GAA1C,EACF,IADE,CACG,IADH,EACS,UAAS,CAAT,EAAY;AACtB,eAAO,EAAP,CAAU,QAAQ,CAAlB;AACA,eAAO,EAAP,CACI,EAAE,OAAF,CAAU,UAAV,CAAqB,uCAArB,CADJ,EAEI,oBAAoB,EAAE,OAF1B;AAGD,OANE,CAAP;AAOD,KAdD;AAeD,GA3ED;;AA6EA,WAAS,gBAAT,EAA2B,YAAW;AACpC,OAAG,kCAAH,EAAuC,YAAW;AAChD,aAAO,OAAO,IAAP,CAAY,MAAM,cAAN,EAAZ,EAAoC,GAApC,EAAyC,IAAzC,CAA8C,IAA9C,EAAoD,UAAS,CAAT,EAAY;AACrE,eAAO,EAAP,CAAU,aAAa,MAAM,mBAA7B;AACA,eAAO,KAAP,CAAa,EAAE,OAAf,EAAwB,YAAY,cAApC;AACD,OAHM,CAAP;AAID,KALD;;AAOA,OAAG,eAAH,EAAoB,YAAW;AAC7B,UAAI,QAAQ,CAAZ;AACA,eAAS,EAAT,CAAY,YAAY,cAAxB,EAAwC,YAAW;AACjD,YAAI,UAAU,CAAd,EAAiB;AACf,gBAAM,IAAI,MAAM,gBAAV,EAAN;AACD,SAFD,MAEO;AACL,iBAAO,IAAP;AACD;AACF,OAND,EAMG,EANH,CAMM,YAAY,aANlB,EAMiC,MAAM,IANvC;;AAQA,aAAO,OAAO,IAAP,CAAY,MAAM,cAAN,EAAZ,EAAoC,IAApC,EAA0C,IAA1C,CAA+C,UAAS,KAAT,EAAgB;AACpE,eAAO,KAAP,CAAa,KAAb,EAAoB,CAApB;AACA,eAAO,MAAM,OAAN,EAAP;AACD,OAHM,CAAP;AAID,KAdD;;AAgBA;AACA;AACA,aAAS,4BAAT,EAAuC,YAAW;AAChD,SAAG,0CAAH,EAA+C,YAAW;AACxD,YAAI,QAAQ,CAAZ;AACA,iBAAS,EAAT,CAAY,YAAY,cAAxB,EAAwC,YAAW;AACjD,cAAI,UAAU,CAAd,EAAiB;AACf,kBAAM,IAAI,MAAM,cAAV,CAA0B,8BAA1B,CAAN;AACD,WAFD,MAEO;AACL,mBAAO,IAAP;AACD;AACF,SAND,EAMG,EANH,CAMM,YAAY,aANlB,EAMiC,MAAM,IANvC;;AAQA,eAAO,OAAO,IAAP,CAAY,MAAM,cAAN,EAAZ,EAAoC,IAApC,EAA0C,IAA1C,CAA+C,UAAS,KAAT,EAAgB;AACpE,iBAAO,KAAP,CAAa,KAAb,EAAoB,CAApB;AACA,iBAAO,MAAM,OAAN,EAAP;AACD,SAHM,CAAP;AAID,OAdD;;AAgBA,SAAG,mCAAH,EAAwC,YAAW;AACjD,YAAI,iBAAiB,IAAI,MAAM,cAAV,EAArB;;AAEA,iBAAS,EAAT,CAAY,YAAY,cAAxB,EAAwC,YAAW;AACjD,gBAAM,cAAN;AACD,SAFD;;AAIA,eAAO,OAAO,IAAP,CAAY,MAAM,cAAN,EAAZ,EAAoC,IAApC,EAA0C,IAA1C,CAA+C,YAAW;AAC/D,gBAAM,IAAI,KAAJ,CAAU,4CAAV,CAAN;AACD,SAFM,EAEJ,UAAS,KAAT,EAAgB;AACjB,iBAAO,KAAP,CAAa,KAAb,EAAoB,cAApB;AACD,SAJM,CAAP;AAKD,OAZD;AAaD,KA9BD;AA+BD,GAzDD;;AA2DA,KAAG,kBAAH,EAAuB,YAAW;AAChC,QAAI,SAAS,CAAC,KAAD,EAAQ,KAAR,EAAe,KAAf,CAAb;AACA,aAAS,EAAT,CAAY,YAAY,SAAxB,EAAmC,MAAM,OAAO,KAAP,EAAzC;;AAEA,WAAO,OAAO,IAAP,CAAY,MAAM,OAAN,CAAc,KAAd,CAAZ,EAAkC,IAAlC,EAAwC,IAAxC,CAA6C,YAAW;AAC7D,aAAO,eAAP,CAAuB,MAAvB,EAA+B,CAAC,KAAD,CAA/B;AACD,KAFM,CAAP;AAGD,GAPD;;AASA,KAAG,wBAAH,EAA6B,YAAW;AACtC,QAAI,SAAS,CAAC,KAAD,EAAQ,SAAR,EAAmB,QAAnB,CAAb;AACA,aAAS,EAAT,CAAY,YAAY,SAAxB,EAAmC,MAAM,OAAO,KAAP,EAAzC;;AAEA,WAAO,OAAO,IAAP,CAAY,MAAM,aAAN,CAAoB,OAApB,CAAZ,EAA0C,IAA1C,EAAgD,IAAhD,CAAqD,YAAW;AACrE,aAAO,eAAP,CAAuB,MAAvB,EAA+B,CAAC,QAAD,CAA/B;AACD,KAFM,CAAP;AAGD,GAPD;;AASA,KAAG,uBAAH,EAA4B,YAAW;AACrC,QAAI,SAAS,CAAC,KAAD,EAAQ,SAAR,EAAmB,QAAnB,EAA6B,QAA7B,EAAuC,QAAvC,CAAb;AACA,aAAS,EAAT,CAAY,YAAY,SAAxB,EAAmC,MAAM,OAAO,KAAP,EAAzC;;AAEA,WAAO,OAAO,IAAP,CAAY,MAAM,YAAN,CAAmB,aAAnB,CAAZ,EAA+C,IAA/C,EACF,IADE,CACG,YAAW;AACf,aAAO,eAAP,CAAuB,MAAvB,EAA+B,CAAC,QAAD,CAA/B;AACD,KAHE,CAAP;AAID,GARD;;AAUA,KAAG,gBAAH,EAAqB,YAAW;AAC9B,QAAI,OAAO,CAAC,oBAAD,EAAuB,iBAAvB,EAA0C,qBAA1C,CAAX;AACA,aAAS,EAAT,CAAY,YAAY,eAAxB,EAAyC,MAAM,KAAK,KAAL,EAA/C;;AAEA,WAAO,OAAO,IAAP,CAAY,MAAM,KAAN,CAAY,iBAAZ,CAAZ,EAA4C,IAA5C,EAAkD,IAAlD,CAAuD,YAAW;AACvE,aAAO,eAAP,CAAuB,IAAvB,EAA6B,CAAC,qBAAD,CAA7B;AACD,KAFM,CAAP;AAGD,GAPD;;AASA,KAAG,sBAAH,EAA2B,YAAW;AACpC,QAAI,OACA,CAAC,gBAAD,EAAmB,4BAAnB,EAAiD,mBAAjD,CADJ;AAEA,aAAS,EAAT,CAAY,YAAY,eAAxB,EAAyC,MAAM,KAAK,KAAL,EAA/C;;AAEA,WAAO,OAAO,IAAP,CAAY,MAAM,WAAN,CAAkB,WAAlB,CAAZ,EAA4C,IAA5C,EAAkD,IAAlD,CAAuD,YAAW;AACvE,aAAO,eAAP,CAAuB,IAAvB,EAA6B,CAAC,mBAAD,CAA7B;AACD,KAFM,CAAP;AAGD,GARD;;AAUA,KAAG,qBAAH,EAA0B,YAAW;AACnC,QAAI,OAAO,CAAC,KAAD,EAAQ,SAAR,EAAmB,QAAnB,EAA6B,QAA7B,EAAuC,QAAvC,CAAX;AACA,aAAS,EAAT,CAAY,YAAY,eAAxB,EAAyC,MAAM,KAAK,KAAL,EAA/C;;AAEA,WAAO,OAAO,IAAP,CAAY,MAAM,UAAN,CAAiB,aAAjB,CAAZ,EAA6C,IAA7C,EACF,IADE,CACG,YAAW;AACf,aAAO,eAAP,CAAuB,IAAvB,EAA6B,CAAC,QAAD,CAA7B;AACD,KAHE,CAAP;AAID,GARD;;AAUA,KAAG,yBAAH,EAA8B,YAAW;AACvC,QAAI,YAAY,CACZ,EADY,EAEZ,CAAC,WAAW,OAAX,CAAmB,QAAnB,CAAD,EAA+B,WAAW,OAAX,CAAmB,KAAnB,CAA/B,CAFY,EAGZ,CAAC,KAAD,CAHY,CAAhB;AAKA,aAAS,EAAT,CAAY,YAAY,aAAxB,EAAuC,MAAM,UAAU,KAAV,EAA7C;;AAEA,QAAI,UAAU,OAAO,IAAP,CAAY,MAAM,cAAN,CAAqB,GAAG,EAAH,CAAM,MAAN,CAArB,CAAZ,EAAiD,IAAjD,CAAd;AACA,WAAO,EAAP,CAAU,mBAAmB,UAAU,iBAAvC;AACA,WAAO,QAAQ,KAAR,GAAgB,IAAhB,CAAqB,UAAS,EAAT,EAAa;AACvC,aAAO,eAAP,CAAuB,SAAvB,EAAkC,CAAC,CAAC,KAAD,CAAD,CAAlC;AACA,aAAO,KAAP,CAAa,EAAb,EAAiB,QAAjB;AACD,KAHM,CAAP;AAID,GAdD;;AAgBA,WAAS,wCAAT,EAAmD,YAAW;AAC5D,aAAS,qBAAT,CAA+B,OAA/B,EAAwC,UAAxC,EAAoD;AAClD,eAAS,EAAT,CAAY,YAAY,aAAxB,EAAuC,MAAM,EAA7C;;AAEA,eAAS,eAAT,GAA2B;AACzB,aAAK,+BAAL;AACD;;AAED,aAAO,OAAO,IAAP,CAAY,MAAM,cAAN,CAAqB,OAArB,CAAZ,EAA2C,GAA3C,EACF,IADE,CACG,eADH,EACoB,UAAS,KAAT,EAAgB;AACrC,YAAI,WAAW,uCAAuC,UAAtD;AACA,YAAI,QAAQ,MAAM,OAAN,CAAc,KAAd,CAAoB,IAApB,EAA0B,CAA1B,CAAZ;AACA,eAAO,KAAP,CAAa,MAAM,CAAN,CAAb,EAAuB,QAAvB;;AAEA,YAAI,QAAQ,8BAAZ;AACA,eAAO,EAAP,CAAU,MAAM,IAAN,CAAW,MAAM,CAAN,CAAX,CAAV,EACK,WAAS,MAAM,CAAN,CAAS,sBAAmB,KAAM,GADhD;AAED,OATE,CAAP;AAUD;;AAED,OAAG,WAAH,EAAgB,YAAW;AACzB,aAAO,sBACH,GAAG,EAAH,CAAM,MAAN,CADG,EACY,gCADZ,CAAP;AAED,KAHD;;AAKA,OAAG,QAAH,EAAa,YAAW;AACtB,aAAO,sBACH,EAAC,IAAI,MAAL,EADG,EACW,gCADX,CAAP;AAED,KAHD;;AAKA,OAAG,YAAH,EAAiB,YAAW;AAC1B,aAAO,sBAAsB,YAAW,CAAE,CAAnC,EAAqC,eAArC,CAAP;AACD,KAFD;AAGD,GAjCD;;AAmCA,KAAG,0BAAH,EAA+B,YAAW;AACxC,QAAI,YAAY,CACZ,EADY,EAEZ,CAAC,WAAW,OAAX,CAAmB,QAAnB,CAAD,EAA+B,WAAW,OAAX,CAAmB,KAAnB,CAA/B,CAFY,EAGZ,CAAC,KAAD,CAHY,CAAhB;AAKA,aAAS,EAAT,CAAY,YAAY,aAAxB,EAAuC,MAAM,UAAU,KAAV,EAA7C;;AAEA,WAAO,OAAO,IAAP,CAAY,MAAM,eAAN,CAAsB,GAAG,EAAH,CAAM,MAAN,CAAtB,CAAZ,EAAkD,IAAlD,EACF,IADE,CACG,UAAS,GAAT,EAAc;AAClB,aAAO,QAAQ,GAAR,CAAY,IAAI,GAAJ,CAAQ,KAAK,EAAE,KAAF,EAAb,CAAZ,CAAP;AACD,KAHE,EAGA,IAHA,CAGK,UAAS,GAAT,EAAc;AACpB,aAAO,eAAP,CAAuB,SAAvB,EAAkC,CAAC,CAAC,KAAD,CAAD,CAAlC;AACA,aAAO,KAAP,CAAa,IAAI,MAAjB,EAAyB,CAAzB;AACA,aAAO,KAAP,CAAa,IAAI,CAAJ,CAAb,EAAqB,QAArB;AACA,aAAO,KAAP,CAAa,IAAI,CAAJ,CAAb,EAAqB,KAArB;AACD,KARE,CAAP;AASD,GAjBD;;AAmBA,WAAS,uCAAT,EAAkD,YAAW;AAC3D,aAAS,sBAAT,CAAgC,OAAhC,EAAyC,UAAzC,EAAqD;AACnD,eAAS,EAAT,CAAY,YAAY,aAAxB,EAAuC,MAAM,EAA7C;;AAEA,eAAS,eAAT,GAA2B;AACzB,aAAK,+BAAL;AACD;;AAED,aAAO,OAAO,IAAP,CAAY,MAAM,eAAN,CAAsB,OAAtB,CAAZ,EAA4C,GAA5C,EACF,IADE,CACG,eADH,EACoB,UAAS,KAAT,EAAgB;AACrC,YAAI,WACA,oDAAoD,UADxD;AAEA,YAAI,QAAQ,MAAM,OAAN,CAAc,KAAd,CAAoB,IAApB,EAA0B,CAA1B,CAAZ;AACA,eAAO,KAAP,CAAa,MAAM,CAAN,CAAb,EAAuB,QAAvB;;AAEA,YAAI,QAAQ,8BAAZ;AACA,eAAO,EAAP,CAAU,MAAM,IAAN,CAAW,MAAM,CAAN,CAAX,CAAV,EACK,WAAS,MAAM,CAAN,CAAS,sBAAmB,KAAM,GADhD;AAED,OAVE,CAAP;AAWD;;AAED,OAAG,WAAH,EAAgB,YAAW;AACzB,aAAO,uBACH,GAAG,EAAH,CAAM,MAAN,CADG,EACY,gCADZ,CAAP;AAED,KAHD;;AAKA,OAAG,QAAH,EAAa,YAAW;AACtB,aAAO,uBACH,EAAC,IAAI,MAAL,EADG,EACW,gCADX,CAAP;AAED,KAHD;;AAKA,OAAG,YAAH,EAAiB,YAAW;AAC1B,aAAO,uBAAuB,YAAW,CAAE,CAApC,EAAsC,eAAtC,CAAP;AACD,KAFD;AAGD,GAlCD;;AAoCA,KAAG,sBAAH,EAA2B,YAAW;AACpC,QAAI,QAAQ,CAAZ;AACA,aAAS,EAAT,CAAY,YAAY,oBAAxB,EAA8C,YAAW;AACvD,aAAO,QAAQ,CAAf,EAAkB;AAChB,iBAAS,CAAT;AACA,eAAO,MAAP;AACD;AACD,YAAM,IAAI,MAAM,0BAAV,CAAqC,WAArC,CAAN;AACD,KAND;;AAQA,QAAI,KAAK,IAAI,UAAU,UAAd,CAAyB,MAAzB,EAAiC,EAAC,SAAS,KAAV,EAAjC,CAAT;AACA,WAAO,OAAO,IAAP,CAAY,MAAM,WAAN,CAAkB,EAAlB,CAAZ,EAAmC,IAAnC,EACF,IADE,CACG,MAAM,OAAO,KAAP,CAAa,KAAb,EAAoB,CAApB,CADT,CAAP;AAED,GAbD;;AAeA,WAAS,0BAAT,EAAqC,YAAW;AAC9C,aAAS,mBAAT,CAA6B,SAA7B,EAAwC,OAAxC,EAAiD,SAAjD,EAA4D,QAA5D,EAAsE;AACpE,UAAI,WAAW,IAAI,UAAU,UAAd,CAAyB,MAAzB,EAAiC,KAAjC,CAAf;AACA,UAAI,gBAAgB,CAAC,QAAD,CAApB;AACA,UAAI,UAAU,MAAV,GAAmB,CAAvB,EAA0B;AACxB,wBAAgB,cAAc,MAAd,CAAqB,UAAU,CAAV,CAArB,CAAhB;AACA,kBAAU,UAAU,CAAV,CAAV;AACA,oBAAY,UAAU,CAAV,CAAZ;AACD;;AAED,aAAO,EAAP,CAAU,UAAU,MAAV,GAAmB,CAA7B;;AAEA,kBAAY,UAAU,MAAV,CAAiB,CAAC,KAAD,CAAjB,CAAZ;AACA,eAAS,EAAT,CAAY,OAAZ,EAAqB,MAAM,UAAU,KAAV,EAA3B;;AAEA,UAAI,SAAS,OAAO,IAAP,CAAY,UAAU,KAAV,CAAgB,IAAhB,EAAsB,aAAtB,CAAZ,EAAkD,IAAlD,CAAb;AACA,aAAO,EAAP,CAAU,kBAAkB,UAAU,iBAAtC;AACA,aAAO,OAAO,IAAP,CAAY,UAAS,KAAT,EAAgB;AACjC,eAAO,EAAP,CAAU,iBAAiB,UAAU,UAArC;AACA,eAAO,EAAP,CAAU,EAAE,iBAAiB,UAAU,iBAA7B,CAAV;AACA,eAAO,MAAM,KAAN,EAAP;AACD,OAJM,EAIJ,IAJI,CAIC,UAAS,EAAT,EAAa;AACnB,eAAO,KAAP,CAAa,KAAb,EAAoB,EAApB;AACA,eAAO,eAAP,CAAuB,SAAvB,EAAkC,CAAC,KAAD,CAAlC;AACD,OAPM,CAAP;AAQD;;AAED,OAAG,kBAAH,EAAuB,YAAW;AAChC,aAAO,oBACH,MAAM,gBADH,EAEH,YAAY,oBAFT,EAE+B,CAAC,KAAD,EAAQ,KAAR,EAAe,IAAf,CAF/B,CAAP;AAGD,KAJD;;AAMA,OAAG,qBAAH,EAA0B,YAAW;AACnC,aAAO,oBACH,MAAM,mBADH,EAEH,YAAY,oBAFT,EAE+B,CAAC,IAAD,EAAO,IAAP,EAAa,KAAb,CAF/B,CAAP;AAGD,KAJD;;AAMA,OAAG,kBAAH,EAAuB,YAAW;AAChC,aAAO,oBACH,MAAM,gBADH,EAEH,YAAY,kBAFT,EAE6B,CAAC,KAAD,EAAQ,KAAR,EAAe,IAAf,CAF7B,CAAP;AAGD,KAJD;;AAMA,OAAG,mBAAH,EAAwB,YAAW;AACjC,aAAO,oBACH,MAAM,iBADH,EAEH,YAAY,kBAFT,EAE6B,CAAC,IAAD,EAAO,IAAP,EAAa,KAAb,CAF7B,CAAP;AAGD,KAJD;;AAMA,OAAG,mBAAH,EAAwB,YAAW;AACjC,aAAO,oBACH,MAAM,iBADH,EAEH,YAAY,mBAFT,EAE8B,CAAC,KAAD,EAAQ,KAAR,EAAe,IAAf,CAF9B,CAAP;AAGD,KAJD;;AAMA,OAAG,sBAAH,EAA2B,YAAW;AACpC,aAAO,oBACH,MAAM,oBADH,EAEH,YAAY,mBAFT,EAE8B,CAAC,IAAD,EAAO,IAAP,EAAa,KAAb,CAF9B,CAAP;AAGD,KAJD;;AAMA,OAAG,eAAH,EAAoB,YAAW;AAC7B,aAAO,oBACH,MAAM,aADH,EACkB,QADlB,EAEH,YAAY,gBAFT,EAGH,CAAC,KAAD,EAAQ,OAAR,EAAiB,QAAjB,CAHG,CAAP;AAID,KALD;;AAOA,OAAG,qBAAH,EAA0B,YAAW;AACnC,aAAO,oBACH,MAAM,mBADH,EACwB,KADxB,EAEH,YAAY,gBAFT,EAGH,CAAC,KAAD,EAAQ,QAAR,EAAkB,WAAlB,CAHG,CAAP;AAID,KALD;;AAOA,OAAG,oBAAH,EAAyB,YAAW;AAClC,aAAO,oBACH,MAAM,kBADH,EACuB,WADvB,EAEH,YAAY,gBAFT,EAGH,CAAC,KAAD,EAAQ,QAAR,EAAkB,WAAlB,CAHG,CAAP;AAID,KALD;AAMD,GAnFD;;AAqFA,WAAS,qBAAT,EAAgC,YAAW;AACzC,OAAG,qDAAH,EAA0D,YAAW;AACnE,UAAI,SAAS,OAAO,IAAP,CACT,IAAI,UAAU,mBAAd,CAAkC,SAAlC,EAA6C,MAAM,GAAnD,CADS,EACgD,IADhD,CAAb;;AAGA,aAAO,OAAO,IAAP,CACH,MAAM,OAAO,IAAP,CAAY,kBAAZ,CADH,EAEH,UAAS,CAAT,EAAY;AACV,eAAO,EAAP,CAAU,aAAa,SAAvB;AACA,eAAO,KAAP,CACI,0DACM,iBAFV,EAGI,EAAE,OAHN;AAID,OARE,CAAP;AASD,KAbD;AAcD,GAfD;AAgBD,CAhcD","file":"until_test-compiled.js","sourcesContent":["// Licensed to the Software Freedom Conservancy (SFC) under one\n// or more contributor license agreements.  See the NOTICE file\n// distributed with this work for additional information\n// regarding copyright ownership.  The SFC licenses this file\n// to you under the Apache License, Version 2.0 (the\n// \"License\"); you may not use this file except in compliance\n// with the License.  You may obtain a copy of the License at\n//\n//   http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing,\n// software distributed under the License is distributed on an\n// \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n// KIND, either express or implied.  See the License for the\n// specific language governing permissions and limitations\n// under the License.\n\n'use strict';\n\nconst assert = require('assert');\n\nconst By = require('../../lib/by').By;\nconst CommandName = require('../../lib/command').Name;\nconst error = require('../../lib/error');\nconst promise = require('../../lib/promise');\nconst until = require('../../lib/until');\nconst webdriver = require('../../lib/webdriver'),\n      WebElement = webdriver.WebElement;\n\ndescribe('until', function() {\n  let driver, executor;\n\n  class TestExecutor {\n    constructor() {\n      this.handlers_ = {};\n    }\n\n    on(cmd, handler) {\n      this.handlers_[cmd] = handler;\n      return this;\n    }\n\n    execute(cmd) {\n      let self = this;\n      return Promise.resolve().then(function() {\n        if (!self.handlers_[cmd.getName()]) {\n          throw new error.UnknownCommandError(cmd.getName());\n        }\n        return self.handlers_[cmd.getName()](cmd);\n      });\n    }\n  }\n\n  function fail(opt_msg) {\n    throw new assert.AssertionError({message: opt_msg});\n  }\n\n  beforeEach(function setUp() {\n    executor = new TestExecutor();\n    driver = new webdriver.WebDriver('session-id', executor);\n  });\n\n  describe('ableToSwitchToFrame', function() {\n    it('failsFastForNonSwitchErrors', function() {\n      let e = Error('boom');\n      executor.on(CommandName.SWITCH_TO_FRAME, function() {\n        throw e;\n      });\n      return driver.wait(until.ableToSwitchToFrame(0), 100)\n          .then(fail, (e2) => assert.strictEqual(e2, e));\n    });\n\n    const ELEMENT_ID = 'some-element-id';\n    const ELEMENT_INDEX = 1234;\n\n    function onSwitchFrame(expectedId) {\n      if (typeof expectedId === 'string') {\n        expectedId = WebElement.buildId(expectedId);\n      } else {\n        assert.equal(typeof expectedId, 'number', 'must be string or number');\n      }\n      return cmd => {\n        assert.deepEqual(\n            cmd.getParameter('id'), expectedId, 'frame ID not specified');\n        return true;\n      };\n    }\n\n    it('byIndex', function() {\n      executor.on(CommandName.SWITCH_TO_FRAME, onSwitchFrame(ELEMENT_INDEX));\n      return driver.wait(until.ableToSwitchToFrame(ELEMENT_INDEX), 100);\n    });\n\n    it('byWebElement', function() {\n      executor.on(CommandName.SWITCH_TO_FRAME, onSwitchFrame(ELEMENT_ID));\n\n      var el = new webdriver.WebElement(driver, ELEMENT_ID);\n      return driver.wait(until.ableToSwitchToFrame(el), 100);\n    });\n\n    it('byWebElementPromise', function() {\n      executor.on(CommandName.SWITCH_TO_FRAME, onSwitchFrame(ELEMENT_ID));\n      var el = new webdriver.WebElementPromise(driver,\n          Promise.resolve(new webdriver.WebElement(driver, ELEMENT_ID)));\n      return driver.wait(until.ableToSwitchToFrame(el), 100);\n    });\n\n    it('byLocator', function() {\n      executor.on(CommandName.FIND_ELEMENTS, () => [WebElement.buildId(ELEMENT_ID)]);\n      executor.on(CommandName.SWITCH_TO_FRAME, onSwitchFrame(ELEMENT_ID));\n      return driver.wait(until.ableToSwitchToFrame(By.id('foo')), 100);\n    });\n\n    it('byLocator_elementNotInitiallyFound', function() {\n      let foundResponses = [[], [], [WebElement.buildId(ELEMENT_ID)]];\n      executor.on(CommandName.FIND_ELEMENTS, () => foundResponses.shift());\n      executor.on(CommandName.SWITCH_TO_FRAME, onSwitchFrame(ELEMENT_ID));\n\n      return driver.wait(until.ableToSwitchToFrame(By.id('foo')), 2000)\n          .then(() => assert.deepEqual(foundResponses, []));\n    });\n\n    it('timesOutIfNeverAbletoSwitchFrames', function() {\n      var count = 0;\n      executor.on(CommandName.SWITCH_TO_FRAME, function() {\n        count += 1;\n        throw new error.NoSuchFrameError;\n      });\n\n      return driver.wait(until.ableToSwitchToFrame(0), 100)\n          .then(fail, function(e) {\n            assert.ok(count > 0);\n            assert.ok(\n                e.message.startsWith('Waiting to be able to switch to frame'),\n                'Wrong message: ' + e.message);\n          });\n    });\n  });\n\n  describe('alertIsPresent', function() {\n    it('failsFastForNonAlertSwitchErrors', function() {\n      return driver.wait(until.alertIsPresent(), 100).then(fail, function(e) {\n        assert.ok(e instanceof error.UnknownCommandError);\n        assert.equal(e.message, CommandName.GET_ALERT_TEXT);\n      });\n    });\n\n    it('waitsForAlert', function() {\n      var count = 0;\n      executor.on(CommandName.GET_ALERT_TEXT, function() {\n        if (count++ < 3) {\n          throw new error.NoSuchAlertError;\n        } else {\n          return true;\n        }\n      }).on(CommandName.DISMISS_ALERT, () => true);\n\n      return driver.wait(until.alertIsPresent(), 1000).then(function(alert) {\n        assert.equal(count, 4);\n        return alert.dismiss();\n      });\n    });\n\n    // TODO: Remove once GeckoDriver doesn't throw this unwanted error.\n    // See https://github.com/SeleniumHQ/selenium/pull/2137\n    describe('workaround for GeckoDriver', function() {\n      it('doesNotFailWhenCannotConvertNullToObject', function() {\n        var count = 0;\n        executor.on(CommandName.GET_ALERT_TEXT, function() {\n          if (count++ < 3) {\n            throw new error.WebDriverError(`can't convert null to object`);\n          } else {\n            return true;\n          }\n        }).on(CommandName.DISMISS_ALERT, () => true);\n\n        return driver.wait(until.alertIsPresent(), 1000).then(function(alert) {\n          assert.equal(count, 4);\n          return alert.dismiss();\n        });\n      });\n\n      it('keepsRaisingRegularWebdriverError', function() {\n        var webDriverError = new error.WebDriverError;\n\n        executor.on(CommandName.GET_ALERT_TEXT, function() {\n          throw webDriverError;\n        });\n\n        return driver.wait(until.alertIsPresent(), 1000).then(function() {\n          throw new Error('driver did not fail against WebDriverError');\n        }, function(error) {\n          assert.equal(error, webDriverError);\n        });\n      })\n    });\n  });\n\n  it('testUntilTitleIs', function() {\n    var titles = ['foo', 'bar', 'baz'];\n    executor.on(CommandName.GET_TITLE, () => titles.shift());\n\n    return driver.wait(until.titleIs('bar'), 3000).then(function() {\n      assert.deepStrictEqual(titles, ['baz']);\n    });\n  });\n\n  it('testUntilTitleContains', function() {\n    var titles = ['foo', 'froogle', 'google'];\n    executor.on(CommandName.GET_TITLE, () => titles.shift());\n\n    return driver.wait(until.titleContains('oogle'), 3000).then(function() {\n      assert.deepStrictEqual(titles, ['google']);\n    });\n  });\n\n  it('testUntilTitleMatches', function() {\n    var titles = ['foo', 'froogle', 'aaaabc', 'aabbbc', 'google'];\n    executor.on(CommandName.GET_TITLE, () => titles.shift());\n\n    return driver.wait(until.titleMatches(/^a{2,3}b+c$/), 3000)\n        .then(function() {\n          assert.deepStrictEqual(titles, ['google']);\n        });\n  });\n\n  it('testUntilUrlIs', function() {\n    var urls = ['http://www.foo.com', 'https://boo.com', 'http://docs.yes.com'];\n    executor.on(CommandName.GET_CURRENT_URL, () => urls.shift());\n\n    return driver.wait(until.urlIs('https://boo.com'), 3000).then(function() {\n      assert.deepStrictEqual(urls, ['http://docs.yes.com']);\n    });\n  });\n\n  it('testUntilUrlContains', function() {\n    var urls =\n        ['http://foo.com', 'https://groups.froogle.com', 'http://google.com'];\n    executor.on(CommandName.GET_CURRENT_URL, () => urls.shift());\n\n    return driver.wait(until.urlContains('oogle.com'), 3000).then(function() {\n      assert.deepStrictEqual(urls, ['http://google.com']);\n    });\n  });\n\n  it('testUntilUrlMatches', function() {\n    var urls = ['foo', 'froogle', 'aaaabc', 'aabbbc', 'google'];\n    executor.on(CommandName.GET_CURRENT_URL, () => urls.shift());\n\n    return driver.wait(until.urlMatches(/^a{2,3}b+c$/), 3000)\n        .then(function() {\n          assert.deepStrictEqual(urls, ['google']);\n        });\n  });\n\n  it('testUntilElementLocated', function() {\n    var responses = [\n        [],\n        [WebElement.buildId('abc123'), WebElement.buildId('foo')],\n        ['end']\n    ];\n    executor.on(CommandName.FIND_ELEMENTS, () => responses.shift());\n\n    let element = driver.wait(until.elementLocated(By.id('quux')), 2000);\n    assert.ok(element instanceof webdriver.WebElementPromise);\n    return element.getId().then(function(id) {\n      assert.deepStrictEqual(responses, [['end']]);\n      assert.equal(id, 'abc123');\n    });\n  });\n\n  describe('untilElementLocated, elementNeverFound', function() {\n    function runNoElementFoundTest(locator, locatorStr) {\n      executor.on(CommandName.FIND_ELEMENTS, () => []);\n\n      function expectedFailure() {\n        fail('expected condition to timeout');\n      }\n\n      return driver.wait(until.elementLocated(locator), 100)\n          .then(expectedFailure, function(error) {\n            var expected = 'Waiting for element to be located ' + locatorStr;\n            var lines = error.message.split(/\\n/, 2);\n            assert.equal(lines[0], expected);\n\n            let regex = /^Wait timed out after \\d+ms$/;\n            assert.ok(regex.test(lines[1]),\n                `Lines <${lines[1]}> does not match ${regex}`);\n          });\n    }\n\n    it('byLocator', function() {\n      return runNoElementFoundTest(\n          By.id('quux'), 'By(css selector, *[id=\"quux\"])');\n    });\n\n    it('byHash', function() {\n      return runNoElementFoundTest(\n          {id: 'quux'}, 'By(css selector, *[id=\"quux\"])');\n    });\n\n    it('byFunction', function() {\n      return runNoElementFoundTest(function() {}, 'by function()');\n    });\n  });\n\n  it('testUntilElementsLocated', function() {\n    var responses = [\n        [],\n        [WebElement.buildId('abc123'), WebElement.buildId('foo')],\n        ['end']\n    ];\n    executor.on(CommandName.FIND_ELEMENTS, () => responses.shift());\n\n    return driver.wait(until.elementsLocated(By.id('quux')), 2000)\n        .then(function(els) {\n          return Promise.all(els.map(e => e.getId()));\n        }).then(function(ids) {\n          assert.deepStrictEqual(responses, [['end']]);\n          assert.equal(ids.length, 2);\n          assert.equal(ids[0], 'abc123');\n          assert.equal(ids[1], 'foo');\n        });\n  });\n\n  describe('untilElementsLocated, noElementsFound', function() {\n    function runNoElementsFoundTest(locator, locatorStr) {\n      executor.on(CommandName.FIND_ELEMENTS, () => []);\n\n      function expectedFailure() {\n        fail('expected condition to timeout');\n      }\n\n      return driver.wait(until.elementsLocated(locator), 100)\n          .then(expectedFailure, function(error) {\n            var expected =\n                'Waiting for at least one element to be located ' + locatorStr;\n            var lines = error.message.split(/\\n/, 2);\n            assert.equal(lines[0], expected);\n\n            let regex = /^Wait timed out after \\d+ms$/;\n            assert.ok(regex.test(lines[1]),\n                `Lines <${lines[1]}> does not match ${regex}`);\n          });\n    }\n\n    it('byLocator', function() {\n      return runNoElementsFoundTest(\n          By.id('quux'), 'By(css selector, *[id=\"quux\"])');\n    });\n\n    it('byHash', function() {\n      return runNoElementsFoundTest(\n          {id: 'quux'}, 'By(css selector, *[id=\"quux\"])');\n    });\n\n    it('byFunction', function() {\n      return runNoElementsFoundTest(function() {}, 'by function()');\n    });\n  });\n\n  it('testUntilStalenessOf', function() {\n    let count = 0;\n    executor.on(CommandName.GET_ELEMENT_TAG_NAME, function() {\n      while (count < 3) {\n        count += 1;\n        return 'body';\n      }\n      throw new error.StaleElementReferenceError('now stale');\n    });\n\n    var el = new webdriver.WebElement(driver, {ELEMENT: 'foo'});\n    return driver.wait(until.stalenessOf(el), 2000)\n        .then(() => assert.equal(count, 3));\n  });\n\n  describe('element state conditions', function() {\n    function runElementStateTest(predicate, command, responses, var_args) {\n      let original = new webdriver.WebElement(driver, 'foo');\n      let predicateArgs = [original];\n      if (arguments.length > 3) {\n        predicateArgs = predicateArgs.concat(arguments[1]);\n        command = arguments[2];\n        responses = arguments[3];\n      }\n\n      assert.ok(responses.length > 1);\n\n      responses = responses.concat(['end']);\n      executor.on(command, () => responses.shift());\n\n      let result = driver.wait(predicate.apply(null, predicateArgs), 2000);\n      assert.ok(result instanceof webdriver.WebElementPromise);\n      return result.then(function(value) {\n        assert.ok(value instanceof webdriver.WebElement);\n        assert.ok(!(value instanceof webdriver.WebElementPromise));\n        return value.getId();\n      }).then(function(id) {\n        assert.equal('foo', id);\n        assert.deepStrictEqual(responses, ['end']);\n      });\n    }\n\n    it('elementIsVisible', function() {\n      return runElementStateTest(\n          until.elementIsVisible,\n          CommandName.IS_ELEMENT_DISPLAYED, [false, false, true]);\n    });\n\n    it('elementIsNotVisible', function() {\n      return runElementStateTest(\n          until.elementIsNotVisible,\n          CommandName.IS_ELEMENT_DISPLAYED, [true, true, false]);\n    });\n\n    it('elementIsEnabled', function() {\n      return runElementStateTest(\n          until.elementIsEnabled,\n          CommandName.IS_ELEMENT_ENABLED, [false, false, true]);\n    });\n\n    it('elementIsDisabled', function() {\n      return runElementStateTest(\n          until.elementIsDisabled,\n          CommandName.IS_ELEMENT_ENABLED, [true, true, false]);\n    });\n\n    it('elementIsSelected', function() {\n      return runElementStateTest(\n          until.elementIsSelected,\n          CommandName.IS_ELEMENT_SELECTED, [false, false, true]);\n    });\n\n    it('elementIsNotSelected', function() {\n      return runElementStateTest(\n          until.elementIsNotSelected,\n          CommandName.IS_ELEMENT_SELECTED, [true, true, false]);\n    });\n\n    it('elementTextIs', function() {\n      return runElementStateTest(\n          until.elementTextIs, 'foobar',\n          CommandName.GET_ELEMENT_TEXT,\n          ['foo', 'fooba', 'foobar']);\n    });\n\n    it('elementTextContains', function() {\n      return runElementStateTest(\n          until.elementTextContains, 'bar',\n          CommandName.GET_ELEMENT_TEXT,\n          ['foo', 'foobaz', 'foobarbaz']);\n    });\n\n    it('elementTextMatches', function() {\n      return runElementStateTest(\n          until.elementTextMatches, /fo+bar{3}/,\n          CommandName.GET_ELEMENT_TEXT,\n          ['foo', 'foobar', 'fooobarrr']);\n    });\n  });\n\n  describe('WebElementCondition', function() {\n    it('fails if wait completes with a non-WebElement value', function() {\n      let result = driver.wait(\n          new webdriver.WebElementCondition('testing', () => 123), 1000);\n\n      return result.then(\n          () => assert.fail('expected to fail'),\n          function(e) {\n            assert.ok(e instanceof TypeError);\n            assert.equal(\n                'WebElementCondition did not resolve to a WebElement: '\n                    + '[object Number]',\n                e.message);\n          });\n    });\n  });\n});\n"]}