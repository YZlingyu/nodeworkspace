{"version":3,"sources":["webdriver_test.js"],"names":[],"mappings":"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","file":"webdriver_test-compiled.js","sourcesContent":["// Licensed to the Software Freedom Conservancy (SFC) under one\n// or more contributor license agreements.  See the NOTICE file\n// distributed with this work for additional information\n// regarding copyright ownership.  The SFC licenses this file\n// to you under the Apache License, Version 2.0 (the\n// \"License\"); you may not use this file except in compliance\n// with the License.  You may obtain a copy of the License at\n//\n//   http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing,\n// software distributed under the License is distributed on an\n// \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n// KIND, either express or implied.  See the License for the\n// specific language governing permissions and limitations\n// under the License.\n\n'use strict';\n\nconst testutil = require('./testutil');\n\nconst By = require('../../lib/by').By;\nconst Capabilities = require('../../lib/capabilities').Capabilities;\nconst Executor = require('../../lib/command').Executor;\nconst CName = require('../../lib/command').Name;\nconst error = require('../../lib/error');\nconst Button = require('../../lib/input').Button;\nconst Key = require('../../lib/input').Key;\nconst logging = require('../../lib/logging');\nconst Session = require('../../lib/session').Session;\nconst promise = require('../../lib/promise');\nconst {enablePromiseManager, promiseManagerSuite} = require('../../lib/test/promise');\nconst until = require('../../lib/until');\nconst Alert = require('../../lib/webdriver').Alert;\nconst AlertPromise = require('../../lib/webdriver').AlertPromise;\nconst UnhandledAlertError = require('../../lib/webdriver').UnhandledAlertError;\nconst WebDriver = require('../../lib/webdriver').WebDriver;\nconst WebElement = require('../../lib/webdriver').WebElement;\nconst WebElementPromise = require('../../lib/webdriver').WebElementPromise;\n\nconst assert = require('assert');\nconst sinon = require('sinon');\n\nconst SESSION_ID = 'test_session_id';\n\n// Aliases for readability.\nconst NativePromise = Promise;\nconst StubError = testutil.StubError;\nconst assertIsInstance = testutil.assertIsInstance;\nconst assertIsStubError = testutil.assertIsStubError;\nconst throwStubError = testutil.throwStubError;\nconst fail = (msg) => assert.fail(msg);\n\ndescribe('WebDriver', function() {\n  const LOG = logging.getLogger('webdriver.test');\n\n  // before(function() {\n  //   logging.getLogger('webdriver').setLevel(logging.Level.ALL);\n  //   logging.installConsoleHandler();\n  // });\n\n  // after(function() {\n  //   logging.getLogger('webdriver').setLevel(null);\n  //   logging.removeConsoleHandler();\n  // });\n\n  var driver;\n  var flow;\n  var uncaughtExceptions;\n\n  beforeEach(function setUp() {\n    flow = promise.controlFlow();\n    uncaughtExceptions = [];\n    flow.on('uncaughtException', onUncaughtException);\n  });\n\n  afterEach(function tearDown() {\n    if (!promise.USE_PROMISE_MANAGER) {\n      return;\n    }\n    return waitForIdle(flow).then(function() {\n      assert.deepEqual([], uncaughtExceptions);\n      flow.reset();\n    });\n  });\n\n  function onUncaughtException(e) {\n    uncaughtExceptions.push(e);\n  }\n\n  function defer() {\n    let d = {};\n    let promise = new Promise((resolve, reject) => {\n      Object.assign(d, {resolve, reject});\n    });\n    d.promise = promise;\n    return d;\n  }\n\n  function waitForIdle(opt_flow) {\n    if (!promise.USE_PROMISE_MANAGER) {\n      return Promise.resolve();\n    }\n    var theFlow = opt_flow || flow;\n    return new Promise(function(fulfill, reject) {\n      if (theFlow.isIdle()) {\n        fulfill();\n        return;\n      }\n      theFlow.once('idle', fulfill);\n      theFlow.once('uncaughtException', reject);\n    });\n  }\n\n  function waitForAbort(opt_flow, opt_n) {\n    var n = opt_n || 1;\n    var theFlow = opt_flow || flow;\n    theFlow.removeAllListeners(\n        promise.ControlFlow.EventType.UNCAUGHT_EXCEPTION);\n    return new Promise(function(fulfill, reject) {\n      theFlow.once('idle', function() {\n        reject(Error('expected flow to report an unhandled error'));\n      });\n\n      var errors = [];\n      theFlow.on('uncaughtException', onError);\n      function onError(e) {\n        errors.push(e);\n        if (errors.length === n) {\n          theFlow.removeListener('uncaughtException', onError);\n          fulfill(n === 1 ? errors[0] : errors);\n        }\n      }\n    });\n  }\n\n  function expectedError(ctor, message) {\n    return function(e) {\n      assertIsInstance(ctor, e);\n      assert.equal(message, e.message);\n    };\n  }\n\n  class Expectation {\n    constructor(executor, name, opt_parameters) {\n      this.executor_ = executor;\n      this.name_ = name;\n      this.times_ = 1;\n      this.sessionId_ = SESSION_ID;\n      this.check_ = null;\n      this.toDo_ = null;\n      this.withParameters(opt_parameters || {});\n    }\n\n    anyTimes() {\n      this.times_ = Infinity;\n      return this;\n    }\n\n    times(n) {\n      this.times_ = n;\n      return this;\n    }\n\n    withParameters(parameters) {\n      this.parameters_ = parameters;\n      if (this.name_ !== CName.NEW_SESSION) {\n        this.parameters_['sessionId'] = this.sessionId_;\n      }\n      return this;\n    }\n\n    andReturn(code, opt_value) {\n      this.toDo_ = function(command) {\n        LOG.info('executing ' + command.getName() + '; returning ' + code);\n        return Promise.resolve(opt_value !== void(0) ? opt_value : null);\n      };\n      return this;\n    }\n\n    andReturnSuccess(opt_value) {\n      this.toDo_ = function(command) {\n        LOG.info('executing ' + command.getName() + '; returning success');\n        return Promise.resolve(opt_value !== void(0) ? opt_value : null);\n      };\n      return this;\n    }\n\n    andReturnError(error) {\n      if (typeof error === 'number') {\n        throw Error('need error type');\n      }\n      this.toDo_ = function(command) {\n        LOG.info('executing ' + command.getName() + '; returning failure');\n        return Promise.reject(error);\n      };\n      return this;\n    }\n\n    expect(name, opt_parameters) {\n      this.end();\n      return this.executor_.expect(name, opt_parameters);\n    }\n\n    end() {\n      if (!this.toDo_) {\n        this.andReturnSuccess(null);\n      }\n      return this.executor_;\n    }\n\n    execute(command) {\n      assert.deepEqual(this.parameters_, command.getParameters());\n      return this.toDo_(command);\n    }\n  }\n\n  class FakeExecutor {\n    constructor() {\n      this.commands_ = new Map;\n    }\n\n    execute(command) {\n      let expectations = this.commands_.get(command.getName());\n      if (!expectations || !expectations.length) {\n        assert.fail('unexpected command: ' + command.getName());\n        return;\n      }\n\n      let next = expectations[0];\n      let result = next.execute(command);\n      if (next.times_ != Infinity) {\n        next.times_ -= 1;\n        if (!next.times_) {\n          expectations.shift();\n        }\n      }\n      return result;\n    }\n\n    expect(commandName, opt_parameters) {\n      if (!this.commands_.has(commandName)) {\n        this.commands_.set(commandName, []);\n      }\n      let e = new Expectation(this, commandName, opt_parameters);\n      this.commands_.get(commandName).push(e);\n      return e;\n    }\n\n    createDriver(opt_session) {\n      let session = opt_session || new Session(SESSION_ID, {});\n      return new WebDriver(session, this);\n    }\n  }\n\n\n  /////////////////////////////////////////////////////////////////////////////\n  //\n  //    Tests\n  //\n  /////////////////////////////////////////////////////////////////////////////\n\n\n  describe('testAttachToSession', function() {\n    it('sessionIsAvailable', function() {\n      let aSession = new Session(SESSION_ID, {'browserName': 'firefox'});\n      let executor = new FakeExecutor().\n          expect(CName.DESCRIBE_SESSION).\n          withParameters({'sessionId': SESSION_ID}).\n          andReturnSuccess(aSession).\n          end();\n\n      let driver = WebDriver.attachToSession(executor, SESSION_ID);\n      return driver.getSession().then(v => assert.strictEqual(v, aSession));\n    });\n\n    it('failsToGetSessionInfo', function() {\n      let e = new Error('boom');\n      let executor = new FakeExecutor().\n          expect(CName.DESCRIBE_SESSION).\n          withParameters({'sessionId': SESSION_ID}).\n          andReturnError(e).\n          end();\n\n      let driver = WebDriver.attachToSession(executor, SESSION_ID);\n      return driver.getSession()\n          .then(() => assert.fail('should have failed!'),\n                (actual) => assert.strictEqual(actual, e));\n    });\n\n    it('remote end does not recognize DESCRIBE_SESSION command', function() {\n      let e = new error.UnknownCommandError;\n      let executor = new FakeExecutor().\n          expect(CName.DESCRIBE_SESSION).\n          withParameters({'sessionId': SESSION_ID}).\n          andReturnError(e).\n          end();\n\n      let driver = WebDriver.attachToSession(executor, SESSION_ID);\n      return driver.getSession().then(session => {\n        assert.ok(session instanceof Session);\n        assert.strictEqual(session.getId(), SESSION_ID);\n        assert.equal(session.getCapabilities().size, 0);\n      });\n    });\n\n    it('usesActiveFlowByDefault', function() {\n      let executor = new FakeExecutor().\n          expect(CName.DESCRIBE_SESSION).\n          withParameters({'sessionId': SESSION_ID}).\n          andReturnSuccess({}).\n          end();\n\n      var driver = WebDriver.attachToSession(executor, SESSION_ID);\n      assert.equal(driver.controlFlow(), promise.controlFlow());\n\n      return waitForIdle(driver.controlFlow());\n    });\n\n    enablePromiseManager(() => {\n      it('canAttachInCustomFlow', function() {\n        let executor = new FakeExecutor().\n            expect(CName.DESCRIBE_SESSION).\n            withParameters({'sessionId': SESSION_ID}).\n            andReturnSuccess({}).\n            end();\n\n        var otherFlow = new promise.ControlFlow();\n        var driver = WebDriver.attachToSession(executor, SESSION_ID, otherFlow);\n        assert.equal(otherFlow, driver.controlFlow());\n        assert.notEqual(otherFlow, promise.controlFlow());\n\n        return waitForIdle(otherFlow);\n      });\n    });\n  });\n\n  describe('testCreateSession', function() {\n    it('happyPathWithCapabilitiesHashObject', function() {\n      let aSession = new Session(SESSION_ID, {'browserName': 'firefox'});\n      let executor = new FakeExecutor().\n          expect(CName.NEW_SESSION).\n          withParameters({\n            'desiredCapabilities': {'browserName': 'firefox'}\n          }).\n          andReturnSuccess(aSession).\n          end();\n\n      var driver = WebDriver.createSession(executor, {\n        'browserName': 'firefox'\n      });\n      return driver.getSession().then(v => assert.strictEqual(v, aSession));\n    });\n\n    it('happyPathWithCapabilitiesInstance', function() {\n      let aSession = new Session(SESSION_ID, {'browserName': 'firefox'});\n      let executor = new FakeExecutor().\n          expect(CName.NEW_SESSION).\n          withParameters({'desiredCapabilities': {'browserName': 'firefox'}}).\n          andReturnSuccess(aSession).\n          end();\n\n      var driver = WebDriver.createSession(executor, Capabilities.firefox());\n      return driver.getSession().then(v => assert.strictEqual(v, aSession));\n    });\n\n    it('handles desired and required capabilities', function() {\n      let aSession = new Session(SESSION_ID, {'browserName': 'firefox'});\n      let executor = new FakeExecutor().\n          expect(CName.NEW_SESSION).\n          withParameters({\n            'desiredCapabilities': {'foo': 'bar'},\n            'requiredCapabilities': {'bim': 'baz'}\n          }).\n          andReturnSuccess(aSession).\n          end();\n\n      let desired = new Capabilities().set('foo', 'bar');\n      let required = new Capabilities().set('bim', 'baz');\n      var driver = WebDriver.createSession(executor, {desired, required});\n      return driver.getSession().then(v => assert.strictEqual(v, aSession));\n    });\n\n    it('failsToCreateSession', function() {\n      let executor = new FakeExecutor().\n          expect(CName.NEW_SESSION).\n          withParameters({'desiredCapabilities': {'browserName': 'firefox'}}).\n          andReturnError(new StubError()).\n          end();\n\n      var driver =\n          WebDriver.createSession(executor, {'browserName': 'firefox'});\n      return driver.getSession().then(fail, assertIsStubError);\n    });\n\n    it('invokes quit callback if it fails to create a session', function() {\n      let called = false;\n      let executor = new FakeExecutor()\n          .expect(CName.NEW_SESSION)\n          .withParameters({'desiredCapabilities': {'browserName': 'firefox'}})\n          .andReturnError(new StubError())\n          .end();\n\n      var driver =\n          WebDriver.createSession(executor, {'browserName': 'firefox'},\n              null, null, () => called = true);\n      return driver.getSession().then(fail, err => {\n        assert.ok(called);\n        assertIsStubError(err);\n      });\n    });\n\n    it('usesActiveFlowByDefault', function() {\n      let executor = new FakeExecutor().\n          expect(CName.NEW_SESSION).\n          withParameters({'desiredCapabilities': {}}).\n          andReturnSuccess(new Session(SESSION_ID)).\n          end();\n\n      var driver = WebDriver.createSession(executor, {});\n      assert.equal(promise.controlFlow(), driver.controlFlow());\n\n      return waitForIdle(driver.controlFlow());\n    });\n\n    enablePromiseManager(() => {\n      it('canCreateInCustomFlow', function() {\n        let executor = new FakeExecutor().\n            expect(CName.NEW_SESSION).\n            withParameters({'desiredCapabilities': {}}).\n            andReturnSuccess({}).\n            end();\n\n        var otherFlow = new promise.ControlFlow();\n        var driver = WebDriver.createSession(executor, {}, otherFlow);\n        assert.equal(otherFlow, driver.controlFlow());\n        assert.notEqual(otherFlow, promise.controlFlow());\n\n        return waitForIdle(otherFlow);\n      });\n\n      describe('creation failures bubble up in control flow', function() {\n        function runTest(...args) {\n          let executor = new FakeExecutor()\n              .expect(CName.NEW_SESSION)\n              .withParameters({'desiredCapabilities': {'browserName': 'firefox'}})\n              .andReturnError(new StubError())\n              .end();\n\n          WebDriver.createSession(\n              executor, {'browserName': 'firefox'}, ...args);\n          return waitForAbort().then(assertIsStubError);\n        }\n\n        it('no onQuit callback', () => runTest());\n        it('has onQuit callback', () => runTest(null, null, function() {}));\n\n        it('onQuit callback failure suppress creation failure', function() {\n          let e = new Error('hi!');\n          let executor = new FakeExecutor()\n              .expect(CName.NEW_SESSION)\n              .withParameters({'desiredCapabilities': {'browserName': 'firefox'}})\n              .andReturnError(new StubError())\n              .end();\n\n          WebDriver.createSession(\n              executor, {'browserName': 'firefox'}, null, null,\n              () => {throw e});\n          return waitForAbort().then(err => assert.strictEqual(err, e));\n        });\n      });\n    });\n  });\n\n  it('testDoesNotExecuteCommandIfSessionDoesNotResolve', function() {\n    var session = Promise.reject(new StubError);\n    return new FakeExecutor().createDriver(session)\n        .getTitle()\n        .then(_ => assert.fail('should have failed'), assertIsStubError);\n  });\n\n  it('testCommandReturnValuesArePassedToFirstCallback', function() {\n    let executor = new FakeExecutor().\n        expect(CName.GET_TITLE).andReturnSuccess('Google Search').\n        end();\n\n    var driver = executor.createDriver();\n    return driver.getTitle()\n        .then(title => assert.equal('Google Search', title));\n  });\n\n  it('testStopsCommandExecutionWhenAnErrorOccurs', function() {\n    let e = new error.NoSuchWindowError('window not found');\n    let executor = new FakeExecutor().\n        expect(CName.SWITCH_TO_WINDOW).\n        withParameters({\n          'name': 'foo',\n          'handle': 'foo'\n        }).\n        andReturnError(e).\n        end();\n\n    let driver = executor.createDriver();\n    return driver.switchTo().window('foo')\n        .then(\n            _ => driver.getTitle(),  // mock should blow if this gets executed\n            v => assert.strictEqual(v, e));\n  });\n\n  it('testCanSuppressCommandFailures', function() {\n    let e = new error.NoSuchWindowError('window not found');\n    let executor = new FakeExecutor().\n        expect(CName.SWITCH_TO_WINDOW).\n            withParameters({\n              'name': 'foo',\n              'handle': 'foo'\n            }).\n            andReturnError(e).\n        expect(CName.GET_TITLE).\n            andReturnSuccess('Google Search').\n        end();\n\n    var driver = executor.createDriver();\n    driver.switchTo().window('foo')\n        .catch(v => assert.strictEqual(v, e));\n    driver.getTitle();\n    return waitForIdle();\n  });\n\n  it('testErrorsPropagateUpToTheRunningApplication', function() {\n    let e = new error.NoSuchWindowError('window not found');\n    let executor = new FakeExecutor().\n        expect(CName.SWITCH_TO_WINDOW).\n            withParameters({\n              'name': 'foo',\n              'handle': 'foo'\n            }).\n            andReturnError(e).\n        end();\n\n    return executor.createDriver()\n        .switchTo().window('foo')\n        .then(_ => assert.fail(), v => assert.strictEqual(v, e));\n  });\n\n  it('testErrbacksThatReturnErrorsStillSwitchToCallbackChain', function() {\n    let executor = new FakeExecutor().\n        expect(CName.SWITCH_TO_WINDOW).\n            withParameters({\n              'name': 'foo',\n              'handle': 'foo'\n            }).\n            andReturnError(new error.NoSuchWindowError('window not found')).\n        end();\n\n    var driver = executor.createDriver();\n    return driver.switchTo().window('foo').\n        catch(function() { return new StubError; });\n        then(assertIsStubError, () => assert.fail());\n  });\n\n  it('testErrbacksThrownCanOverrideOriginalError', function() {\n    let executor = new FakeExecutor().\n        expect(CName.SWITCH_TO_WINDOW, {\n          'name': 'foo',\n          'handle': 'foo'\n        }).\n        andReturnError(new error.NoSuchWindowError('window not found')).\n        end();\n\n    var driver = executor.createDriver();\n    return driver.switchTo().window('foo')\n        .catch(throwStubError)\n        .then(assert.fail, assertIsStubError);\n  });\n\n  it('testReportsErrorWhenExecutingCommandsAfterExecutingAQuit', function() {\n    let executor = new FakeExecutor().\n        expect(CName.QUIT).\n        end();\n\n    let verifyError = expectedError(\n        error.NoSuchSessionError,\n        'This driver instance does not have a valid session ID ' +\n        '(did you call WebDriver.quit()?) and may no longer be used.');\n\n    let driver = executor.createDriver();\n    return driver.quit()\n        .then(_ => driver.get('http://www.google.com'))\n        .then(assert.fail, verifyError);\n  });\n\n  it('testCallbackCommandsExecuteBeforeNextCommand', function() {\n    let executor = new FakeExecutor().\n        expect(CName.GET_CURRENT_URL).\n        expect(CName.GET, {'url': 'http://www.google.com'}).\n        expect(CName.CLOSE).\n        expect(CName.GET_TITLE).\n        end();\n\n    var driver = executor.createDriver();\n    driver.getCurrentUrl().then(function() {\n      driver.get('http://www.google.com').then(function() {\n        driver.close();\n      });\n    });\n    driver.getTitle();\n\n    return waitForIdle();\n  });\n\n  enablePromiseManager(() => {\n    it('testEachCallbackFrameRunsToCompletionBeforeTheNext', function() {\n      let executor = new FakeExecutor().\n          expect(CName.GET_TITLE).\n          expect(CName.GET_CURRENT_URL).\n          expect(CName.GET_CURRENT_WINDOW_HANDLE).\n          expect(CName.CLOSE).\n          expect(CName.QUIT).\n          end();\n\n      var driver = executor.createDriver();\n      driver.getTitle().\n          // Everything in this callback...\n          then(function() {\n            driver.getCurrentUrl();\n            driver.getWindowHandle();\n          }).\n          // ...should execute before everything in this callback.\n          then(function() {\n            driver.close();\n          });\n      // This should execute after everything above\n      driver.quit();\n\n      return waitForIdle();\n    });\n  });\n\n  describe('returningAPromise', function() {\n    it('fromACallback', function() {\n      let executor = new FakeExecutor().\n          expect(CName.GET_TITLE).\n          expect(CName.GET_CURRENT_URL).\n              andReturnSuccess('http://www.google.com').\n          end();\n\n      var driver = executor.createDriver();\n      return driver.getTitle().\n          then(function() {\n            return driver.getCurrentUrl();\n          }).\n          then(function(value) {\n            assert.equal('http://www.google.com', value);\n          });\n    });\n\n    it('fromAnErrbackSuppressesTheError', function() {\n      let executor = new FakeExecutor().\n          expect(CName.SWITCH_TO_WINDOW, {\n            'name': 'foo',\n            'handle': 'foo'\n          }).\n              andReturnError(new StubError()).\n          expect(CName.GET_CURRENT_URL).\n              andReturnSuccess('http://www.google.com').\n          end();\n\n      var driver = executor.createDriver();\n      return driver.switchTo().window('foo').\n          catch(function(e) {\n            assertIsStubError(e);\n            return driver.getCurrentUrl();\n          }).\n          then(url => assert.equal('http://www.google.com', url));\n    });\n  });\n\n  describe('customFunctions', function() {\n    it('returnsANonPromiseValue', function() {\n      var driver = new FakeExecutor().createDriver();\n      return driver.call(() => 'abc123').then(function(value) {\n        assert.equal('abc123', value);\n      });\n    });\n\n    enablePromiseManager(() => {\n      it('executionOrderWithCustomFunctions', function() {\n        var msg = [];\n        let executor = new FakeExecutor().\n            expect(CName.GET_TITLE).andReturnSuccess('cheese ').\n            expect(CName.GET_CURRENT_URL).andReturnSuccess('tasty').\n            end();\n\n        var driver = executor.createDriver();\n\n        var pushMsg = msg.push.bind(msg);\n        driver.getTitle().then(pushMsg);\n        driver.call(() => 'is ').then(pushMsg);\n        driver.getCurrentUrl().then(pushMsg);\n        driver.call(() => '!').then(pushMsg);\n\n        return waitForIdle().then(function() {\n          assert.equal('cheese is tasty!', msg.join(''));\n        });\n      });\n    });\n\n    it('passingArgumentsToACustomFunction', function() {\n      var add = function(a, b) {\n        return a + b;\n      };\n      var driver = new FakeExecutor().createDriver();\n      return driver.call(add, null, 1, 2).then(function(value) {\n        assert.equal(3, value);\n      });\n    });\n\n    it('passingPromisedArgumentsToACustomFunction', function() {\n      var promisedArg = Promise.resolve(2);\n      var add = function(a, b) {\n        return a + b;\n      };\n      var driver = new FakeExecutor().createDriver();\n      return driver.call(add, null, 1, promisedArg).then(function(value) {\n        assert.equal(3, value);\n      });\n    });\n\n    it('passingArgumentsAndScopeToACustomFunction', function() {\n      function Foo(name) {\n        this.name = name;\n      }\n      Foo.prototype.getName = function() {\n        return this.name;\n      };\n      var foo = new Foo('foo');\n\n      var driver = new FakeExecutor().createDriver();\n      return driver.call(foo.getName, foo).then(function(value) {\n        assert.equal('foo', value);\n      });\n    });\n\n    it('customFunctionThrowsAnError', function() {\n      var driver = new FakeExecutor().createDriver();\n      return driver.call(throwStubError).then(fail, assertIsStubError);\n    });\n\n    it('customFunctionSchedulesCommands', function() {\n      let executor = new FakeExecutor().\n          expect(CName.GET_TITLE).\n          expect(CName.CLOSE).\n          expect(CName.QUIT).\n          end();\n\n      var driver = executor.createDriver();\n      driver.call(function() {\n        driver.getTitle();\n        driver.close();\n      });\n      driver.quit();\n      return waitForIdle();\n    });\n\n    it('returnsATaskResultAfterSchedulingAnother', function() {\n      let executor = new FakeExecutor().\n          expect(CName.GET_TITLE).\n              andReturnSuccess('Google Search').\n          expect(CName.CLOSE).\n          end();\n\n      var driver = executor.createDriver();\n      return driver.call(function() {\n        var title = driver.getTitle();\n        driver.close();\n        return title;\n      }).then(function(title) {\n        assert.equal('Google Search', title);\n      });\n    });\n\n    it('hasANestedCommandThatFails', function() {\n      let executor = new FakeExecutor().\n          expect(CName.SWITCH_TO_WINDOW, {\n            'name': 'foo',\n            'handle': 'foo'\n          }).\n          andReturnError(new StubError()).\n          end();\n\n      var driver = executor.createDriver();\n      return driver.call(function() {\n        return driver.switchTo().window('foo');\n      }).then(fail, assertIsStubError);\n    });\n\n    enablePromiseManager(() => {\n      it('doesNotCompleteUntilReturnedPromiseIsResolved', function() {\n        var order = [];\n        var driver = new FakeExecutor().createDriver();\n\n        var d = promise.defer();\n        d.promise.then(function() {\n          order.push('b');\n        });\n\n        driver.call(function() {\n          order.push('a');\n          return d.promise;\n        });\n        driver.call(function() {\n          order.push('c');\n        });\n\n        // timeout to ensure the first function starts its execution before we\n        // trigger d's callbacks.\n        return new Promise(f => setTimeout(f, 0)).then(function() {\n          assert.deepEqual(['a'], order);\n          d.fulfill();\n          return waitForIdle().then(function() {\n            assert.deepEqual(['a', 'b', 'c'], order);\n          });\n        });\n      });\n    });\n\n    it('returnsADeferredAction', function() {\n      let executor = new FakeExecutor().\n          expect(CName.GET_TITLE).andReturnSuccess('Google').\n          end();\n\n      var driver = executor.createDriver();\n      driver.call(function() {\n        return driver.getTitle();\n      }).then(function(title) {\n        assert.equal('Google', title);\n      });\n      return waitForIdle();\n    });\n  });\n\n  describe('nestedCommands', function() {\n    enablePromiseManager(() => {\n      it('commandExecutionOrder', function() {\n        var msg = [];\n        var driver = new FakeExecutor().createDriver();\n        driver.call(msg.push, msg, 'a');\n        driver.call(function() {\n          driver.call(msg.push, msg, 'c');\n          driver.call(function() {\n            driver.call(msg.push, msg, 'e');\n            driver.call(msg.push, msg, 'f');\n          });\n          driver.call(msg.push, msg, 'd');\n        });\n        driver.call(msg.push, msg, 'b');\n        return waitForIdle().then(function() {\n          assert.equal('acefdb', msg.join(''));\n        });\n      });\n\n      it('basicUsage', function() {\n        var msg = [];\n        var driver = new FakeExecutor().createDriver();\n        var pushMsg = msg.push.bind(msg);\n        driver.call(() => 'cheese ').then(pushMsg);\n        driver.call(function() {\n          driver.call(() => 'is ').then(pushMsg);\n          driver.call(() => 'tasty').then(pushMsg);\n        });\n        driver.call(() => '!').then(pushMsg);\n        return waitForIdle().then(function() {\n          assert.equal('cheese is tasty!', msg.join(''));\n        });\n      });\n\n      it('normalCommandAfterNestedCommandThatReturnsAnAction', function() {\n        var msg = [];\n        let executor = new FakeExecutor().\n            expect(CName.CLOSE).\n            end();\n        var driver = executor.createDriver();\n        driver.call(function() {\n          return driver.call(function() {\n            msg.push('a');\n            return driver.call(() => 'foobar');\n          });\n        });\n        driver.close().then(function() {\n          msg.push('b');\n        });\n        return waitForIdle().then(function() {\n          assert.equal('ab', msg.join(''));\n        });\n      });\n    });\n\n    it('canReturnValueFromNestedFunction', function() {\n      var driver = new FakeExecutor().createDriver();\n      return driver.call(function() {\n        return driver.call(function() {\n          return driver.call(() => 'foobar');\n        });\n      }).then(function(value) {\n        assert.equal('foobar', value);\n      });\n    });\n\n    it('errorsBubbleUp_caught', function() {\n      var driver = new FakeExecutor().createDriver();\n      var result = driver.call(function() {\n        return driver.call(function() {\n          return driver.call(throwStubError);\n        });\n      }).then(fail, assertIsStubError);\n      return Promise.all([waitForIdle(), result]);\n    });\n\n    it('errorsBubbleUp_uncaught', function() {\n      var driver = new FakeExecutor().createDriver();\n      return driver.call(function() {\n        return driver.call(function() {\n          return driver.call(throwStubError);\n        });\n      })\n      .then(_ => assert.fail('should have failed'), assertIsStubError);\n    });\n\n    it('canScheduleCommands', function() {\n      let executor = new FakeExecutor().\n          expect(CName.GET_TITLE).\n          expect(CName.CLOSE).\n          end();\n\n      var driver = executor.createDriver();\n      driver.call(function() {\n        driver.call(function() {\n          driver.getTitle();\n        });\n        driver.close();\n      });\n      return waitForIdle();\n    });\n  });\n\n  describe('WebElementPromise', function() {\n    let driver = new FakeExecutor().createDriver();\n\n    it('resolvesWhenUnderlyingElementDoes', function() {\n      let el = new WebElement(driver, {'ELEMENT': 'foo'});\n      return new WebElementPromise(driver, Promise.resolve(el))\n          .then(e => assert.strictEqual(e, el));\n    });\n\n    it('resolvesBeforeCallbacksOnWireValueTrigger', function() {\n      var el = defer();\n\n      var element = new WebElementPromise(driver, el.promise);\n      var messages = [];\n\n      let steps = [\n        element.then(_ => messages.push('element resolved')),\n        element.getId().then(_ => messages.push('wire value resolved'))\n      ];\n\n      el.resolve(new WebElement(driver, {'ELEMENT': 'foo'}));\n      return Promise.all(steps).then(function() {\n        assert.deepEqual([\n          'element resolved',\n          'wire value resolved'\n        ], messages);\n      });\n    });\n\n    it('isRejectedIfUnderlyingIdIsRejected', function() {\n      let element =\n          new WebElementPromise(driver, Promise.reject(new StubError));\n      return element.then(fail, assertIsStubError);\n    });\n  });\n\n  describe('executeScript', function() {\n    it('nullReturnValue', function() {\n      let executor = new FakeExecutor().\n          expect(CName.EXECUTE_SCRIPT).\n              withParameters({\n                'script': 'return document.body;',\n                'args': []\n              }).\n              andReturnSuccess(null).\n          end();\n\n      var driver = executor.createDriver();\n      return driver.executeScript('return document.body;')\n          .then((result) => assert.equal(null, result));\n    });\n\n    it('primitiveReturnValue', function() {\n      let executor = new FakeExecutor().\n          expect(CName.EXECUTE_SCRIPT).\n              withParameters({\n                'script': 'return document.body;',\n                'args': []\n              }).\n              andReturnSuccess(123).\n          end();\n\n      var driver = executor.createDriver();\n      return driver.executeScript('return document.body;')\n          .then((result) => assert.equal(123, result));\n    });\n\n    it('webElementReturnValue', function() {\n      var json = WebElement.buildId('foo');\n\n      let executor = new FakeExecutor().\n          expect(CName.EXECUTE_SCRIPT).\n              withParameters({\n                'script': 'return document.body;',\n                'args': []\n              }).\n              andReturnSuccess(json).\n          end();\n\n      var driver = executor.createDriver();\n      return driver.executeScript('return document.body;')\n          .then((element) => element.getId())\n          .then((id) => assert.equal(id, 'foo'));\n    });\n\n    it('arrayReturnValue', function() {\n      var json = [WebElement.buildId('foo')];\n\n      let executor = new FakeExecutor().\n          expect(CName.EXECUTE_SCRIPT).\n              withParameters({\n                'script': 'return document.body;',\n                'args': []\n              }).\n              andReturnSuccess(json).\n          end();\n\n      var driver = executor.createDriver();\n      return driver.executeScript('return document.body;')\n          .then(function(array) {\n            assert.equal(1, array.length);\n            return array[0].getId();\n          })\n          .then((id) => assert.equal('foo', id));\n    });\n\n    it('objectReturnValue', function() {\n      var json = {'foo': WebElement.buildId('foo')};\n\n      let executor = new FakeExecutor().\n          expect(CName.EXECUTE_SCRIPT).\n              withParameters({\n                'script': 'return document.body;',\n                'args': []\n              }).\n              andReturnSuccess(json).\n          end();\n\n      var driver = executor.createDriver();\n      var callback;\n      return driver.executeScript('return document.body;')\n          .then((obj) => obj['foo'].getId())\n          .then((id) => assert.equal(id, 'foo'));\n    });\n\n    it('scriptAsFunction', function() {\n      let executor = new FakeExecutor().\n          expect(CName.EXECUTE_SCRIPT).\n              withParameters({\n                'script': 'return (' + function() {} +\n                          ').apply(null, arguments);',\n                'args': []\n              }).\n              andReturnSuccess(null).\n          end();\n\n      var driver = executor.createDriver();\n      return driver.executeScript(function() {});\n    });\n\n    it('simpleArgumentConversion', function() {\n      let executor = new FakeExecutor().\n          expect(CName.EXECUTE_SCRIPT).\n              withParameters({\n                'script': 'return 1;',\n                'args': ['abc', 123, true, [123, {'foo': 'bar'}]]\n              }).\n              andReturnSuccess(null).\n          end();\n\n      var driver = executor.createDriver();\n      return driver.executeScript(\n          'return 1;', 'abc', 123, true, [123, {'foo': 'bar'}]);\n    });\n\n    it('webElementArgumentConversion', function() {\n      var elementJson = WebElement.buildId('fefifofum');\n\n      let executor = new FakeExecutor().\n          expect(CName.EXECUTE_SCRIPT).\n              withParameters({\n                'script': 'return 1;',\n                'args': [elementJson]\n              }).\n              andReturnSuccess(null).\n          end();\n\n      var driver = executor.createDriver();\n      return driver.executeScript('return 1;',\n          new WebElement(driver, 'fefifofum'));\n    });\n\n    it('webElementPromiseArgumentConversion', function() {\n      var elementJson = WebElement.buildId('bar');\n\n      let executor = new FakeExecutor().\n          expect(CName.FIND_ELEMENT,\n              {'using': 'css selector', 'value': '*[id=\"foo\"]'}).\n              andReturnSuccess(elementJson).\n          expect(CName.EXECUTE_SCRIPT).\n              withParameters({\n                'script': 'return 1;',\n                'args': [elementJson]\n              }).\n              andReturnSuccess(null).\n          end();\n\n      var driver = executor.createDriver();\n      var element = driver.findElement(By.id('foo'));\n      return driver.executeScript('return 1;', element);\n    });\n\n    it('argumentConversion', function() {\n      var elementJson = WebElement.buildId('fefifofum');\n\n      let executor = new FakeExecutor().\n          expect(CName.EXECUTE_SCRIPT).\n              withParameters({\n                'script': 'return 1;',\n                'args': ['abc', 123, true, elementJson, [123, {'foo': 'bar'}]]\n              }).\n              andReturnSuccess(null).\n          end();\n\n      var driver = executor.createDriver();\n      var element = new WebElement(driver, 'fefifofum');\n      return driver.executeScript('return 1;',\n          'abc', 123, true, element, [123, {'foo': 'bar'}]);\n    });\n\n    it('scriptReturnsAnError', function() {\n      let executor = new FakeExecutor().\n          expect(CName.EXECUTE_SCRIPT).\n              withParameters({\n                'script': 'throw Error(arguments[0]);',\n                'args': ['bam']\n              }).\n              andReturnError(new StubError).\n          end();\n      var driver = executor.createDriver();\n      return driver.executeScript('throw Error(arguments[0]);', 'bam').\n          then(fail, assertIsStubError);\n    });\n\n    it('failsIfArgumentIsARejectedPromise', function() {\n      let executor = new FakeExecutor();\n\n      var arg = Promise.reject(new StubError);\n      arg.catch(function() {});  // Suppress default handler.\n\n      var driver = executor.createDriver();\n      return driver.executeScript(function() {}, arg).\n          then(fail, assertIsStubError);\n    });\n  });\n\n  describe('executeAsyncScript', function() {\n    it('failsIfArgumentIsARejectedPromise', function() {\n      var arg = Promise.reject(new StubError);\n      arg.catch(function() {});  // Suppress default handler.\n\n      var driver = new FakeExecutor().createDriver();\n      return driver.executeAsyncScript(function() {}, arg).\n          then(fail, assertIsStubError);\n    });\n  });\n\n  describe('findElement', function() {\n    it('elementNotFound', function() {\n      let executor = new FakeExecutor().\n          expect(CName.FIND_ELEMENT,\n                 {using: 'css selector', value: '*[id=\"foo\"]'}).\n          andReturnError(new StubError).\n          end();\n\n      var driver = executor.createDriver();\n      return driver.findElement(By.id('foo'))\n          .then(assert.fail, assertIsStubError);\n    });\n\n    it('elementNotFoundInACallback', function() {\n      let executor = new FakeExecutor().\n          expect(CName.FIND_ELEMENT,\n                 {using: 'css selector', value: '*[id=\"foo\"]'}).\n          andReturnError(new StubError).\n          end();\n\n      var driver = executor.createDriver();\n      return Promise.resolve()\n          .then(_ => driver.findElement(By.id('foo')))\n          .then(assert.fail, assertIsStubError);\n    });\n\n    it('elementFound', function() {\n      let executor = new FakeExecutor().\n          expect(CName.FIND_ELEMENT,\n                 {using: 'css selector', value: '*[id=\"foo\"]'}).\n              andReturnSuccess(WebElement.buildId('bar')).\n          expect(CName.CLICK_ELEMENT, {'id': WebElement.buildId('bar')}).\n              andReturnSuccess().\n          end();\n\n      var driver = executor.createDriver();\n      var element = driver.findElement(By.id('foo'));\n      element.click();\n      return waitForIdle();\n    });\n\n    it('canUseElementInCallback', function() {\n      let executor = new FakeExecutor().\n          expect(CName.FIND_ELEMENT,\n                 {using: 'css selector', value: '*[id=\"foo\"]'}).\n              andReturnSuccess(WebElement.buildId('bar')).\n          expect(CName.CLICK_ELEMENT, {'id': WebElement.buildId('bar')}).\n              andReturnSuccess().\n          end();\n\n      var driver = executor.createDriver();\n      driver.findElement(By.id('foo')).then(function(element) {\n        element.click();\n      });\n      return waitForIdle();\n    });\n\n    it('byJs', function() {\n      let executor = new FakeExecutor().\n          expect(CName.EXECUTE_SCRIPT, {\n            'script': 'return document.body',\n            'args': []\n          }).\n          andReturnSuccess(WebElement.buildId('bar')).\n          expect(CName.CLICK_ELEMENT, {'id': WebElement.buildId('bar')}).\n          end();\n\n      var driver = executor.createDriver();\n      var element = driver.findElement(By.js('return document.body'));\n      element.click();  // just to make sure\n      return waitForIdle();\n    });\n\n    it('byJs_returnsNonWebElementValue', function() {\n      let executor = new FakeExecutor().\n          expect(CName.EXECUTE_SCRIPT, {'script': 'return 123', 'args': []}).\n          andReturnSuccess(123).\n          end();\n\n      var driver = executor.createDriver();\n      return driver.findElement(By.js('return 123'))\n          .then(assert.fail, function(e) {\n            assertIsInstance(TypeError, e);\n            assert.equal(\n                'Custom locator did not return a WebElement', e.message);\n          });\n    });\n\n    it('byJs_canPassArguments', function() {\n      var script = 'return document.getElementsByTagName(arguments[0]);';\n      let executor = new FakeExecutor().\n          expect(CName.EXECUTE_SCRIPT, {\n            'script': script,\n            'args': ['div']\n          }).\n          andReturnSuccess(WebElement.buildId('one')).\n          end();\n      var driver = executor.createDriver();\n      driver.findElement(By.js(script, 'div'));\n      return waitForIdle();\n    });\n\n    it('customLocator', function() {\n      let executor = new FakeExecutor().\n          expect(CName.FIND_ELEMENTS, {'using': 'css selector', 'value': 'a'}).\n              andReturnSuccess([\n                  WebElement.buildId('foo'),\n                  WebElement.buildId('bar')]).\n          expect(CName.CLICK_ELEMENT, {'id': WebElement.buildId('foo')}).\n          andReturnSuccess().\n          end();\n\n      var driver = executor.createDriver();\n      var element = driver.findElement(function(d) {\n        assert.equal(driver, d);\n        return d.findElements(By.tagName('a'));\n      });\n      return element.click();\n    });\n\n    it('customLocatorThrowsIfresultIsNotAWebElement', function() {\n      var driver = new FakeExecutor().createDriver();\n      return driver.findElement(_ => 1)\n          .then(assert.fail, function(e) {\n            assertIsInstance(TypeError, e);\n            assert.equal(\n              'Custom locator did not return a WebElement', e.message);\n          });\n    });\n  });\n\n  describe('findElements', function() {\n    it('returnsMultipleElements', function() {\n      var ids = ['foo', 'bar', 'baz'];\n      let executor = new FakeExecutor().\n          expect(CName.FIND_ELEMENTS, {'using':'css selector', 'value':'a'}).\n          andReturnSuccess(ids.map(WebElement.buildId)).\n          end();\n\n      var driver = executor.createDriver();\n      return driver.findElements(By.tagName('a'))\n          .then(function(elements) {\n            return promise.all(elements.map(function(e) {\n              assert.ok(e instanceof WebElement);\n              return e.getId();\n            }));\n          })\n          .then((actual) => assert.deepEqual(ids, actual));\n    });\n\n    it('byJs', function() {\n      var ids = ['foo', 'bar', 'baz'];\n      let executor = new FakeExecutor().\n          expect(CName.EXECUTE_SCRIPT, {\n            'script': 'return document.getElementsByTagName(\"div\");',\n            'args': []\n          }).\n          andReturnSuccess(ids.map(WebElement.buildId)).\n          end();\n\n      var driver = executor.createDriver();\n\n      return driver.\n          findElements(By.js('return document.getElementsByTagName(\"div\");')).\n          then(function(elements) {\n            return promise.all(elements.map(function(e) {\n              assert.ok(e instanceof WebElement);\n              return e.getId();\n            }));\n          }).\n          then((actual) => assert.deepEqual(ids, actual));\n    });\n\n    it('byJs_filtersOutNonWebElementResponses', function() {\n      var ids = ['foo', 'bar', 'baz'];\n      var json = [\n          WebElement.buildId(ids[0]),\n          123,\n          'a',\n          false,\n          WebElement.buildId(ids[1]),\n          {'not a web element': 1},\n          WebElement.buildId(ids[2])\n      ];\n      let executor = new FakeExecutor().\n          expect(CName.EXECUTE_SCRIPT, {\n            'script': 'return document.getElementsByTagName(\"div\");',\n            'args': []\n          }).\n          andReturnSuccess(json).\n          end();\n\n      var driver = executor.createDriver();\n      driver.findElements(By.js('return document.getElementsByTagName(\"div\");')).\n          then(function(elements) {\n            return promise.all(elements.map(function(e) {\n              assert.ok(e instanceof WebElement);\n              return e.getId();\n            }));\n          }).\n          then((actual) => assert.deepEqual(ids, actual));\n      return waitForIdle();\n    });\n\n    it('byJs_convertsSingleWebElementResponseToArray', function() {\n      let executor = new FakeExecutor().\n          expect(CName.EXECUTE_SCRIPT, {\n            'script': 'return document.getElementsByTagName(\"div\");',\n            'args': []\n          }).\n          andReturnSuccess(WebElement.buildId('foo')).\n          end();\n\n      var driver = executor.createDriver();\n      return driver.\n          findElements(By.js('return document.getElementsByTagName(\"div\");')).\n          then(function(elements) {\n            return promise.all(elements.map(function(e) {\n              assert.ok(e instanceof WebElement);\n              return e.getId();\n            }));\n          }).\n          then((actual) => assert.deepEqual(['foo'], actual));\n    });\n\n    it('byJs_canPassScriptArguments', function() {\n      var script = 'return document.getElementsByTagName(arguments[0]);';\n      let executor = new FakeExecutor().\n          expect(CName.EXECUTE_SCRIPT, {\n            'script': script,\n            'args': ['div']\n          }).\n          andReturnSuccess([\n              WebElement.buildId('one'),\n              WebElement.buildId('two')\n          ]).\n          end();\n\n      var driver = executor.createDriver();\n      return driver.findElements(By.js(script, 'div'))\n          then(function(elements) {\n            return promise.all(elements.map(function(e) {\n              assert.ok(e instanceof WebElement);\n              return e.getId();\n            }));\n          }).\n          then((actual) => assert.deepEqual(['one', 'two'], actual));\n    });\n  });\n\n  describe('sendKeys', function() {\n    it('convertsVarArgsIntoStrings_simpleArgs', function() {\n      let executor = new FakeExecutor().\n          expect(CName.SEND_KEYS_TO_ELEMENT,\n                 {'id': WebElement.buildId('one'),\n                  'value':'12abc3'.split('')}).\n              andReturnSuccess().\n          end();\n\n      var driver = executor.createDriver();\n      var element = new WebElement(driver, 'one');\n      element.sendKeys(1, 2, 'abc', 3);\n      return waitForIdle();\n    });\n\n    it('convertsVarArgsIntoStrings_promisedArgs', function() {\n      let executor = new FakeExecutor().\n          expect(CName.FIND_ELEMENT,\n                 {'using':'css selector', 'value':'*[id=\"foo\"]'}).\n              andReturnSuccess(WebElement.buildId('one')).\n          expect(CName.SEND_KEYS_TO_ELEMENT,\n                 {'id':WebElement.buildId('one'),\n                  'value':'abc123def'.split('')}).\n              andReturnSuccess().\n          end();\n\n      var driver = executor.createDriver();\n      var element = driver.findElement(By.id('foo'));\n      return element.sendKeys(\n          Promise.resolve('abc'),\n          123,\n          Promise.resolve('def'));\n    });\n\n    it('sendKeysWithAFileDetector', function() {\n      let executor = new FakeExecutor().\n          expect(CName.FIND_ELEMENT,\n                 {'using':'css selector', 'value':'*[id=\"foo\"]'}).\n              andReturnSuccess(WebElement.buildId('one')).\n          expect(CName.SEND_KEYS_TO_ELEMENT,\n                 {'id': WebElement.buildId('one'),\n                  'value':'modified/path'.split('')}).\n              andReturnSuccess().\n          end();\n\n      let driver = executor.createDriver();\n      let handleFile = function(d, path) {\n        assert.strictEqual(driver, d);\n        assert.equal(path, 'original/path');\n        return Promise.resolve('modified/path');\n      };\n      driver.setFileDetector({handleFile});\n\n      return driver.findElement(By.id('foo')).sendKeys('original/', 'path');\n    });\n  });\n\n  describe(\"switchTo()\", function() {\n    describe(\"window\", function() {\n      it('should return a resolved promise when the window is found', function() {\n        let executor = new FakeExecutor().\n            expect(CName.SWITCH_TO_WINDOW).\n                withParameters({\n                  'name': 'foo',\n                  'handle': 'foo'\n                }).\n                andReturnSuccess().\n            end();\n\n        executor.createDriver().switchTo().window('foo');\n        return waitForIdle();\n      });\n\n      it('should propagate exceptions', function() {\n        let e = new error.NoSuchWindowError('window not found');\n        let executor = new FakeExecutor().\n            expect(CName.SWITCH_TO_WINDOW).\n                withParameters({\n                  'name': 'foo',\n                  'handle': 'foo'\n                }).\n                andReturnError(e).\n            end();\n\n        return executor.createDriver()\n            .switchTo().window('foo')\n            .then(assert.fail, v => assert.strictEqual(v, e));\n      });\n    });\n  });\n\n  describe('elementEquality', function() {\n    it('isReflexive', function() {\n      var a = new WebElement(new FakeExecutor().createDriver(), 'foo');\n      return WebElement.equals(a, a).then(assert.ok);\n    });\n\n    it('failsIfAnInputElementCouldNotBeFound', function() {\n      let id = Promise.reject(new StubError);\n\n      var driver = new FakeExecutor().createDriver();\n      var a = new WebElement(driver, 'foo');\n      var b = new WebElementPromise(driver, id);\n\n      return WebElement.equals(a, b).then(fail, assertIsStubError);\n    });\n  });\n\n  describe('waiting', function() {\n    describe('supports custom wait functions', function() {\n      it('waitSucceeds', function() {\n        let executor = new FakeExecutor().\n            expect(CName.FIND_ELEMENTS,\n                   {using: 'css selector', value: '*[id=\"foo\"]'}).\n                andReturnSuccess([]).\n                times(2).\n            expect(CName.FIND_ELEMENTS,\n                   {using: 'css selector', value: '*[id=\"foo\"]'}).\n                andReturnSuccess([WebElement.buildId('bar')]).\n            end();\n\n        var driver = executor.createDriver();\n        driver.wait(function() {\n          return driver.findElements(By.id('foo')).then(els => els.length > 0);\n        }, 200);\n        return waitForIdle();\n      });\n\n      it('waitTimesout_timeoutCaught', function() {\n        let executor = new FakeExecutor().\n            expect(CName.FIND_ELEMENTS,\n                   {using: 'css selector', value: '*[id=\"foo\"]'}).\n                andReturnSuccess([]).\n                anyTimes().\n            end();\n\n        var driver = executor.createDriver();\n        return driver.wait(function() {\n          return driver.findElements(By.id('foo')).then(els => els.length > 0);\n        }, 25).then(fail, function(e) {\n          assert.equal('Wait timed out after ',\n              e.message.substring(0, 'Wait timed out after '.length));\n        });\n      });\n\n      enablePromiseManager(() => {\n        it('waitTimesout_timeoutNotCaught', function() {\n          let executor = new FakeExecutor().\n              expect(CName.FIND_ELEMENTS,\n                     {using: 'css selector', value: '*[id=\"foo\"]'}).\n                  andReturnSuccess([]).\n                  anyTimes().\n              end();\n\n          var driver = executor.createDriver();\n          driver.wait(function() {\n            return driver.findElements(By.id('foo')).then(els => els.length > 0);\n          }, 25);\n          return waitForAbort().then(function(e) {\n            assert.equal('Wait timed out after ',\n                e.message.substring(0, 'Wait timed out after '.length));\n          });\n        });\n      });\n    });\n\n    describe('supports condition objects', function() {\n      it('wait succeeds', function() {\n        let executor = new FakeExecutor()\n            .expect(CName.FIND_ELEMENTS,\n                    {using: 'css selector', value: '*[id=\"foo\"]'})\n                .andReturnSuccess([])\n                .times(2)\n            .expect(CName.FIND_ELEMENTS,\n                    {using: 'css selector', value: '*[id=\"foo\"]'})\n                .andReturnSuccess([WebElement.buildId('bar')])\n            .end();\n\n        let driver = executor.createDriver();\n        return driver.wait(until.elementLocated(By.id('foo')), 200);\n      });\n\n      it('wait times out', function() {\n        let executor = new FakeExecutor()\n            .expect(CName.FIND_ELEMENTS,\n                    {using: 'css selector', value: '*[id=\"foo\"]'})\n            .andReturnSuccess([])\n            .anyTimes()\n            .end();\n\n        let driver = executor.createDriver();\n        return driver.wait(until.elementLocated(By.id('foo')), 5)\n            .then(fail, err => assert.ok(err instanceof error.TimeoutError));\n      });\n    });\n\n    describe('supports promise objects', function() {\n      it('wait succeeds', function() {\n        let promise = new Promise(resolve => {\n          setTimeout(() => resolve(1), 10);\n        });\n\n        let driver = new FakeExecutor().createDriver();\n        return driver.wait(promise, 200).then(v => assert.equal(v, 1));\n      });\n\n      it('wait times out', function() {\n        let promise = new Promise(resolve => {/* never resolves */});\n\n        let driver = new FakeExecutor().createDriver();\n        return driver.wait(promise, 5)\n            .then(fail, err => assert.ok(err instanceof error.TimeoutError));\n      });\n\n      it('wait fails if promise is rejected', function() {\n        let err = Error('boom');\n        let driver = new FakeExecutor().createDriver();\n        return driver.wait(Promise.reject(err), 5)\n            .then(fail, e => assert.strictEqual(e, err));\n      });\n    });\n\n    it('fails if not supported condition type provided', function() {\n      let driver = new FakeExecutor().createDriver();\n      assert.throws(() => driver.wait({}, 5), TypeError);\n    });\n  });\n\n  describe('alert handling', function() {\n    it('alertResolvesWhenPromisedTextResolves', function() {\n      let driver = new FakeExecutor().createDriver();\n      let deferredText = defer();\n\n      let alert = new AlertPromise(driver, deferredText.promise);\n\n      deferredText.resolve(new Alert(driver, 'foo'));\n      return alert.getText().then(text => assert.equal(text, 'foo'));\n    });\n\n    it('cannotSwitchToAlertThatIsNotPresent', function() {\n      let e = new error.NoSuchAlertError;\n      let executor = new FakeExecutor()\n          .expect(CName.GET_ALERT_TEXT)\n          .andReturnError(e)\n          .end();\n\n      return executor.createDriver()\n          .switchTo().alert()\n          .then(assert.fail, v => assert.strictEqual(v, e));\n    });\n\n    enablePromiseManager(() => {\n      it('alertsBelongToSameFlowAsParentDriver', function() {\n        let executor = new FakeExecutor()\n            .expect(CName.GET_ALERT_TEXT).andReturnSuccess('hello')\n            .end();\n\n        var driver = executor.createDriver();\n        var otherFlow = new promise.ControlFlow();\n        otherFlow.execute(function() {\n          driver.switchTo().alert().then(function() {\n            assert.strictEqual(\n                driver.controlFlow(), promise.controlFlow(),\n                'Alert should belong to the same flow as its parent driver');\n          });\n        });\n\n        assert.notEqual(otherFlow, driver.controlFlow);\n        return Promise.all([\n          waitForIdle(otherFlow),\n          waitForIdle(driver.controlFlow())\n        ]);\n      });\n    });\n\n    it('commandsFailIfAlertNotPresent', function() {\n      let e = new error.NoSuchAlertError;\n      let executor = new FakeExecutor()\n          .expect(CName.GET_ALERT_TEXT)\n          .andReturnError(e)\n          .end();\n\n      var driver = executor.createDriver();\n      var alert = driver.switchTo().alert();\n\n      var expectError = (v) => assert.strictEqual(v, e);\n\n      return alert.getText()\n          .then(fail, expectedError)\n          .then(() => alert.accept())\n          .then(fail, expectedError)\n          .then(() => alert.dismiss())\n          .then(fail, expectError)\n          .then(() => alert.sendKeys('hi'))\n          .then(fail, expectError);\n    });\n  });\n\n  enablePromiseManager(() => {\n    it('testWebElementsBelongToSameFlowAsParentDriver', function() {\n      let executor = new FakeExecutor()\n          .expect(CName.FIND_ELEMENT,\n                  {using: 'css selector', value: '*[id=\"foo\"]'})\n          .andReturnSuccess(WebElement.buildId('abc123'))\n          .end();\n\n      var driver = executor.createDriver();\n      var otherFlow = new promise.ControlFlow();\n      otherFlow.execute(function() {\n        driver.findElement({id: 'foo'}).then(function() {\n          assert.equal(driver.controlFlow(), promise.controlFlow());\n        });\n      });\n\n      assert.notEqual(otherFlow, driver.controlFlow);\n      return Promise.all([\n        waitForIdle(otherFlow),\n        waitForIdle(driver.controlFlow())\n      ]);\n    });\n  });\n\n  it('testFetchingLogs', function() {\n    let executor = new FakeExecutor().\n        expect(CName.GET_LOG, {'type': 'browser'}).\n        andReturnSuccess([\n            {'level': 'INFO', 'message': 'hello', 'timestamp': 1234},\n            {'level': 'DEBUG', 'message': 'abc123', 'timestamp': 5678}\n        ]).\n        end();\n\n    var driver = executor.createDriver();\n    return driver.manage().logs().get('browser').then(function(entries) {\n      assert.equal(2, entries.length);\n\n      assert.ok(entries[0] instanceof logging.Entry);\n      assert.equal(logging.Level.INFO.value, entries[0].level.value);\n      assert.equal('hello', entries[0].message);\n      assert.equal(1234, entries[0].timestamp);\n\n      assert.ok(entries[1] instanceof logging.Entry);\n      assert.equal(logging.Level.DEBUG.value, entries[1].level.value);\n      assert.equal('abc123', entries[1].message);\n      assert.equal(5678, entries[1].timestamp);\n    });\n  });\n\n  it('testCommandsFailIfInitialSessionCreationFailed', function() {\n    var session = Promise.reject(new StubError);\n\n    var driver = new FakeExecutor().createDriver(session);\n    var navigateResult = driver.get('some-url').then(fail, assertIsStubError);\n    var quitResult = driver.quit().then(fail, assertIsStubError);\n\n    return waitForIdle().then(function() {\n      return promise.all(navigateResult, quitResult);\n    });\n  });\n\n  it('testWebElementCommandsFailIfInitialDriverCreationFailed', function() {\n    var session = Promise.reject(new StubError);\n    var driver = new FakeExecutor().createDriver(session);\n    return driver.findElement(By.id('foo')).click().\n        then(fail, assertIsStubError);\n  });\n\n  it('testWebElementCommansFailIfElementCouldNotBeFound', function() {\n    let e = new error.NoSuchElementError('Unable to find element');\n    let executor = new FakeExecutor().\n        expect(CName.FIND_ELEMENT,\n               {using: 'css selector', value: '*[id=\"foo\"]'}).\n            andReturnError(e).\n        end();\n\n    var driver = executor.createDriver();\n    return driver.findElement(By.id('foo')).click()\n        .then(fail, v => assert.strictEqual(v, e));\n  });\n\n  it('testCannotFindChildElementsIfParentCouldNotBeFound', function() {\n    let e = new error.NoSuchElementError('Unable to find element');\n    let executor = new FakeExecutor().\n        expect(CName.FIND_ELEMENT,\n               {using: 'css selector', value: '*[id=\"foo\"]'}).\n        andReturnError(e).\n        end();\n\n    var driver = executor.createDriver();\n    return driver.findElement(By.id('foo'))\n        .findElement(By.id('bar'))\n        .findElement(By.id('baz'))\n        .then(fail, v => assert.strictEqual(v, e));\n  });\n\n  describe('actions()', function() {\n    it('failsIfInitialDriverCreationFailed', function() {\n      let session = Promise.reject(new StubError('no session for you'));\n      let driver = new FakeExecutor().createDriver(session);\n      driver.getSession().catch(function() {});\n      return driver.\n          actions().\n          mouseDown().\n          mouseUp().\n          perform().\n          catch(assertIsStubError);\n    });\n\n    describe('mouseMove', function() {\n      it('noElement', function() {\n        let executor = new FakeExecutor()\n            .expect(CName.MOVE_TO, {'xoffset': 0, 'yoffset': 125})\n            .andReturnSuccess()\n            .end();\n\n        return executor.createDriver().\n            actions().\n            mouseMove({x: 0, y: 125}).\n            perform();\n      });\n\n      it('element', function() {\n        let executor = new FakeExecutor()\n            .expect(CName.FIND_ELEMENT,\n                    {using: 'css selector', value: '*[id=\"foo\"]'})\n                .andReturnSuccess(WebElement.buildId('abc123'))\n            .expect(CName.MOVE_TO,\n                    {'element': 'abc123', 'xoffset': 0, 'yoffset': 125})\n                .andReturnSuccess()\n            .end();\n\n        var driver = executor.createDriver();\n        var element = driver.findElement(By.id('foo'));\n        return driver.actions()\n            .mouseMove(element, {x: 0, y: 125})\n            .perform();\n      });\n    });\n\n    it('supportsMouseDown', function() {\n      let executor = new FakeExecutor()\n          .expect(CName.MOUSE_DOWN, {'button': Button.LEFT})\n              .andReturnSuccess()\n          .end();\n\n      return executor.createDriver().\n          actions().\n          mouseDown().\n          perform();\n    });\n\n    it('testActionSequence', function() {\n      let executor = new FakeExecutor()\n          .expect(CName.FIND_ELEMENT,\n                  {using: 'css selector', value: '*[id=\"a\"]'})\n              .andReturnSuccess(WebElement.buildId('id1'))\n          .expect(CName.FIND_ELEMENT,\n                  {using: 'css selector', value: '*[id=\"b\"]'})\n              .andReturnSuccess(WebElement.buildId('id2'))\n          .expect(CName.SEND_KEYS_TO_ACTIVE_ELEMENT,\n              {'value': [Key.SHIFT]})\n              .andReturnSuccess()\n          .expect(CName.MOVE_TO, {'element': 'id1'})\n              .andReturnSuccess()\n          .expect(CName.CLICK, {'button': Button.LEFT})\n              .andReturnSuccess()\n          .expect(CName.MOVE_TO, {'element': 'id2'})\n              .andReturnSuccess()\n          .expect(CName.CLICK, {'button': Button.LEFT})\n              .andReturnSuccess()\n          .end();\n\n      var driver = executor.createDriver();\n      var element1 = driver.findElement(By.id('a'));\n      var element2 = driver.findElement(By.id('b'));\n\n      return driver.actions()\n          .keyDown(Key.SHIFT)\n          .click(element1)\n          .click(element2)\n          .perform();\n    });\n  });\n\n  describe('touchActions()', function() {\n    it('failsIfInitialDriverCreationFailed', function() {\n      let session = Promise.reject(new StubError);\n      let driver = new FakeExecutor().createDriver(session);\n      driver.getSession().catch(function() {});\n      return driver.\n          touchActions().\n          scroll({x: 3, y: 4}).\n          perform().\n          catch(assertIsStubError);\n    });\n\n    it('testTouchActionSequence', function() {\n      let executor = new FakeExecutor()\n          .expect(CName.TOUCH_DOWN, {x: 1, y: 2}).andReturnSuccess()\n          .expect(CName.TOUCH_MOVE, {x: 3, y: 4}).andReturnSuccess()\n          .expect(CName.TOUCH_UP, {x: 5, y: 6}).andReturnSuccess()\n          .end();\n\n      var driver = executor.createDriver();\n      return driver.touchActions()\n          .tapAndHold({x: 1, y: 2})\n          .move({x: 3, y: 4})\n          .release({x: 5, y: 6})\n          .perform();\n    });\n  });\n\n  describe('manage()', function() {\n    describe('setTimeouts()', function() {\n      describe('throws if no timeouts are specified', function() {\n        let driver;\n        before(() => driver = new FakeExecutor().createDriver());\n\n        it('; no arguments', function() {\n          assert.throws(() => driver.manage().setTimeouts(), TypeError);\n        });\n\n        it('; ignores unrecognized timeout keys', function() {\n          assert.throws(\n              () => driver.manage().setTimeouts({foo: 123}), TypeError);\n        });\n\n        it('; ignores positional arguments', function() {\n          assert.throws(\n              () => driver.manage().setTimeouts(1234, 56), TypeError);\n        });\n      });\n\n      describe('throws timeout is not a number, null, or undefined', () => {\n        let driver;\n        before(() => driver = new FakeExecutor().createDriver());\n\n        function checkError(e) {\n          return e instanceof TypeError\n              && /expected \"(script|pageLoad|implicit)\" to be a number/.test(\n                  e.message);\n        }\n\n        it('script', function() {\n          assert.throws(\n              () => driver.manage().setTimeouts({script: 'abc'}),\n              checkError);\n        });\n\n        it('pageLoad', function() {\n          assert.throws(\n              () => driver.manage().setTimeouts({pageLoad: 'abc'}),\n              checkError);\n        });\n\n        it('implicit', function() {\n          assert.throws(\n              () => driver.manage().setTimeouts({implicit: 'abc'}),\n              checkError);\n        });\n      });\n\n      it('can set multiple timeouts', function() {\n        let executor = new FakeExecutor()\n            .expect(CName.SET_TIMEOUT, {script:1, pageLoad: 2, implicit: 3})\n            .andReturnSuccess()\n            .end();\n        let driver = executor.createDriver();\n        return driver.manage()\n            .setTimeouts({script: 1, pageLoad: 2, implicit: 3});\n      });\n\n      it('falls back to legacy wire format if W3C version fails', () => {\n        let executor = new FakeExecutor()\n            .expect(CName.SET_TIMEOUT, {implicit: 3})\n            .andReturnError(Error('oops'))\n            .expect(CName.SET_TIMEOUT, {type: 'implicit', ms: 3})\n            .andReturnSuccess()\n            .end();\n        let driver = executor.createDriver();\n        return driver.manage().setTimeouts({implicit: 3});\n      });\n\n      describe('deprecated API calls setTimeouts()', function() {\n        it('implicitlyWait()', function() {\n          let executor = new FakeExecutor()\n              .expect(CName.SET_TIMEOUT, {implicit: 3})\n              .andReturnSuccess()\n              .end();\n          let driver = executor.createDriver();\n          return driver.manage().timeouts().implicitlyWait(3);\n        });\n\n        it('setScriptTimeout()', function() {\n          let executor = new FakeExecutor()\n              .expect(CName.SET_TIMEOUT, {script: 3})\n              .andReturnSuccess()\n              .end();\n          let driver = executor.createDriver();\n          return driver.manage().timeouts().setScriptTimeout(3);\n        });\n\n        it('pageLoadTimeout()', function() {\n          let executor = new FakeExecutor()\n              .expect(CName.SET_TIMEOUT, {pageLoad: 3})\n              .andReturnSuccess()\n              .end();\n          let driver = executor.createDriver();\n          return driver.manage().timeouts().pageLoadTimeout(3);\n        });\n      });\n    });\n  });\n\n  describe('generator support', function() {\n    var driver;\n\n    beforeEach(function() {\n      driver = new WebDriver(\n          new Session('test-session', {}),\n          new ExplodingExecutor());\n    });\n\n    it('canUseGeneratorsWithWebDriverCall', function() {\n      return driver.call(function* () {\n        var x = yield Promise.resolve(1);\n        var y = yield Promise.resolve(2);\n        return x + y;\n      }).then(function(value) {\n        assert.deepEqual(3, value);\n      });\n    });\n\n    it('canDefineScopeOnGeneratorCall', function() {\n      return driver.call(function* () {\n        var x = yield Promise.resolve(1);\n        return this.name + x;\n      }, {name: 'Bob'}).then(function(value) {\n        assert.deepEqual('Bob1', value);\n      });\n    });\n\n    it('canSpecifyArgsOnGeneratorCall', function() {\n      return driver.call(function* (a, b) {\n        var x = yield Promise.resolve(1);\n        var y = yield Promise.resolve(2);\n        return [x + y, a, b];\n      }, null, 'abc', 123).then(function(value) {\n        assert.deepEqual([3, 'abc', 123], value);\n      });\n    });\n\n    it('canUseGeneratorWithWebDriverWait', function() {\n      var values = [];\n      return driver.wait(function* () {\n        yield values.push(1);\n        values.push(yield promise.delayed(10).then(function() {\n          return 2;\n        }));\n        yield values.push(3);\n        return values.length === 6;\n      }, 250).then(function() {\n        assert.deepEqual([1, 2, 3, 1, 2, 3], values);\n      });\n    });\n\n    /**\n     * @constructor\n     * @implements {CommandExecutor}\n     */\n    function ExplodingExecutor() {}\n\n\n    /** @override */\n    ExplodingExecutor.prototype.execute = function(command, cb) {\n      cb(Error('Unsupported operation'));\n    };\n  });\n\n  describe('wire format', function() {\n    const FAKE_DRIVER = new FakeExecutor().createDriver();\n\n    describe('can serialize', function() {\n      function runSerializeTest(input, want) {\n        let executor = new FakeExecutor().\n            expect(CName.NEW_SESSION).\n            withParameters({'desiredCapabilities': want}).\n            andReturnSuccess({'browserName': 'firefox'}).\n            end();\n        return WebDriver.createSession(executor, input)\n            .getSession();\n      }\n\n      it('function as a string', function() {\n        function foo() { return 'foo'; }\n        return runSerializeTest(foo, '' + foo);\n      });\n\n      it('object with toJSON()', function() {\n        return runSerializeTest(\n            new Date(605728511546),\n            '1989-03-12T17:55:11.546Z');\n      });\n\n      it('Session', function() {\n        return runSerializeTest(new Session('foo', {}), 'foo');\n      });\n\n      it('Capabilities', function() {\n        var prefs = new logging.Preferences();\n        prefs.setLevel(logging.Type.BROWSER, logging.Level.DEBUG);\n\n        var caps = Capabilities.chrome();\n        caps.setLoggingPrefs(prefs);\n\n        return runSerializeTest(\n            caps,\n            {\n              'browserName': 'chrome',\n              'loggingPrefs': {'browser': 'DEBUG'}\n            });\n      });\n\n      it('WebElement', function() {\n        return runSerializeTest(\n            new WebElement(FAKE_DRIVER, 'fefifofum'),\n            WebElement.buildId('fefifofum'));\n      });\n\n      it('WebElementPromise', function() {\n        return runSerializeTest(\n            new WebElementPromise(\n                FAKE_DRIVER,\n                Promise.resolve(new WebElement(FAKE_DRIVER, 'fefifofum'))),\n            WebElement.buildId('fefifofum'));\n      });\n\n      describe('an array', function() {\n        it('with Serializable', function() {\n          return runSerializeTest([new Session('foo', {})], ['foo']);\n        });\n\n        it('with WebElement', function() {\n          return runSerializeTest(\n              [new WebElement(FAKE_DRIVER, 'fefifofum')],\n              [WebElement.buildId('fefifofum')]);\n        });\n\n        it('with WebElementPromise', function() {\n          return runSerializeTest(\n              [new WebElementPromise(\n                  FAKE_DRIVER,\n                  Promise.resolve(new WebElement(FAKE_DRIVER, 'fefifofum')))],\n              [WebElement.buildId('fefifofum')]);\n        });\n\n        it('complex array', function() {\n          var expected = [\n            'abc', 123, true, WebElement.buildId('fefifofum'),\n            [123, {'foo': 'bar'}]\n          ];\n\n          var element = new WebElement(FAKE_DRIVER, 'fefifofum');\n          var input = ['abc', 123, true, element, [123, {'foo': 'bar'}]];\n          return runSerializeTest(input, expected);\n        });\n\n        it('nested promises', function() {\n          return runSerializeTest(\n              ['abc', Promise.resolve([123, Promise.resolve(true)])],\n              ['abc', [123, true]]);\n        });\n      });\n\n      describe('an object', function() {\n        it('literal', function() {\n          var expected = {sessionId: 'foo'};\n          return runSerializeTest({sessionId: 'foo'}, expected);\n        });\n\n        it('with sub-objects', function() {\n          var expected = {sessionId: {value: 'foo'}};\n          return runSerializeTest(\n              {sessionId: {value: 'foo'}}, expected);\n        });\n\n        it('with values that have toJSON', function() {\n          return runSerializeTest(\n              {a: {b: new Date(605728511546)}},\n              {a: {b: '1989-03-12T17:55:11.546Z'}});\n        });\n\n        it('with a Session', function() {\n          return runSerializeTest(\n              {a: new Session('foo', {})},\n              {a: 'foo'});\n        });\n\n        it('nested', function() {\n          var elementJson = WebElement.buildId('fefifofum');\n          var expected = {\n            'script': 'return 1',\n            'args': ['abc', 123, true, elementJson, [123, {'foo': 'bar'}]],\n            'sessionId': 'foo'\n          };\n\n          var element = new WebElement(FAKE_DRIVER, 'fefifofum');\n          var parameters = {\n            'script': 'return 1',\n            'args':['abc', 123, true, element, [123, {'foo': 'bar'}]],\n            'sessionId': new Session('foo', {})\n          };\n\n          return runSerializeTest(parameters, expected);\n        });\n      });\n    });\n\n    describe('can deserialize', function() {\n      function runDeserializeTest(original, want) {\n        let executor = new FakeExecutor()\n            .expect(CName.GET_CURRENT_URL)\n            .andReturnSuccess(original)\n            .end();\n        let driver = executor.createDriver();\n        return driver.getCurrentUrl().then(function(got) {\n          assert.deepEqual(got, want);\n        });\n      }\n\n      it('primitives', function() {\n        return Promise.all([\n            runDeserializeTest(1, 1),\n            runDeserializeTest('', ''),\n            runDeserializeTest(true, true),\n            runDeserializeTest(undefined, undefined),\n            runDeserializeTest(null, null)\n        ]);\n      });\n\n      it('simple object', function() {\n        return runDeserializeTest(\n            {sessionId: 'foo'},\n            {sessionId: 'foo'});\n      });\n\n      it('nested object', function() {\n        return runDeserializeTest(\n            {'foo': {'bar': 123}},\n            {'foo': {'bar': 123}});\n      });\n\n      it('array', function() {\n        return runDeserializeTest(\n            [{'foo': {'bar': 123}}],\n            [{'foo': {'bar': 123}}]);\n      });\n\n      it('passes through function properties', function() {\n        function bar() {}\n        return runDeserializeTest(\n            [{foo: {'bar': 123}, func: bar}],\n            [{foo: {'bar': 123}, func: bar}]);\n      });\n    });\n  });\n});\n"]}