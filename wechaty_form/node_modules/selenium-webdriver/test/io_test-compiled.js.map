{"version":3,"sources":["io_test.js"],"names":[],"mappings":"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","file":"io_test-compiled.js","sourcesContent":["// Licensed to the Software Freedom Conservancy (SFC) under one\n// or more contributor license agreements.  See the NOTICE file\n// distributed with this work for additional information\n// regarding copyright ownership.  The SFC licenses this file\n// to you under the Apache License, Version 2.0 (the\n// \"License\"); you may not use this file except in compliance\n// with the License.  You may obtain a copy of the License at\n//\n//   http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing,\n// software distributed under the License is distributed on an\n// \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n// KIND, either express or implied.  See the License for the\n// specific language governing permissions and limitations\n// under the License.\n\n'use strict';\n\nvar assert = require('assert'),\n    fs = require('fs'),\n    path = require('path'),\n    tmp = require('tmp');\n\nvar io = require('../io');\n\n\ndescribe('io', function() {\n  describe('copy', function() {\n    var tmpDir;\n\n    before(function() {\n      return io.tmpDir().then(function(d) {\n        tmpDir = d;\n\n        fs.writeFileSync(path.join(d, 'foo'), 'Hello, world');\n      });\n    });\n\n    it('can copy one file to another', function() {\n      return io.tmpFile().then(function(f) {\n        return io.copy(path.join(tmpDir, 'foo'), f).then(function(p) {\n          assert.equal(p, f);\n          assert.equal('Hello, world', fs.readFileSync(p));\n        });\n      });\n    });\n\n    it('can copy symlink to destination', function() {\n      if (process.platform === 'win32') {\n        return;  // No symlinks on windows.\n      }\n      fs.symlinkSync(\n          path.join(tmpDir, 'foo'),\n          path.join(tmpDir, 'symlinked-foo'));\n      return io.tmpFile().then(function(f) {\n        return io.copy(path.join(tmpDir, 'symlinked-foo'), f).then(function(p) {\n          assert.equal(p, f);\n          assert.equal('Hello, world', fs.readFileSync(p));\n        });\n      });\n    });\n\n    it('fails if given a directory as a source', function() {\n      return io.tmpFile().then(function(f) {\n        return io.copy(tmpDir, f);\n      }).then(function() {\n        throw Error('Should have failed with a type error');\n      }, function() {\n        // Do nothing; expected.\n      });\n    });\n  });\n\n  describe('copyDir', function() {\n    it('copies recursively', function() {\n      return io.tmpDir().then(function(dir) {\n        fs.writeFileSync(path.join(dir, 'file1'), 'hello');\n        fs.mkdirSync(path.join(dir, 'sub'));\n        fs.mkdirSync(path.join(dir, 'sub/folder'));\n        fs.writeFileSync(path.join(dir, 'sub/folder/file2'), 'goodbye');\n\n        return io.tmpDir().then(function(dst) {\n          return io.copyDir(dir, dst).then(function(ret) {\n            assert.equal(dst, ret);\n\n            assert.equal('hello',\n              fs.readFileSync(path.join(dst, 'file1')));\n            assert.equal('goodbye',\n              fs.readFileSync(path.join(dst, 'sub/folder/file2')));\n          });\n        });\n      });\n    });\n\n    it('creates destination dir if necessary', function() {\n      return io.tmpDir().then(function(srcDir) {\n        fs.writeFileSync(path.join(srcDir, 'foo'), 'hi');\n        return io.tmpDir().then(function(dstDir) {\n          return io.copyDir(srcDir, path.join(dstDir, 'sub'));\n        });\n      }).then(function(p) {\n        assert.equal('sub', path.basename(p));\n        assert.equal('hi', fs.readFileSync(path.join(p, 'foo')));\n      });\n    });\n\n    it('supports regex exclusion filter', function() {\n      return io.tmpDir().then(function(src) {\n        fs.writeFileSync(path.join(src, 'foo'), 'a');\n        fs.writeFileSync(path.join(src, 'bar'), 'b');\n        fs.writeFileSync(path.join(src, 'baz'), 'c');\n        fs.mkdirSync(path.join(src, 'sub'));\n        fs.writeFileSync(path.join(src, 'sub/quux'), 'd');\n        fs.writeFileSync(path.join(src, 'sub/quot'), 'e');\n\n        return io.tmpDir().then(function(dst) {\n          return io.copyDir(src, dst, /(bar|quux)/);\n        });\n      }).then(function(dir) {\n        assert.equal('a', fs.readFileSync(path.join(dir, 'foo')));\n        assert.equal('c', fs.readFileSync(path.join(dir, 'baz')));\n        assert.equal('e', fs.readFileSync(path.join(dir, 'sub/quot')));\n\n        assert.ok(!fs.existsSync(path.join(dir, 'bar')));\n        assert.ok(!fs.existsSync(path.join(dir, 'sub/quux')));\n      });\n    });\n\n    it('supports exclusion filter function', function() {\n      return io.tmpDir().then(function(src) {\n        fs.writeFileSync(path.join(src, 'foo'), 'a');\n        fs.writeFileSync(path.join(src, 'bar'), 'b');\n        fs.writeFileSync(path.join(src, 'baz'), 'c');\n        fs.mkdirSync(path.join(src, 'sub'));\n        fs.writeFileSync(path.join(src, 'sub/quux'), 'd');\n        fs.writeFileSync(path.join(src, 'sub/quot'), 'e');\n\n        return io.tmpDir().then(function(dst) {\n          return io.copyDir(src, dst, function(f) {\n            return f !== path.join(src, 'foo')\n                && f !== path.join(src, 'sub/quot');\n          });\n        });\n      }).then(function(dir) {\n        assert.equal('b', fs.readFileSync(path.join(dir, 'bar')));\n        assert.equal('c', fs.readFileSync(path.join(dir, 'baz')));\n        assert.equal('d', fs.readFileSync(path.join(dir, 'sub/quux')));\n\n        assert.ok(!fs.existsSync(path.join(dir, 'foo')));\n        assert.ok(!fs.existsSync(path.join(dir, 'sub/quot')));\n      });\n    });\n  });\n\n  describe('exists', function() {\n    var dir;\n\n    before(function() {\n      return io.tmpDir().then(function(d) {\n        dir = d;\n      });\n    });\n\n    it('returns a rejected promise if input value is invalid', function() {\n      return io.exists(undefined).then(\n          () => assert.fail('should have failed'),\n          e => assert.ok(e instanceof TypeError));\n    });\n\n    it('works for directories', function() {\n      return io.exists(dir).then(assert.ok);\n    });\n\n    it('works for files', function() {\n      var file = path.join(dir, 'foo');\n      fs.writeFileSync(file, '');\n      return io.exists(file).then(assert.ok);\n    });\n\n    it('does not return a rejected promise if file does not exist', function() {\n      return io.exists(path.join(dir, 'not-there')).then(function(exists) {\n        assert.ok(!exists);\n      });\n    });\n  });\n\n  describe('unlink', function() {\n    var dir;\n\n    before(function() {\n      return io.tmpDir().then(function(d) {\n        dir = d;\n      });\n    });\n\n    it('silently succeeds if the path does not exist', function() {\n      return io.unlink(path.join(dir, 'not-there'));\n    });\n\n    it('deletes files', function() {\n      var file = path.join(dir, 'foo');\n      fs.writeFileSync(file, '');\n      return io.exists(file).then(assert.ok).then(function() {\n        return io.unlink(file);\n      }).then(function() {\n        return io.exists(file);\n      }).then(function(exists) {\n        return assert.ok(!exists);\n      });\n    });\n  });\n\n  describe('rmDir', function() {\n    it('succeeds if the designated directory does not exist', function() {\n      return io.tmpDir().then(function(d) {\n        return io.rmDir(path.join(d, 'i/do/not/exist'));\n      });\n    });\n\n    it('deletes recursively', function() {\n      return io.tmpDir().then(function(dir) {\n        fs.writeFileSync(path.join(dir, 'file1'), 'hello');\n        fs.mkdirSync(path.join(dir, 'sub'));\n        fs.mkdirSync(path.join(dir, 'sub/folder'));\n        fs.writeFileSync(path.join(dir, 'sub/folder/file2'), 'goodbye');\n\n        return io.rmDir(dir).then(function() {\n          assert.ok(!fs.existsSync(dir));\n          assert.ok(!fs.existsSync(path.join(dir, 'sub/folder/file2')));\n        });\n      });\n    });\n  });\n\n  describe('findInPath', function() {\n    const savedPathEnv = process.env['PATH'];\n    afterEach(() => process.env['PATH'] = savedPathEnv);\n\n    const cwd = process.cwd;\n    afterEach(() => process.cwd = cwd);\n\n    let dirs;\n    beforeEach(() => {\n      return Promise.all([io.tmpDir(), io.tmpDir(), io.tmpDir()]).then(arr => {\n        dirs = arr;\n        process.env['PATH'] = arr.join(path.delimiter);\n      });\n    });\n\n    it('returns null if file cannot be found', () => {\n      assert.strictEqual(io.findInPath('foo.txt'), null);\n    });\n\n    it('can find file on path', () => {\n      let filePath = path.join(dirs[1], 'foo.txt');\n      fs.writeFileSync(filePath, 'hi');\n\n      assert.strictEqual(io.findInPath('foo.txt'), filePath);\n    });\n\n    it('returns null if file is in a subdir of a directory on the path', () => {\n      let subDir = path.join(dirs[2], 'sub');\n      fs.mkdirSync(subDir);\n\n      let filePath = path.join(subDir, 'foo.txt');\n      fs.writeFileSync(filePath, 'hi');\n\n      assert.strictEqual(io.findInPath('foo.txt'), null);\n    });\n\n    it('does not match on directories', () => {\n      fs.mkdirSync(path.join(dirs[2], 'sub'));\n      assert.strictEqual(io.findInPath('sub'), null);\n    });\n\n    it('will look in cwd first if requested', () => {\n      return io.tmpDir().then(fakeCwd => {\n        process.cwd = () => fakeCwd;\n\n        let theFile = path.join(fakeCwd, 'foo.txt');\n\n        fs.writeFileSync(path.join(dirs[1], 'foo.txt'), 'hi');\n        fs.writeFileSync(theFile, 'bye');\n\n        assert.strictEqual(io.findInPath('foo.txt', true), theFile);\n      });\n    });\n  });\n\n  describe('read', function() {\n    var tmpDir;\n\n    before(function() {\n      return io.tmpDir().then(function(d) {\n        tmpDir = d;\n\n        fs.writeFileSync(path.join(d, 'foo'), 'Hello, world');\n      });\n    });\n\n    it('can read a file', function() {\n      return io.read(path.join(tmpDir, 'foo')).then(buff => {\n        assert.ok(buff instanceof Buffer);\n        assert.equal('Hello, world', buff.toString());\n      });\n    });\n\n    it('catches errors from invalid input', function() {\n      return io.read({})\n          .then(() => assert.fail('should have failed'),\n                (e) => assert.ok(e instanceof TypeError));\n    });\n\n    it('rejects returned promise if file does not exist', function() {\n      return io.read(path.join(tmpDir, 'not-there'))\n          .then(() => assert.fail('should have failed'),\n                (e) => assert.equal('ENOENT', e.code));\n    });\n  });\n});\n"]}