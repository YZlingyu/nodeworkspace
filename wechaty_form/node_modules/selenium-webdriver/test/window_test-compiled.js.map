{"version":3,"sources":["window_test.js"],"names":[],"mappings":"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","file":"window_test-compiled.js","sourcesContent":["// Licensed to the Software Freedom Conservancy (SFC) under one\n// or more contributor license agreements.  See the NOTICE file\n// distributed with this work for additional information\n// regarding copyright ownership.  The SFC licenses this file\n// to you under the Apache License, Version 2.0 (the\n// \"License\"); you may not use this file except in compliance\n// with the License.  You may obtain a copy of the License at\n//\n//   http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing,\n// software distributed under the License is distributed on an\n// \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n// KIND, either express or implied.  See the License for the\n// specific language governing permissions and limitations\n// under the License.\n\n'use strict';\n\nvar Browser = require('..').Browser,\n    By = require('..').By,\n    assert = require('../testing/assert'),\n    test = require('../lib/test');\n\n\ntest.suite(function(env) {\n  var driver;\n\n  test.before(function*() { driver = yield env.builder().build(); });\n  test.after(function() { return driver.quit(); });\n\n  test.beforeEach(function() {\n    return driver.switchTo().defaultContent();\n  });\n\n  test.it('can set size of the current window', function*() {\n    yield driver.get(test.Pages.echoPage);\n    yield changeSizeBy(-20, -20);\n  });\n\n  test.it('can set size of the current window from frame', function*() {\n    yield driver.get(test.Pages.framesetPage);\n\n    var frame = yield driver.findElement({css: 'frame[name=\"fourth\"]'});\n    yield driver.switchTo().frame(frame);\n    yield changeSizeBy(-20, -20);\n  });\n\n  test.it('can set size of the current window from iframe', function*() {\n    yield driver.get(test.Pages.iframePage);\n\n    var frame = yield driver.findElement({css: 'iframe[name=\"iframe1-name\"]'});\n    yield driver.switchTo().frame(frame);\n    yield changeSizeBy(-20, -20);\n  });\n\n  test.it('can switch to a new window', function*() {\n    yield driver.get(test.Pages.xhtmlTestPage);\n\n    let handle = yield driver.getWindowHandle();\n    let originalHandles = yield driver.getAllWindowHandles();\n\n    yield driver.findElement(By.linkText(\"Open new window\")).click();\n    yield driver.wait(forNewWindowToBeOpened(originalHandles), 2000);\n    yield assert(driver.getTitle()).equalTo(\"XHTML Test Page\");\n\n    let newHandle = yield getNewWindowHandle(originalHandles);\n\n    yield driver.switchTo().window(newHandle);\n    yield assert(driver.getTitle()).equalTo(\"We Arrive Here\");\n  });\n\n  test.it('can set the window position of the current window', function*() {\n    let position = yield driver.manage().window().getPosition();\n\n    yield driver.manage().window().setSize(640, 480);\n    yield driver.manage().window().setPosition(position.x + 10, position.y + 10);\n\n    // For phantomjs, setPosition is a no-op and the \"window\" stays at (0, 0)\n    if (env.currentBrowser() === Browser.PHANTOM_JS) {\n      position = yield driver.manage().window().getPosition();\n      assert(position.x).equalTo(0);\n      assert(position.y).equalTo(0);\n    } else {\n      var dx = position.x + 10;\n      var dy = position.y + 10;\n      return driver.wait(forPositionToBe(dx, dy), 1000);\n    }\n  });\n\n  test.it('can set the window position from a frame', function*() {\n    yield driver.get(test.Pages.iframePage);\n\n    let frame = yield driver.findElement(By.name('iframe1-name'));\n    yield driver.switchTo().frame(frame);\n\n    let position = yield driver.manage().window().getPosition();\n    yield driver.manage().window().setSize(640, 480);\n    yield driver.manage().window().setPosition(position.x + 10, position.y + 10);\n\n    // For phantomjs, setPosition is a no-op and the \"window\" stays at (0, 0)\n    if (env.currentBrowser() === Browser.PHANTOM_JS) {\n      return driver.manage().window().getPosition().then(function(position) {\n        assert(position.x).equalTo(0);\n        assert(position.y).equalTo(0);\n      });\n    } else {\n      var dx = position.x + 10;\n      var dy = position.y + 10;\n      return driver.wait(forPositionToBe(dx, dy), 1000);\n    }\n  });\n\n  function changeSizeBy(dx, dy) {\n    return driver.manage().window().getSize().then(function(size) {\n      return driver.manage().window()\n          .setSize(size.width + dx, size.height + dy)\n          .then(_ => {\n            return driver.wait(\n                forSizeToBe(size.width + dx, size.height + dy), 1000);\n          });\n    });\n  }\n\n  function forSizeToBe(w, h) {\n    return function() {\n      return driver.manage().window().getSize().then(function(size) {\n        return size.width === w && size.height === h;\n      });\n    };\n  }\n\n  function forPositionToBe(x, y) {\n    return function() {\n      return driver.manage().window().getPosition().then(function(position) {\n        return position.x === x &&\n            // On OSX, the window height may be bumped down 22px for the top\n            // status bar.\n            // On Linux, Opera's window position will be off by 28px.\n           (position.y >= y && position.y <= (y + 28));\n      });\n    };\n  }\n\n  function forNewWindowToBeOpened(originalHandles) {\n    return function() {\n      return driver.getAllWindowHandles().then(function(currentHandles) {\n        return currentHandles.length > originalHandles.length;\n      });\n    };\n  }\n\n  function getNewWindowHandle(originalHandles) {\n    // Note: this assumes there's just one new window.\n    return driver.getAllWindowHandles().then(function(currentHandles) {\n      return currentHandles.filter(function(i) {\n        return originalHandles.indexOf(i) < 0;\n      })[0];\n    });\n  }\n});\n"]}