{"version":3,"sources":["enumerator.js"],"names":[],"mappings":"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","file":"enumerator-compiled.js","sourcesContent":["import {\n  isArray,\n  isMaybeThenable\n} from './utils';\n\nimport {\n  noop,\n  reject,\n  fulfill,\n  subscribe,\n  FULFILLED,\n  REJECTED,\n  PENDING,\n  getThen,\n  handleMaybeThenable\n} from './-internal';\n\nimport then from './then';\nimport Promise from './promise';\nimport originalResolve from './promise/resolve';\nimport originalThen from './then';\nimport { makePromise, PROMISE_ID } from './-internal';\n\nexport default Enumerator;\nfunction Enumerator(Constructor, input) {\n  this._instanceConstructor = Constructor;\n  this.promise = new Constructor(noop);\n\n  if (!this.promise[PROMISE_ID]) {\n    makePromise(this.promise);\n  }\n\n  if (isArray(input)) {\n    this._input     = input;\n    this.length     = input.length;\n    this._remaining = input.length;\n\n    this._result = new Array(this.length);\n\n    if (this.length === 0) {\n      fulfill(this.promise, this._result);\n    } else {\n      this.length = this.length || 0;\n      this._enumerate();\n      if (this._remaining === 0) {\n        fulfill(this.promise, this._result);\n      }\n    }\n  } else {\n    reject(this.promise, validationError());\n  }\n}\n\nfunction validationError() {\n  return new Error('Array Methods must be provided an Array');\n};\n\nEnumerator.prototype._enumerate = function() {\n  var length  = this.length;\n  var input   = this._input;\n\n  for (var i = 0; this._state === PENDING && i < length; i++) {\n    this._eachEntry(input[i], i);\n  }\n};\n\nEnumerator.prototype._eachEntry = function(entry, i) {\n  var c = this._instanceConstructor;\n  var resolve = c.resolve;\n\n  if (resolve === originalResolve) {\n    var then = getThen(entry);\n\n    if (then === originalThen &&\n        entry._state !== PENDING) {\n      this._settledAt(entry._state, i, entry._result);\n    } else if (typeof then !== 'function') {\n      this._remaining--;\n      this._result[i] = entry;\n    } else if (c === Promise) {\n      var promise = new c(noop);\n      handleMaybeThenable(promise, entry, then);\n      this._willSettleAt(promise, i);\n    } else {\n      this._willSettleAt(new c(function(resolve) { resolve(entry); }), i);\n    }\n  } else {\n    this._willSettleAt(resolve(entry), i);\n  }\n};\n\nEnumerator.prototype._settledAt = function(state, i, value) {\n  var promise = this.promise;\n\n  if (promise._state === PENDING) {\n    this._remaining--;\n\n    if (state === REJECTED) {\n      reject(promise, value);\n    } else {\n      this._result[i] = value;\n    }\n  }\n\n  if (this._remaining === 0) {\n    fulfill(promise, this._result);\n  }\n};\n\nEnumerator.prototype._willSettleAt = function(promise, i) {\n  var enumerator = this;\n\n  subscribe(promise, undefined, function(value) {\n    enumerator._settledAt(FULFILLED, i, value);\n  }, function(reason) {\n    enumerator._settledAt(REJECTED, i, reason);\n  });\n};\n"]}