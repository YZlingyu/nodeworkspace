{"version":3,"sources":["saveSubdocs.js"],"names":[],"mappings":"AAAA;;AAEA,IAAI,OAAO,QAAQ,YAAR,CAAX;;AAEA;;;;AAIA,OAAO,OAAP,GAAiB,UAAS,MAAT,EAAiB;AAChC,SAAO,QAAP,CAAgB,WAAhB,GAA8B,IAA9B;;AAEA,SAAO,SAAP,CAAiB,OAAjB,CAAyB,CAAC,KAAD,EAAQ,CAAC,MAAD,EAAS,UAAS,IAAT,EAAe;AACvD,QAAI,KAAK,aAAT,EAAwB;AACtB;AACA;AACD;;AAED,QAAI,QAAQ,IAAZ;AACA,QAAI,UAAU,KAAK,gBAAL,EAAd;;AAEA,QAAI,CAAC,QAAQ,MAAb,EAAqB;AACnB;AACA;AACD;;AAED,SAAK,OAAL,EAAc,UAAS,MAAT,EAAiB,EAAjB,EAAqB;AACjC,aAAO,IAAP,CAAY,UAAS,GAAT,EAAc;AACxB,WAAG,GAAH;AACD,OAFD;AAGD,KAJD,EAIG,UAAS,KAAT,EAAgB;AACjB,UAAI,KAAJ,EAAW;AACT,eAAO,MAAM,MAAN,CAAa,CAAb,CAAe,KAAf,CAAqB,QAArB,CAA8B,YAA9B,EAA4C,KAA5C,EAAmD,CAAC,KAAD,CAAnD,EAA4D,EAAE,OAAO,KAAT,EAA5D,EAA8E,UAAS,KAAT,EAAgB;AACnG,eAAK,KAAL;AACD,SAFM,CAAP;AAGD;AACD;AACD,KAXD;AAYD,GA1BgC,CAAR,CAAzB;AA2BD,CA9BD","file":"saveSubdocs-compiled.js","sourcesContent":["'use strict';\n\nvar each = require('async/each');\n\n/*!\n * ignore\n */\n\nmodule.exports = function(schema) {\n  schema._plugins.saveSubdocs = true;\n\n  schema.callQueue.unshift(['pre', ['save', function(next) {\n    if (this.ownerDocument) {\n      next();\n      return;\n    }\n\n    var _this = this;\n    var subdocs = this.$__getAllSubdocs();\n\n    if (!subdocs.length) {\n      next();\n      return;\n    }\n\n    each(subdocs, function(subdoc, cb) {\n      subdoc.save(function(err) {\n        cb(err);\n      });\n    }, function(error) {\n      if (error) {\n        return _this.schema.s.hooks.execPost('save:error', _this, [_this], { error: error }, function(error) {\n          next(error);\n        });\n      }\n      next();\n    });\n  }]]);\n};\n"]}