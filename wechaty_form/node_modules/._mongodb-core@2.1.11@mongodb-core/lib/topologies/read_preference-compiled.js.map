{"version":3,"sources":["read_preference.js"],"names":[],"mappings":"AAAA;;AAEA,IAAI,cAAc,CAAC,kBAAD,EAAqB,WAArB,EAAkC,oBAAlC,EAAwD,SAAxD,CAAlB;;AAEA;;;;;;;;;;;;;;;;;;;;;;;;AAwBA;;;;;;;;;;;;;AAaA,IAAI,iBAAiB,UAAS,UAAT,EAAqB,IAArB,EAA2B,OAA3B,EAAoC;AACvD,OAAK,UAAL,GAAkB,UAAlB;AACA,OAAK,IAAL,GAAY,IAAZ;AACA,OAAK,OAAL,GAAe,OAAf;;AAEA;AACA,MAAG,KAAK,OAAL,IAAgB,KAAK,OAAL,CAAa,mBAAb,IAAoC,IAAvD,EAA6D;AAC3D,SAAK,OAAL,GAAe,OAAf;AACA,SAAK,mBAAL,GAA2B,KAAK,OAAL,CAAa,mBAAb,IAAoC,CAApC,GACvB,KAAK,OAAL,CAAa,mBADU,GACY,IADvC;AAED,GAJD,MAIO,IAAG,QAAQ,OAAO,IAAP,IAAe,QAA1B,EAAoC;AACzC,SAAK,OAAL,GAAe,IAAf,EAAqB,OAAO,IAA5B;AACD;AACF,CAbD;;AAeA;;;;;AAKA,eAAe,SAAf,CAAyB,OAAzB,GAAmC,YAAW;AAC5C,SAAO,YAAY,OAAZ,CAAoB,KAAK,UAAzB,KAAwC,CAAC,CAAhD;AACD,CAFD;;AAIA;;;;;AAKA,eAAe,SAAf,CAAyB,MAAzB,GAAkC,UAAS,cAAT,EAAyB;AACzD,SAAO,eAAe,UAAf,IAA6B,KAAK,UAAzC;AACD,CAFD;;AAIA;;;;;AAKA,eAAe,SAAf,CAAyB,MAAzB,GAAkC,YAAW;AAC3C,MAAI,iBAAiB,EAAC,MAAM,KAAK,UAAZ,EAArB;AACA,MAAG,MAAM,OAAN,CAAc,KAAK,IAAnB,CAAH,EAA6B,eAAe,IAAf,GAAsB,KAAK,IAA3B;AAC7B,MAAG,KAAK,mBAAR,EAA6B,eAAe,mBAAf,GAAqC,KAAK,mBAA1C;AAC7B,SAAO,cAAP;AACD,CALD;;AAOA;;;;;AAKA,eAAe,OAAf,GAAyB,IAAI,cAAJ,CAAmB,SAAnB,CAAzB;AACA;;;;;AAKA,eAAe,gBAAf,GAAkC,IAAI,cAAJ,CAAmB,kBAAnB,CAAlC;AACA;;;;;AAKA,eAAe,SAAf,GAA2B,IAAI,cAAJ,CAAmB,WAAnB,CAA3B;AACA;;;;;AAKA,eAAe,kBAAf,GAAoC,IAAI,cAAJ,CAAmB,oBAAnB,CAApC;AACA;;;;;AAKA,eAAe,OAAf,GAAyB,IAAI,cAAJ,CAAmB,SAAnB,CAAzB;;AAEA,OAAO,OAAP,GAAiB,cAAjB","file":"read_preference-compiled.js","sourcesContent":["\"use strict\";\n\nvar needSlaveOk = ['primaryPreferred', 'secondary', 'secondaryPreferred', 'nearest'];\n\n/**\n * @fileOverview The **ReadPreference** class is a class that represents a MongoDB ReadPreference and is\n * used to construct connections.\n *\n * @example\n * var ReplSet = require('mongodb-core').ReplSet\n *   , ReadPreference = require('mongodb-core').ReadPreference\n *   , assert = require('assert');\n *\n * var server = new ReplSet([{host: 'localhost', port: 30000}], {setName: 'rs'});\n * // Wait for the connection event\n * server.on('connect', function(server) {\n *   var cursor = server.cursor('db.test'\n *     , {find: 'db.test', query: {}}\n *     , {readPreference: new ReadPreference('secondary')});\n *   cursor.next(function(err, doc) {\n *     server.destroy();\n *   });\n * });\n *\n * // Start connecting\n * server.connect();\n */\n\n/**\n * Creates a new Pool instance\n * @class\n * @param {string} preference A string describing the preference (primary|primaryPreferred|secondary|secondaryPreferred|nearest)\n * @param {array} tags The tags object\n * @param {object} [options] Additional read preference options\n * @param {number} [options.maxStalenessSeconds] Max Secondary Read Stalleness in Seconds, Minimum value is 90 seconds.\n * @property {string} preference The preference string (primary|primaryPreferred|secondary|secondaryPreferred|nearest)\n * @property {array} tags The tags object\n * @property {object} options Additional read preference options\n * @property {number} maxStalenessSeconds MaxStalenessSeconds value for the read preference\n * @return {ReadPreference}\n */\nvar ReadPreference = function(preference, tags, options) {\n  this.preference = preference;\n  this.tags = tags;\n  this.options = options;\n\n  // Add the maxStalenessSeconds value to the read Preference\n  if(this.options && this.options.maxStalenessSeconds != null) {\n    this.options = options;\n    this.maxStalenessSeconds = this.options.maxStalenessSeconds >= 0\n      ? this.options.maxStalenessSeconds : null;\n  } else if(tags && typeof tags == 'object') {\n    this.options = tags, tags = null;\n  }\n}\n\n/**\n * This needs slaveOk bit set\n * @method\n * @return {boolean}\n */\nReadPreference.prototype.slaveOk = function() {\n  return needSlaveOk.indexOf(this.preference) != -1;\n}\n\n/**\n * Are the two read preference equal\n * @method\n * @return {boolean}\n */\nReadPreference.prototype.equals = function(readPreference) {\n  return readPreference.preference == this.preference;\n}\n\n/**\n * Return JSON representation\n * @method\n * @return {Object}\n */\nReadPreference.prototype.toJSON = function() {\n  var readPreference = {mode: this.preference};\n  if(Array.isArray(this.tags)) readPreference.tags = this.tags;\n  if(this.maxStalenessSeconds) readPreference.maxStalenessSeconds = this.maxStalenessSeconds;\n  return readPreference;\n}\n\n/**\n * Primary read preference\n * @method\n * @return {ReadPreference}\n */\nReadPreference.primary = new ReadPreference('primary');\n/**\n * Primary Preferred read preference\n * @method\n * @return {ReadPreference}\n */\nReadPreference.primaryPreferred = new ReadPreference('primaryPreferred');\n/**\n * Secondary read preference\n * @method\n * @return {ReadPreference}\n */\nReadPreference.secondary = new ReadPreference('secondary');\n/**\n * Secondary Preferred read preference\n * @method\n * @return {ReadPreference}\n */\nReadPreference.secondaryPreferred = new ReadPreference('secondaryPreferred');\n/**\n * Nearest read preference\n * @method\n * @return {ReadPreference}\n */\nReadPreference.nearest = new ReadPreference('nearest');\n\nmodule.exports = ReadPreference;\n"]}