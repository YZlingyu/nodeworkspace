{"version":3,"sources":["test.js"],"names":[],"mappings":"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","file":"test-compiled.js","sourcesContent":["var hooks = require('./hooks')\n  , should = require('should')\n  , assert = require('assert')\n  , _ = require('underscore');\n\n// TODO Add in test for making sure all pres get called if pre is defined directly on an instance.\n// TODO Test for calling `done` twice or `next` twice in the same function counts only once\nmodule.exports = {\n  'should be able to assign multiple hooks at once': function () {\n    var A = function () {};\n    _.extend(A, hooks);\n    A.$hook({\n      hook1: function (a) {},\n      hook2: function (b) {}\n    });\n    var a = new A();\n    assert.equal(typeof a.hook1, 'function');\n    assert.equal(typeof a.hook2, 'function');\n  },\n  'should run without pres and posts when not present': function () {\n    var A = function () {};\n    _.extend(A, hooks);\n    A.$hook('save', function () {\n      this.value = 1;\n    });\n    var a = new A();\n    a.save();\n    a.value.should.equal(1);\n  },\n  'should run with pres when present': function () {\n    var A = function () {};\n    _.extend(A, hooks);\n    A.$hook('save', function () {\n      this.value = 1;\n    });\n    A.pre('save', function (next) {\n      this.preValue = 2;\n      next();\n    });\n    var a = new A();\n    a.save();\n    a.value.should.equal(1);\n    a.preValue.should.equal(2);\n  },\n  'should run with posts when present': function () {\n    var A = function () {};\n    _.extend(A, hooks);\n    A.$hook('save', function () {\n      this.value = 1;\n    });\n    A.post('save', function (next) {\n      this.value = 2;\n      next();\n    });\n    var a = new A();\n    a.save();\n    a.value.should.equal(2);\n  },\n  'should run pres and posts when present': function () {\n    var A = function () {};\n    _.extend(A, hooks);\n    A.$hook('save', function () {\n      this.value = 1;\n    });\n    A.pre('save', function (next) {\n      this.preValue = 2;\n      next();\n    });\n    A.post('save', function (next) {\n      this.value = 3;\n      next();\n    });\n    var a = new A();\n    a.save();\n    a.value.should.equal(3);\n    a.preValue.should.equal(2);\n  },\n  'should run posts after pres': function () {\n    var A = function () {};\n    _.extend(A, hooks);\n    A.$hook('save', function () {\n      this.value = 1;\n    });\n    A.pre('save', function (next) {\n      this.override = 100;\n      next();\n    });\n    A.post('save', function (next) {\n      this.override = 200;\n      next();\n    });\n    var a = new A();\n    a.save();\n    a.value.should.equal(1);\n    a.override.should.equal(200);\n  },\n  'should not run a hook if a pre fails': function () {\n    var A = function () {};\n    _.extend(A, hooks);\n    var counter = 0;\n    A.$hook('save', function () {\n      this.value = 1;\n    }, function (err) {\n      counter++;\n    });\n    A.pre('save', true, function (next, done) {\n      next(new Error());\n    });\n    var a = new A();\n    a.save();\n    counter.should.equal(1);\n    assert.equal(typeof a.value, 'undefined');\n  },\n  'should be able to run multiple pres': function () {\n    var A = function () {};\n    _.extend(A, hooks);\n    A.$hook('save', function () {\n      this.value = 1;\n    });\n    A.pre('save', function (next) {\n      this.v1 = 1;\n      next();\n    }).pre('save', function (next) {\n      this.v2 = 2;\n      next();\n    });\n    var a = new A();\n    a.save();\n    a.v1.should.equal(1);\n    a.v2.should.equal(2);\n  },\n  'should run multiple pres until a pre fails and not call the hook': function () {\n    var A = function () {};\n    _.extend(A, hooks);\n    A.$hook('save', function () {\n      this.value = 1;\n    }, function (err) {});\n    A.pre('save', function (next) {\n      this.v1 = 1;\n      next();\n    }).pre('save', function (next) {\n      next(new Error());\n    }).pre('save', function (next) {\n      this.v3 = 3;\n      next();\n    });\n    var a = new A();\n    a.save();\n    a.v1.should.equal(1);\n    assert.equal(typeof a.v3, 'undefined');\n    assert.equal(typeof a.value, 'undefined');\n  },\n  'should be able to run multiple posts': function () {\n    var A = function () {};\n    _.extend(A, hooks);\n    A.$hook('save', function () {\n      this.value = 1;\n    });\n    A.post('save', function (next) {\n      this.value = 2;\n      next();\n    }).post('save', function (next) {\n      this.value = 3.14;\n      next();\n    }).post('save', function (next) {\n      this.v3 = 3;\n      next();\n    });\n    var a = new A();\n    a.save();\n    assert.equal(a.value, 3.14);\n    assert.equal(a.v3, 3);\n  },\n  'should run only posts up until an error': function () {\n    var A = function () {};\n    _.extend(A, hooks);\n    A.$hook('save', function () {\n      this.value = 1;\n    }, function (err) {});\n    A.post('save', function (next) {\n      this.value = 2;\n      next();\n    }).post('save', function (next) {\n      this.value = 3;\n      next(new Error());\n    }).post('save', function (next) {\n      this.value = 4;\n      next();\n    });\n    var a = new A();\n    a.save();\n    a.value.should.equal(3);\n  },\n  \"should fall back first to the hook method's last argument as the error handler if it is a function of arity 1 or 2\": function () {\n    var A = function () {};\n    _.extend(A, hooks);\n    var counter = 0;\n    A.$hook('save', function (callback) {\n      this.value = 1;\n    });\n    A.pre('save', true, function (next, done) {\n      next(new Error());\n    });\n    var a = new A();\n    a.save( function (err) {\n      if (err instanceof Error) counter++;\n    });\n    counter.should.equal(1);\n    should.deepEqual(undefined, a.value);\n  },\n  'should fall back second to the default error handler if specified': function () {\n    var A = function () {};\n    _.extend(A, hooks);\n    var counter = 0;\n    A.$hook('save', function (callback) {\n      this.value = 1;\n    }, function (err) {\n      if (err instanceof Error) counter++;\n    });\n    A.pre('save', true, function (next, done) {\n      next(new Error());\n    });\n    var a = new A();\n    a.save();\n    counter.should.equal(1);\n    should.deepEqual(undefined, a.value);\n  },\n  'fallback default error handler should scope to the object': function () {\n    var A = function () {\n      this.counter = 0;\n    };\n    _.extend(A, hooks);\n    var counter = 0;\n    A.$hook('save', function (callback) {\n      this.value = 1;\n    }, function (err) {\n      if (err instanceof Error) this.counter++;\n    });\n    A.pre('save', true, function (next, done) {\n      next(new Error());\n    });\n    var a = new A();\n    a.save();\n    a.counter.should.equal(1);\n    should.deepEqual(undefined, a.value);\n  },\n  'should fall back last to throwing the error': function () {\n    var A = function () {};\n    _.extend(A, hooks);\n    var counter = 0;\n    A.$hook('save', function (err) {\n      if (err instanceof Error) return counter++;\n      this.value = 1;\n    });\n    A.pre('save', true, function (next, done) {\n      next(new Error());\n    });\n    var a = new A();\n    var didCatch = false;\n    try {\n      a.save();\n    } catch (e) {\n      didCatch = true;\n      e.should.be.an.instanceof(Error);\n      counter.should.equal(0);\n      assert.equal(typeof a.value, 'undefined');\n    }\n    didCatch.should.be.true;\n  },\n  \"should proceed without mutating arguments if `next(null|undefined)` is called in a serial pre, and the last argument of the target method is a callback with node-like signature function (err, obj) {...} or function (err) {...}\": function () {\n    var A = function () {};\n    _.extend(A, hooks);\n    var counter = 0;\n    A.prototype.save = function (callback) {\n      this.value = 1;\n      callback();\n    };\n    A.pre('save', function (next) {\n      next(null);\n    });\n    A.pre('save', function (next) {\n      next(undefined);\n    });\n    var a = new A();\n    a.save( function (err) {\n      if (err instanceof Error) counter++;\n      else counter--;\n    });\n    counter.should.equal(-1);\n    a.value.should.eql(1);\n  },\n  \"should proceed with mutating arguments if `next(null|undefined)` is callback in a serial pre, and the last argument of the target method is not a function\": function () {\n    var A = function () {};\n    _.extend(A, hooks);\n    A.prototype.set = function (v) {\n      this.value = v;\n    };\n    A.pre('set', function (next) {\n      next(undefined);\n    });\n    A.pre('set', function (next) {\n      next(null);\n    });\n    var a = new A();\n    a.set(1);\n    should.strictEqual(null, a.value);\n  },\n  'should not run any posts if a pre fails': function () {\n    var A = function () {};\n    _.extend(A, hooks);\n    A.$hook('save', function () {\n      this.value = 2;\n    }, function (err) {});\n    A.pre('save', function (next) {\n      this.value = 1;\n      next(new Error());\n    }).post('save', function (next) {\n      this.value = 3;\n      next();\n    });\n    var a = new A();\n    a.save();\n    a.value.should.equal(1);\n  },\n\n  \"can pass the hook's arguments verbatim to pres\": function () {\n    var A = function () {};\n    _.extend(A, hooks);\n    A.$hook('set', function (path, val) {\n      this[path] = val;\n    });\n    A.pre('set', function (next, path, val) {\n      path.should.equal('hello');\n      val.should.equal('world');\n      next();\n    });\n    var a = new A();\n    a.set('hello', 'world');\n    a.hello.should.equal('world');\n  },\n//  \"can pass the hook's arguments as an array to pres\": function () {\n//    // Great for dynamic arity - e.g., slice(...)\n//    var A = function () {};\n//    _.extend(A, hooks);\n//    A.hook('set', function (path, val) {\n//      this[path] = val;\n//    });\n//    A.pre('set', function (next, hello, world) {\n//      hello.should.equal('hello');\n//      world.should.equal('world');\n//      next();\n//    });\n//    var a = new A();\n//    a.set('hello', 'world');\n//    assert.equal(a.hello, 'world');\n//  },\n  \"can pass the hook's arguments verbatim to posts\": function () {\n    var A = function () {};\n    _.extend(A, hooks);\n    A.$hook('set', function (path, val) {\n      this[path] = val;\n    });\n    A.post('set', function (next, path, val) {\n      path.should.equal('hello');\n      val.should.equal('world');\n      next();\n    });\n    var a = new A();\n    a.set('hello', 'world');\n    assert.equal(a.hello, 'world');\n  },\n//  \"can pass the hook's arguments as an array to posts\": function () {\n//    var A = function () {};\n//    _.extend(A, hooks);\n//    A.hook('set', function (path, val) {\n//      this[path] = val;\n//    });\n//    A.post('set', function (next, halt, args) {\n//      assert.equal(args[0], 'hello');\n//      assert.equal(args[1], 'world');\n//      next();\n//    });\n//    var a = new A();\n//    a.set('hello', 'world');\n//    assert.equal(a.hello, 'world');\n//  },\n  \"pres should be able to modify and pass on a modified version of the hook's arguments\": function () {\n    var A = function () {};\n    _.extend(A, hooks);\n    A.$hook('set', function (path, val) {\n      this[path] = val;\n      assert.equal(arguments[2], 'optional');\n    });\n    A.pre('set', function (next, path, val) {\n      next('foo', 'bar');\n    });\n    A.pre('set', function (next, path, val) {\n      assert.equal(path, 'foo');\n      assert.equal(val, 'bar');\n      next('rock', 'says', 'optional');\n    });\n    A.pre('set', function (next, path, val, opt) {\n      assert.equal(path, 'rock');\n      assert.equal(val, 'says');\n      assert.equal(opt, 'optional');\n      next();\n    });\n    var a = new A();\n    a.set('hello', 'world');\n    assert.equal(typeof a.hello, 'undefined');\n    a.rock.should.equal('says');\n  },\n  'posts should see the modified version of arguments if the pres modified them': function () {\n    var A = function () {};\n    _.extend(A, hooks);\n    A.$hook('set', function (path, val) {\n      this[path] = val;\n    });\n    A.pre('set', function (next, path, val) {\n      next('foo', 'bar');\n    });\n    A.post('set', function (next, path, val) {\n      path.should.equal('foo');\n      val.should.equal('bar');\n    });\n    var a = new A();\n    a.set('hello', 'world');\n    assert.equal(typeof a.hello, 'undefined');\n    a.foo.should.equal('bar');\n  },\n  'should pad missing arguments (relative to expected arguments of the hook) with null': function () {\n    // Otherwise, with hookFn = function (a, b, next, ),\n    // if we use hookFn(a), then because the pre functions are of the form\n    // preFn = function (a, b, next, ), then it actually gets executed with\n    // preFn(a, next, ), so when we call next() from within preFn, we are actually\n    // calling ()\n\n    var A = function () {};\n    _.extend(A, hooks);\n    A.$hook('set', function (path, val, opts) {\n      this[path] = val;\n    });\n    A.pre('set', function (next, path, val, opts) {\n      next('foo', 'bar');\n      assert.equal(typeof opts, 'undefined');\n    });\n    var a = new A();\n    a.set('hello', 'world');\n  },\n\n  'should not invoke the target method until all asynchronous middleware have invoked dones': function () {\n    var counter = 0;\n    var A = function () {};\n    _.extend(A, hooks);\n    A.$hook('set', function (path, val) {\n      counter++;\n      this[path] = val;\n      counter.should.equal(7);\n    });\n    A.pre('set', function (next, path, val) {\n      counter++;\n      next();\n    });\n    A.pre('set', true, function (next, done, path, val) {\n      counter++;\n      setTimeout(function () {\n        counter++;\n        done();\n      }, 1000);\n      next();\n    });\n    A.pre('set', function (next, path, val) {\n      counter++;\n      next();\n    });\n    A.pre('set', true, function (next, done, path, val) {\n      counter++;\n      setTimeout(function () {\n        counter++;\n        done();\n      }, 500);\n      next();\n    });\n    var a = new A();\n    a.set('hello', 'world');\n  },\n\n  'invoking a method twice should run its async middleware twice': function () {\n    var counter = 0;\n    var A = function () {};\n    _.extend(A, hooks);\n    A.$hook('set', function (path, val) {\n      this[path] = val;\n      if (path === 'hello') counter.should.equal(1);\n      if (path === 'foo') counter.should.equal(2);\n    });\n    A.pre('set', true, function (next, done, path, val) {\n      setTimeout(function () {\n        counter++;\n        done();\n      }, 1000);\n      next();\n    });\n    var a = new A();\n    a.set('hello', 'world');\n    a.set('foo', 'bar');\n  },\n\n  'calling the same done multiple times should have the effect of only calling it once': function () {\n    var A = function () {\n      this.acked = false;\n    };\n    _.extend(A, hooks);\n    A.$hook('ack', function () {\n      console.log(\"UH OH, YOU SHOULD NOT BE SEEING THIS\");\n      this.acked = true;\n    });\n    A.pre('ack', true, function (next, done) {\n      next();\n      done();\n      done();\n    });\n    A.pre('ack', true, function (next, done) {\n      next();\n      // Notice that done() is not invoked here\n    });\n    var a = new A();\n    a.ack();\n    setTimeout( function () {\n      a.acked.should.be.false;\n    }, 1000);\n  },\n\n  'calling the same next multiple times should have the effect of only calling it once': function (beforeExit) {\n    var A = function () {\n      this.acked = false;\n    };\n    _.extend(A, hooks);\n    A.$hook('ack', function () {\n      console.log(\"UH OH, YOU SHOULD NOT BE SEEING THIS\");\n      this.acked = true;\n    });\n    A.pre('ack', function (next) {\n      // force a throw to re-exec next()\n      try {\n        next(new Error('bam'));\n      } catch (err) {\n        next();\n      }\n    });\n    A.pre('ack', function (next) {\n      next();\n    });\n    var a = new A();\n    a.ack();\n    beforeExit( function () {\n      a.acked.should.be.false;\n    });\n  },\n\n  'asynchronous middleware should be able to pass an error via `done`, stopping the middleware chain': function () {\n    var counter = 0;\n    var A = function () {};\n    _.extend(A, hooks);\n    A.$hook('set', function (path, val, fn) {\n      counter++;\n      this[path] = val;\n      fn(null);\n    });\n    A.pre('set', true, function (next, done, path, val, fn) {\n      setTimeout(function () {\n        counter++;\n        done(new Error);\n      }, 1000);\n      next();\n    });\n    var a = new A();\n    a.set('hello', 'world', function (err) {\n      err.should.be.an.instanceof(Error);\n      should.strictEqual(undefined, a['hello']);\n      counter.should.eql(1);\n    });\n  },\n\n  'should be able to remove a particular pre': function () {\n    var A = function () {}\n      , preTwo;\n    _.extend(A, hooks);\n    A.$hook('save', function () {\n      this.value = 1;\n    });\n    A.pre('save', function (next) {\n      this.preValueOne = 2;\n      next();\n    });\n    A.pre('save', preTwo = function (next) {\n      this.preValueTwo = 4;\n      next();\n    });\n    A.removePre('save', preTwo);\n    var a = new A();\n    a.save();\n    a.value.should.equal(1);\n    a.preValueOne.should.equal(2);\n    should.strictEqual(undefined, a.preValueTwo);\n  },\n\n  'should be able to remove all pres associated with a hook': function () {\n    var A = function () {};\n    _.extend(A, hooks);\n    A.$hook('save', function () {\n      this.value = 1;\n    });\n    A.pre('save', function (next) {\n      this.preValueOne = 2;\n      next();\n    });\n    A.pre('save', function (next) {\n      this.preValueTwo = 4;\n      next();\n    });\n    A.removePre('save');\n    var a = new A();\n    a.save();\n    a.value.should.equal(1);\n    should.strictEqual(undefined, a.preValueOne);\n    should.strictEqual(undefined, a.preValueTwo);\n  },\n\n  'should be able to remove a particular post': function () {\n    var A = function () {}\n      , postTwo;\n    _.extend(A, hooks);\n    A.$hook('save', function () {\n      this.value = 1;\n    });\n    A.post('save', function (next) {\n      this.postValueOne = 2;\n      next();\n    });\n    A.post('save', postTwo = function (next) {\n      this.postValueTwo = 4;\n      next();\n    });\n    A.removePost('save', postTwo);\n    var a = new A();\n    a.save();\n    a.value.should.equal(1);\n    a.postValueOne.should.equal(2);\n    should.strictEqual(undefined, a.postValueTwo);\n  },\n\n  'should be able to remove all posts associated with a hook': function () {\n    var A = function () {};\n    _.extend(A, hooks);\n    A.$hook('save', function () {\n      this.value = 1;\n    });\n    A.post('save', function (next) {\n      this.postValueOne = 2;\n      next();\n    });\n    A.post('save', function (next) {\n      this.postValueTwo = 4;\n      next();\n    });\n    A.removePost('save');\n    var a = new A();\n    a.save();\n    a.value.should.equal(1);\n    should.strictEqual(undefined, a.postValueOne);\n    should.strictEqual(undefined, a.postValueTwo);\n  },\n\n  '#pre should lazily make a method hookable': function () {\n    var A = function () {};\n    _.extend(A, hooks);\n    A.prototype.save = function () {\n      this.value = 1;\n    };\n    A.pre('save', function (next) {\n      this.preValue = 2;\n      next();\n    });\n    var a = new A();\n    a.save();\n    a.value.should.equal(1);\n    a.preValue.should.equal(2);\n  },\n\n  '#pre lazily making a method hookable should be able to provide a default errorHandler as the last argument': function () {\n    var A = function () {};\n    var preValue = \"\";\n    _.extend(A, hooks);\n    A.prototype.save = function () {\n      this.value = 1;\n    };\n    A.pre('save', function (next) {\n      next(new Error);\n    }, function (err) {\n      preValue = 'ERROR';\n    });\n    var a = new A();\n    a.save();\n    should.strictEqual(undefined, a.value);\n    preValue.should.equal('ERROR');\n  },\n\n  '#post should lazily make a method hookable': function () {\n    var A = function () {};\n    _.extend(A, hooks);\n    A.prototype.save = function () {\n      this.value = 1;\n    };\n    A.post('save', function (next) {\n      this.value = 2;\n      next();\n    });\n    var a = new A();\n    a.save();\n    a.value.should.equal(2);\n  },\n\n  \"a lazy hooks setup should handle errors via a method's last argument, if it's a callback\": function () {\n    var A = function () {};\n    _.extend(A, hooks);\n    A.prototype.save = function (fn) {};\n    A.pre('save', function (next) {\n      next(new Error(\"hi there\"));\n    });\n    var a = new A();\n    a.save( function (err) {\n      err.should.be.an.instanceof(Error);\n    });\n  },\n\n  'should intercept method callbacks for post handlers': function () {\n    var A = function () {};\n    _.extend(A, hooks);\n    A.$hook('save', function (val, callback) {\n      this.value = val;\n      callback();\n    });\n    A.post('save', function (next) {\n      assert.equal(a.value, 2);\n      this.value += 2;\n      setTimeout(next, 10);\n    }).post('save', function (next) {\n      assert.equal(a.value, 4);\n      this.value += 3;\n      setTimeout(next, 10);\n    }).post('save', function (next) {\n      assert.equal(a.value, 7);\n      this.value2 = 3;\n      setTimeout(next, 10);\n    });\n    var a = new A();\n    a.save(2, function(){\n      assert.equal(a.value, 7);\n      assert.equal(a.value2, 3);\n    });\n  },\n\n  'should handle parallel followed by serial': function () {\n    var A = function () {};\n    _.extend(A, hooks);\n    A.$hook('save', function (val, callback) {\n      this.value = val;\n      callback();\n    });\n    A.pre('save', true, function(next, done) {\n      process.nextTick(function() {\n        done();\n      });\n      next();\n    }).pre('save', function(done) {\n      process.nextTick(function() {\n        done();\n      });\n    });\n    var a = new A();\n    a.save(2, function(){\n      assert.ok(true);\n    });\n  }\n};\n"]}