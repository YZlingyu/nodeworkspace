{"version":3,"sources":["promise.test.js"],"names":[],"mappings":"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","file":"promise.test-compiled.js","sourcesContent":["/*global describe,it */\n/**\n * Module dependencies.\n */\n\nvar assert = require('assert');\nvar MPromise = require('../');\n\n/**\n * Test.\n */\n\ndescribe('promise', function () {\n  it('events fire right after fulfill()', function (done) {\n    var promise = new MPromise()\n      , called = 0;\n\n    promise.on('fulfill', function (a, b) {\n      assert.equal(a, '1');\n      assert.equal(b, '2');\n      called++;\n    });\n\n    promise.fulfill('1', '2');\n\n    promise.on('fulfill', function (a, b) {\n      assert.equal(a, '1');\n      assert.equal(b, '2');\n      called++;\n    });\n\n    assert.equal(2, called);\n    done();\n  });\n\n  it('events fire right after reject()', function (done) {\n    var promise = new MPromise()\n      , called = 0;\n\n    promise.on('reject', function (err) {\n      assert.ok(err instanceof Error);\n      called++;\n    });\n\n    promise.reject(new Error('booyah'));\n\n    promise.on('reject', function (err) {\n      assert.ok(err instanceof Error);\n      called++;\n    });\n\n    assert.equal(2, called);\n    done()\n  });\n\n  describe('onResolve()', function () {\n    it('from constructor works', function (done) {\n      var called = 0;\n\n      var promise = new MPromise(function (err) {\n        assert.ok(err instanceof Error);\n        called++;\n      });\n\n      promise.reject(new Error('dawg'));\n\n      assert.equal(1, called);\n      done();\n    });\n\n    it('after fulfill()', function (done) {\n      var promise = new MPromise()\n        , called = 0;\n\n      promise.fulfill('woot');\n\n      promise.onResolve(function (err, data) {\n        assert.equal(data, 'woot');\n        called++;\n      });\n\n      promise.onResolve(function (err) {\n        assert.strictEqual(err, null);\n        called++;\n      });\n\n      assert.equal(2, called);\n      done();\n    })\n  });\n\n  describe('onFulfill shortcut', function () {\n    it('works', function (done) {\n      var promise = new MPromise()\n        , called = 0;\n\n      promise.onFulfill(function (woot) {\n        assert.strictEqual(woot, undefined);\n        called++;\n      });\n\n      promise.fulfill();\n\n      assert.equal(1, called);\n      done();\n    });\n  });\n\n  describe('onReject shortcut', function () {\n    it('works', function (done) {\n      var promise = new MPromise()\n        , called = 0;\n\n      promise.onReject(function (err) {\n        assert.ok(err instanceof Error);\n        called++;\n      });\n\n      promise.reject(new Error);\n      assert.equal(1, called);\n      done();\n    })\n  });\n\n  describe('return values', function () {\n    it('on()', function (done) {\n      var promise = new MPromise();\n      assert.ok(promise.on('jump', function () {}) instanceof MPromise);\n      done()\n    });\n\n    it('onFulfill()', function (done) {\n      var promise = new MPromise();\n      assert.ok(promise.onFulfill(function () {}) instanceof MPromise);\n      done();\n    });\n    it('onReject()', function (done) {\n      var promise = new MPromise();\n      assert.ok(promise.onReject(function () {}) instanceof MPromise);\n      done();\n    });\n    it('onResolve()', function (done) {\n      var promise = new MPromise();\n      assert.ok(promise.onResolve(function () {}) instanceof MPromise);\n      done();\n    })\n  });\n\n  describe('casting errors', function () {\n    describe('reject()', function () {\n      it('does not cast arguments to Error', function (done) {\n        var p = new MPromise(function (err) {\n          assert.equal(3, err);\n          done();\n        });\n\n        p.reject(3);\n      })\n    })\n  });\n\n  describe('then', function () {\n    describe('catching', function () {\n      it('should not catch returned promise fulfillments', function (done) {\n        var errorSentinal\n          , p = new MPromise;\n        p.then(function () { throw errorSentinal = new Error(\"boo!\") });\n\n        p.fulfill();\n        done();\n      });\n\n\n      it('should not catch returned promise fulfillments even async', function (done) {\n        var errorSentinal\n          , p = new MPromise;\n        p.then(function () { throw errorSentinal = new Error(\"boo!\") });\n\n        setTimeout(function () {\n          p.fulfill();\n          done();\n        }, 10);\n      });\n\n\n      it('can be disabled using .end()', function (done) {\n        if (process.version.indexOf('v0.8') == 0) return done();\n        var errorSentinal\n          , overTimeout\n          , domain = require('domain').create();\n\n        domain.once('error', function (err) {\n          assert(err, errorSentinal);\n          clearTimeout(overTimeout);\n          done()\n        });\n\n        domain.run(function () {\n          var p = new MPromise;\n          var p2 = p.then(function () {\n            throw errorSentinal = new Error('shucks')\n          });\n          p2.end();\n\n          p.fulfill();\n        });\n        overTimeout = setTimeout(function () { done(new Error('error was swallowed')); }, 10);\n      });\n\n\n      it('can be disabled using .end() even when async', function (done) {\n        if (process.version.indexOf('v0.10') != 0) return done();\n        var errorSentinal\n          , overTimeout\n          , domain = require('domain').create();\n\n        domain.on('error', function (err) {\n          assert(err, errorSentinal);\n          clearTimeout(overTimeout);\n          done()\n        });\n\n        domain.run(function () {\n          var p = new MPromise;\n          var p2 = p.then(function () {\n            throw errorSentinal = new Error(\"boo!\")\n          });\n          p2.end();\n\n          setTimeout(function () {p.fulfill();}, 10);\n        });\n        overTimeout = setTimeout(function () { done(new Error('error was swallowed')); }, 20);\n      });\n\n\n      it('can be handled using .end() so no throwing', function (done) {\n        var errorSentinal\n          , overTimeout\n          , domain = require('domain').create();\n\n        domain.run(function () {\n          var p = new MPromise;\n          var p2 = p.then(function () {\n            throw errorSentinal = new Error(\"boo!\")\n          });\n          p2.end(function (err) {\n            assert.equal(err, errorSentinal);\n            clearTimeout(overTimeout);\n            done()\n          });\n\n          setTimeout(function () {p.fulfill();}, 10);\n        });\n        overTimeout = setTimeout(function () { done(new Error('error was swallowed')); }, 20);\n      });\n\n    });\n\n    it('persistent', function (done) {\n      var p = new MPromise;\n      v = null;\n\n      function ensure(val) {\n        v = v || val;\n        assert.equal(v, val);\n      }\n\n      function guard() {\n        throw new Error('onReject should not be called');\n      }\n\n      p.then(ensure, guard).end();\n\n      p.fulfill('foo');\n      p.fulfill('bar');\n      p.reject(new Error('baz'));\n\n      p.then(ensure, guard).end();\n\n      setTimeout(done, 0);\n    });\n\n\n    it('accepts multiple completion values', function (done) {\n      var p = new MPromise;\n\n      p.then(function (a, b) {\n        assert.equal(2, arguments.length);\n        assert.equal('hi', a);\n        assert.equal(4, b);\n        done();\n      }, done).end();\n\n      p.fulfill('hi', 4);\n    })\n  });\n\n  describe('fulfill values and splats', function () {\n    it('should handle multiple values', function (done) {\n      var p = new MPromise;\n      p.onFulfill(function (a, b, c) {\n        assert.equal('a', a);\n        assert.equal('b', b);\n        assert.equal('c', c);\n        done();\n      });\n      p.fulfill('a', 'b', 'c');\n    });\n\n    it('should handle multiple values from a then', function (done) {\n      MPromise.fulfilled().then(\n        function () {\n          return MPromise.fulfilled().then(\n            function () {\n              var p = new MPromise;\n              p.fulfill('a', 'b', 'c');\n              return p;\n            }\n          );\n        }\n      ).onFulfill(\n        function (a, b, c) {\n          assert.equal('a', a);\n          assert.equal('b', b);\n          assert.equal('c', c);\n          done();\n        }\n      ).end()\n    });\n\n    it('should work with `fulfilled` convenience method', function (done) {\n      MPromise.fulfilled('a', 'b', 'c').then(function (a, b, c) {\n        assert.equal('a', a);\n        assert.equal('b', b);\n        assert.equal('c', c);\n        done();\n      })\n    });\n  });\n\n\n  describe('end', function () {\n    it(\"should return the promise\", function (done) {\n      var p = new MPromise;\n      var p1 = p.end();\n      assert.equal(p, p1);\n      done();\n    });\n\n\n    it(\"should throw for chain\", function (done) {\n      var p = new MPromise;\n      p.then().then().then().then().end();\n      try {\n        p.reject('bad');\n      } catch (e) {\n        done();\n      }\n    });\n\n\n    it(\"should not throw for chain with reject handler\", function (done) {\n      var p = new MPromise;\n      p.then().then().then().then().end(function () {\n        done();\n      });\n      try {\n        p.reject('bad');\n      } catch (e) {\n        done(e);\n      }\n    });\n  });\n\n\n  describe('chain', function () {\n    it('should propagate fulfillment', function (done) {\n      var varSentinel = {a: 'a'};\n      var p1 = new MPromise;\n      p1.chain(new MPromise(function (err, doc) {\n        assert.equal(doc, varSentinel);\n        done();\n      }));\n      p1.fulfill(varSentinel);\n    });\n\n\n    it('should propagate rejection', function (done) {\n      var e = new Error(\"gaga\");\n      var p1 = new MPromise;\n      p1.chain(new MPromise(function (err) {\n        assert.equal(err, e);\n        done();\n      }));\n      p1.reject(e);\n    });\n\n\n    it('should propagate resolution err', function (done) {\n      var e = new Error(\"gaga\");\n      var p1 = new MPromise;\n      p1.chain(new MPromise(function (err) {\n        assert.equal(err, e);\n        done();\n      }));\n      p1.resolve(e);\n    });\n\n\n    it('should propagate resolution val', function (done) {\n      var varSentinel = {a: 'a'};\n      var p1 = new MPromise;\n      p1.chain(new MPromise(function (err, val) {\n        assert.equal(val, varSentinel);\n        done();\n      }));\n      p1.resolve(null, varSentinel);\n    })\n  });\n\n\n  describe(\"all\", function () {\n    it(\"works\", function (done) {\n      var count = 0;\n      var p = new MPromise;\n      var p2 = p.all(function () {\n        return [\n          (function () {\n            var p = new MPromise();\n            count++;\n            p.resolve();\n            return p;\n          })()\n          , (function () {\n            var p = new MPromise();\n            count++;\n            p.resolve();\n            return p;\n          })()\n        ];\n      });\n      p2.then(function () {\n        assert.equal(count, 2);\n        done();\n      });\n      p.resolve();\n    });\n\n\n    it(\"handles rejects\", function (done) {\n      var count = 0;\n      var p = new MPromise;\n      var p2 = p.all(function () {\n        return [\n          (function () {\n            var p = new MPromise();\n            count++;\n            p.resolve();\n            return p;\n          })()\n          , (function () {\n            count++;\n            throw new Error(\"gaga\");\n          })()\n        ];\n      });\n      p2.onReject(function (err) {\n        assert(err.message, \"gaga\");\n        assert.equal(count, 2);\n        done();\n      });\n      p.resolve();\n    });\n  });\n\n\n  describe(\"deferred\", function () {\n    it(\"works\", function (done) {\n      var d = MPromise.deferred();\n      assert.ok(d.promise instanceof MPromise);\n      assert.ok(d.reject instanceof Function);\n      assert.ok(d.resolve instanceof Function);\n      assert.ok(d.callback instanceof Function);\n      done();\n    });\n  });\n\n\n  describe(\"hook\", function () {\n    it(\"works\", function (done) {\n      var run = 0;\n      var l1 = function (ser, par) {\n        run++;\n        ser();\n        par();\n      };\n      MPromise.hook([l1, l1, l1]).then(function () {\n        assert(run, 3);\n        done();\n      })\n\n    });\n\n\n    it(\"works with async serial hooks\", function (done) {\n      this.timeout(800);\n      var run = 0;\n      var l1 = function (ser, par) {\n        run++;\n        setTimeout(function () {ser();}, 200);\n        par();\n      };\n      MPromise.hook([l1, l1, l1]).then(function () {\n        assert(run, 3);\n        done();\n      })\n    });\n\n\n    it(\"works with async parallel hooks\", function (done) {\n      this.timeout(400);\n      var run = 0;\n      var l1 = function (ser, par) {\n        run++;\n        ser();\n        setTimeout(function () {par();}, 200);\n      };\n      MPromise.hook([l1, l1, l1]).then(function () {\n        assert(run, 3);\n        done();\n      })\n    });\n\n\n    it(\"catches errors in hook logic\", function (done) {\n      var run = 0;\n      var l1 = function (ser, par) {\n        run++;\n        ser();\n        par();\n      };\n      var l2 = function (ser, par) {\n        run++;\n        ser();\n        par();\n        throw new Error(\"err\")\n      };\n      MPromise.hook([l1, l2, l1]).end(function (err) {\n        assert(run, 2);\n        done();\n      });\n    });\n  });\n});\n"]}