{"version":3,"sources":["unsafe.js"],"names":[],"mappings":"AAAA,IACE,KAAQ,QAAQ,IAAR,CADV;AAAA,IAEE,OAAQ,QAAQ,MAAR,EAAgB,IAF1B;AAAA,IAGE,QAAQ,QAAQ,SAAR,CAHV;;AAKA,IAAI,SAAS,MAAM,GAAnB;AACA,MAAM,WAAN,CAAkB,EAAE,eAAe,MAAjB,EAAlB,EAA6C,UAAU,GAAV,EAAe,IAAf,EAAqB;AAChE,MAAI,GAAJ,EAAS;AACP,UAAM,GAAN,CAAU,GAAV,EAAe,MAAM,IAArB;AACA;AACD;;AAED,MAAI;AACF;AACA,QAAI,KAAK,GAAG,QAAH,CAAY,KAAK,IAAL,EAAW,wBAAX,CAAZ,EAAkD,GAAlD,CAAT;AACA,OAAG,SAAH,CAAa,EAAb;;AAEA;AACA,QAAI,gBAAgB,KAAK,SAAL,EAAgB,WAAhB,CAApB;AACA;AACA,QAAI,gBAAgB,KAAK,IAAL,EAAW,kBAAX,CAApB;;AAEA;AACA,OAAG,WAAH,CAAe,aAAf,EAA8B,aAA9B,EAA6C,KAA7C;;AAEA,UAAM,GAAN,CAAU,IAAV,EAAgB,MAAM,IAAtB;AACD,GAdD,CAcE,OAAO,CAAP,EAAU;AACV,UAAM,GAAN,CAAU,EAAE,QAAF,EAAV,EAAwB,MAAM,IAA9B;AACD;AACF,CAvBD","file":"unsafe-compiled.js","sourcesContent":["var\n  fs    = require('fs'),\n  join  = require('path').join,\n  spawn = require('./spawn');\n\nvar unsafe = spawn.arg;\nspawn.tmpFunction({ unsafeCleanup: unsafe }, function (err, name) {\n  if (err) {\n    spawn.err(err, spawn.exit);\n    return;\n  }\n\n  try {\n    // file that should be removed\n    var fd = fs.openSync(join(name, 'should-be-removed.file'), 'w');\n    fs.closeSync(fd);\n\n    // in tree source\n    var symlinkSource = join(__dirname, 'symlinkme');\n    // testing target\n    var symlinkTarget = join(name, 'symlinkme-target');\n\n    // symlink that should be removed but the contents should be preserved.\n    fs.symlinkSync(symlinkSource, symlinkTarget, 'dir');\n\n    spawn.out(name, spawn.exit);\n  } catch (e) {\n    spawn.err(e.toString(), spawn.exit);\n  }\n});\n"]}