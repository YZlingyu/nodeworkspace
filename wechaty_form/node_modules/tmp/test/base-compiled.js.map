{"version":3,"sources":["base.js"],"names":[],"mappings":"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","file":"base-compiled.js","sourcesContent":["var\n  assert = require('assert'),\n  path   = require('path'),\n  exec   = require('child_process').exec,\n  tmp    = require('../lib/tmp');\n\n// make sure that we do not test spam the global tmp\ntmp.TMP_DIR = './tmp';\n\n\nfunction _spawnTestWithError(testFile, params, cb) {\n  _spawnTest(true, testFile, params, cb);\n}\n\nfunction _spawnTestWithoutError(testFile, params, cb) {\n  _spawnTest(false, testFile, params, cb);\n}\n\nfunction _spawnTest(passError, testFile, params, cb) {\n  var\n    node_path = process.argv[0],\n    command = [ node_path, path.join(__dirname, testFile) ].concat(params).join(' ');\n\n  exec(command, function _execDone(err, stdout, stderr) {\n    if (passError) {\n      if (err) {\n        return cb(err);\n      } else if (stderr.length > 0) {\n        return cb(stderr.toString());\n      }\n    }\n\n    return cb(null, stdout.toString());\n  });\n}\n\nfunction _testStat(stat, mode) {\n  assert.equal(stat.uid, process.getuid(), 'should have the same UID');\n  assert.equal(stat.gid, process.getgid(), 'should have the same GUID');\n  assert.equal(stat.mode, mode);\n}\n\nfunction _testPrefix(prefix) {\n  return function _testPrefixGenerated(err, name) {\n    assert.equal(path.basename(name).slice(0, prefix.length), prefix, 'should have the provided prefix');\n  };\n}\n\nfunction _testPrefixSync(prefix) {\n  return function _testPrefixGeneratedSync(result) {\n    if (result instanceof Error) {\n      throw result;\n    }\n    _testPrefix(prefix)(null, result.name, result.fd);\n  };\n}\n\nfunction _testPostfix(postfix) {\n  return function _testPostfixGenerated(err, name) {\n    assert.equal(name.slice(name.length - postfix.length, name.length), postfix, 'should have the provided postfix');\n  };\n}\n\nfunction _testPostfixSync(postfix) {\n  return function _testPostfixGeneratedSync(result) {\n    if (result instanceof Error) {\n      throw result;\n    }\n    _testPostfix(postfix)(null, result.name, result.fd);\n  };\n}\n\nfunction _testKeep(type, keep, cb) {\n  _spawnTestWithError('keep.js', [ type, keep ], cb);\n}\n\nfunction _testKeepSync(type, keep, cb) {\n  _spawnTestWithError('keep-sync.js', [ type, keep ], cb);\n}\n\nfunction _testGraceful(type, graceful, cb) {\n  _spawnTestWithoutError('graceful.js', [ type, graceful ], cb);\n}\n\nfunction _testGracefulSync(type, graceful, cb) {\n  _spawnTestWithoutError('graceful-sync.js', [ type, graceful ], cb);\n}\n\nfunction _assertName(err, name) {\n  assert.isString(name);\n  assert.isNotZero(name.length, 'an empty string is not a valid name');\n}\n\nfunction _assertNameSync(result) {\n  if (result instanceof Error) {\n    throw result;\n  }\n  var name = typeof(result) == 'string' ? result : result.name;\n  _assertName(null, name);\n}\n\nfunction _testName(expected){\n  return function _testNameGenerated(err, name) {\n    assert.equal(expected, name, 'should have the provided name');\n  };\n}\n\nfunction _testNameSync(expected){\n  return function _testNameGeneratedSync(result) {\n    if (result instanceof Error) {\n      throw result;\n    }\n    _testName(expected)(null, result.name, result.fd);\n  };\n}\n\nfunction _testUnsafeCleanup(unsafe, cb) {\n  _spawnTestWithoutError('unsafe.js', [ 'dir', unsafe ], cb);\n}\n\nfunction _testIssue62(cb) {\n  _spawnTestWithoutError('issue62.js', [], cb);\n}\n\nfunction _testUnsafeCleanupSync(unsafe, cb) {\n  _spawnTestWithoutError('unsafe-sync.js', [ 'dir', unsafe ], cb);\n}\n\nfunction _testIssue62Sync(cb) {\n  _spawnTestWithoutError('issue62-sync.js', [], cb);\n}\n\nmodule.exports.testStat = _testStat;\nmodule.exports.testPrefix = _testPrefix;\nmodule.exports.testPrefixSync = _testPrefixSync;\nmodule.exports.testPostfix = _testPostfix;\nmodule.exports.testPostfixSync = _testPostfixSync;\nmodule.exports.testKeep = _testKeep;\nmodule.exports.testKeepSync = _testKeepSync;\nmodule.exports.testGraceful = _testGraceful;\nmodule.exports.testGracefulSync = _testGracefulSync;\nmodule.exports.assertName = _assertName;\nmodule.exports.assertNameSync = _assertNameSync;\nmodule.exports.testName = _testName;\nmodule.exports.testNameSync = _testNameSync;\nmodule.exports.testUnsafeCleanup = _testUnsafeCleanup;\nmodule.exports.testIssue62 = _testIssue62;\nmodule.exports.testUnsafeCleanupSync = _testUnsafeCleanupSync;\nmodule.exports.testIssue62Sync = _testIssue62Sync;\n"]}