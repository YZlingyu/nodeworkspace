{"version":3,"sources":["utils-compiled.js"],"names":[],"mappings":"AAAA;;AAEA,IAAI,aAAa,QAAQ,cAAR,EAAwB,UAAzC;AAAA,IACI,iBAAiB,QAAQ,mBAAR,CADrB;AAAA,IAEI,qBAAqB,QAAQ,cAAR,EAAwB,cAFjD;;AAIA,IAAI,eAAe,UAAU,GAAV,EAAe;AAChC,MAAI,OAAO,EAAX;AACA,OAAK,IAAI,IAAT,IAAiB,GAAjB,EAAsB,KAAK,IAAL,IAAa,IAAI,IAAJ,CAAb;AACtB,SAAO,IAAP;AACD,CAJD;;AAMA;AACA,IAAI,oBAAoB,UAAU,OAAV,EAAmB;AACzC,MAAI,IAAI,IAAR;AACA,MAAI,QAAQ,cAAZ,EAA4B;AAC1B,QAAI,QAAQ,cAAZ;AACD,GAFD,MAEO;AACL,WAAO,OAAP;AACD;;AAED,MAAI,aAAa,cAAjB,EAAiC;AAC/B,YAAQ,cAAR,GAAyB,IAAI,kBAAJ,CAAuB,EAAE,IAAzB,EAA+B,EAAE,IAAjC,EAAuC,EAAE,qBAAqB,EAAE,mBAAzB,EAAvC,CAAzB;AACD,GAFD,MAEO,IAAI,OAAO,CAAP,IAAY,QAAhB,EAA0B;AAC/B,YAAQ,cAAR,GAAyB,IAAI,kBAAJ,CAAuB,CAAvB,CAAzB;AACD,GAFM,MAEA,IAAI,KAAK,EAAE,aAAa,cAAf,CAAL,IAAuC,OAAO,CAAP,IAAY,QAAvD,EAAiE;AACtE,QAAI,OAAO,EAAE,IAAF,IAAU,EAAE,UAAvB;AACA,QAAI,QAAQ,OAAO,IAAP,IAAe,QAA3B,EAAqC;AACnC,cAAQ,cAAR,GAAyB,IAAI,kBAAJ,CAAuB,IAAvB,EAA6B,EAAE,IAA/B,EAAqC,EAAE,qBAAqB,EAAE,mBAAzB,EAArC,CAAzB;AACD;AACF;;AAED,SAAO,OAAP;AACD,CApBD;;AAsBA;AACA,IAAI,oBAAoB,UAAU,GAAV,EAAe,IAAf,EAAqB,KAArB,EAA4B;AAClD,SAAO,cAAP,CAAsB,GAAtB,EAA2B,IAA3B,EAAiC;AAC/B,gBAAY,IADmB;AAE/B,SAAK,YAAY;AACf,aAAO,KAAP;AACD;AAJ8B,GAAjC;AAMD,CAPD;;AASA,IAAI,kBAAkB,QAAQ,eAAR,GAA0B,UAAU,aAAV,EAAyB;AACvE,MAAI,QAAQ,CAAC,KAAK,aAAN,EAAqB,WAArB,EAAZ;;AAEA,UAAQ,KAAR;AACE,SAAK,WAAL;AACA,SAAK,KAAL;AACA,SAAK,GAAL;AACE,aAAO,CAAP;AACF,SAAK,YAAL;AACA,SAAK,MAAL;AACA,SAAK,IAAL;AACE,aAAO,CAAC,CAAR;AACF;AACE,YAAM,IAAI,KAAJ,CAAU,8CAA8C,yCAA9C,GAA0F,uCAApG,CAAN;AAVJ;AAYD,CAfD;;AAiBA,IAAI,uBAAuB,QAAQ,oBAAR,GAA+B,UAAU,SAAV,EAAqB;AAC7E,MAAI,UAAU,EAAd;AACA,MAAI,aAAa,IAAjB,EAAuB,OAAO,IAAP;AACvB,MAAI,MAAM,OAAN,CAAc,SAAd,CAAJ,EAA8B;AAC5B,QAAI,UAAU,MAAV,KAAqB,CAAzB,EAA4B;AAC1B,aAAO,IAAP;AACD;;AAED,SAAK,IAAI,IAAI,CAAb,EAAgB,IAAI,UAAU,MAA9B,EAAsC,GAAtC,EAA2C;AACzC,UAAI,UAAU,CAAV,EAAa,WAAb,IAA4B,MAAhC,EAAwC;AACtC,gBAAQ,UAAU,CAAV,CAAR,IAAwB,CAAxB;AACD,OAFD,MAEO;AACL,gBAAQ,UAAU,CAAV,EAAa,CAAb,CAAR,IAA2B,gBAAgB,UAAU,CAAV,EAAa,CAAb,CAAhB,CAA3B;AACD;AACF;AACF,GAZD,MAYO,IAAI,aAAa,IAAb,IAAqB,OAAO,SAAP,IAAoB,QAA7C,EAAuD;AAC5D,cAAU,SAAV;AACD,GAFM,MAEA,IAAI,OAAO,SAAP,IAAoB,QAAxB,EAAkC;AACvC,YAAQ,SAAR,IAAqB,CAArB;AACD,GAFM,MAEA;AACL,UAAM,IAAI,KAAJ,CAAU,8CAA8C,8EAAxD,CAAN;AACD;;AAED,SAAO,OAAP;AACD,CAxBD;;AA0BA,IAAI,sBAAsB,SAAS,mBAAT,CAA6B,cAA7B,EAA6C;AACrE,MAAI,aAAa,OAAO,cAAxB,EAAwC;AACtC,UAAM,MAAM,kCAAN,CAAN;AACD;;AAED,MAAI,CAAC,cAAD,IAAmB,eAAe,OAAf,CAAuB,IAAvB,KAAgC,CAAC,CAAxD,EAA2D;AACzD,UAAM,MAAM,kCAAN,CAAN;AACD;;AAED,MAAI,eAAe,OAAf,CAAuB,GAAvB,KAA+B,CAAC,CAAhC,IAAqC,eAAe,KAAf,CAAqB,4BAArB,KAAsD,IAA/F,EAAqG;AACnG,UAAM,MAAM,uCAAN,CAAN;AACD;;AAED,MAAI,eAAe,KAAf,CAAqB,SAArB,KAAmC,IAAvC,EAA6C;AAC3C,UAAM,MAAM,iDAAN,CAAN;AACD;;AAED;AACA,MAAI,CAAC,CAAC,CAAC,eAAe,OAAf,CAAuB,MAAvB,CAAP,EAAuC;AACrC,UAAM,IAAI,KAAJ,CAAU,kDAAV,CAAN;AACD;AACF,CArBD;;AAuBA,IAAI,iBAAiB,UAAU,QAAV,EAAoB,GAApB,EAAyB,MAAzB,EAAiC,MAAjC,EAAyC;AAC5D,MAAI;AACF,QAAI,YAAY,IAAhB,EAAsB;AACtB,QAAI,QAAJ,EAAc;AACZ,aAAO,SAAS,SAAS,GAAT,EAAc,MAAd,EAAsB,MAAtB,CAAT,GAAyC,SAAS,GAAT,EAAc,MAAd,CAAhD;AACD;AACF,GALD,CAKE,OAAO,GAAP,EAAY;AACZ,YAAQ,QAAR,CAAiB,YAAY;AAC3B,YAAM,GAAN;AACD,KAFD;AAGA,WAAO,KAAP;AACD;;AAED,SAAO,IAAP;AACD,CAdD;;AAgBA;;;;;AAKA,IAAI,UAAU,UAAU,KAAV,EAAiB;AAC7B,MAAI,iBAAiB,KAArB,EAA4B,OAAO,KAAP;;AAE5B,MAAI,MAAM,MAAM,GAAN,IAAa,MAAM,MAAnB,IAA6B,MAAM,UAAnC,IAAiD,KAA3D;AACA,MAAI,IAAI,WAAW,MAAX,CAAkB,EAAE,SAAS,GAAX,EAAgB,QAAQ,IAAxB,EAAlB,CAAR;;AAEA;AACA,MAAI,OAAO,OAAO,KAAP,IAAgB,QAAhB,GAA2B,OAAO,IAAP,CAAY,KAAZ,CAA3B,GAAgD,EAA3D;;AAEA,OAAK,IAAI,IAAI,CAAb,EAAgB,IAAI,KAAK,MAAzB,EAAiC,GAAjC,EAAsC;AACpC,QAAI;AACF,QAAE,KAAK,CAAL,CAAF,IAAa,MAAM,KAAK,CAAL,CAAN,CAAb;AACD,KAFD,CAEE,OAAO,GAAP,EAAY;AACZ;AACD;AACF;;AAED,SAAO,CAAP;AACD,CAlBD;;AAoBA;;;AAGA,IAAI,qBAAqB,SAAS,kBAAT,CAA4B,IAA5B,EAAkC;AACzD,MAAI,YAAY,IAAhB;;AAEA,MAAI,OAAO,IAAP,IAAe,QAAnB,EAA6B;AAC3B,gBAAY,IAAZ;AACD,GAFD,MAEO,IAAI,MAAM,OAAN,CAAc,IAAd,CAAJ,EAAyB;AAC9B,gBAAY,EAAZ;;AAEA,SAAK,OAAL,CAAa,UAAU,KAAV,EAAiB;AAC5B,gBAAU,KAAV,IAAmB,CAAnB;AACD,KAFD;AAGD,GANM,MAMA,IAAI,QAAQ,IAAR,IAAgB,OAAO,IAAP,IAAe,QAAnC,EAA6C;AAClD,gBAAY,EAAZ;AACA,SAAK,IAAI,IAAT,IAAiB,IAAjB,EAAuB;AACrB,gBAAU,IAAV,IAAkB,KAAK,IAAL,CAAlB;AACD;AACF;;AAED,SAAO,SAAP;AACD,CAnBD;;AAqBA;;;;;;AAMA,IAAI,oBAAoB,UAAU,WAAV,EAAuB;AAC7C,MAAI,YAAY,EAAhB;AACA,MAAI,UAAU,EAAd;AACA,MAAI,IAAJ;;AAEA;AACA,MAAI,YAAY,OAAO,WAAvB,EAAoC;AAClC;AACA,YAAQ,IAAR,CAAa,cAAc,GAAd,GAAoB,CAAjC;AACA,cAAU,WAAV,IAAyB,CAAzB;AACD,GAJD,MAIO,IAAI,MAAM,OAAN,CAAc,WAAd,CAAJ,EAAgC;AACrC,gBAAY,OAAZ,CAAoB,UAAU,CAAV,EAAa;AAC/B,UAAI,YAAY,OAAO,CAAvB,EAA0B;AACxB;AACA,gBAAQ,IAAR,CAAa,IAAI,GAAJ,GAAU,CAAvB;AACA,kBAAU,CAAV,IAAe,CAAf;AACD,OAJD,MAIO,IAAI,MAAM,OAAN,CAAc,CAAd,CAAJ,EAAsB;AAC3B;AACA,gBAAQ,IAAR,CAAa,EAAE,CAAF,IAAO,GAAP,IAAc,EAAE,CAAF,KAAQ,CAAtB,CAAb;AACA,kBAAU,EAAE,CAAF,CAAV,IAAkB,EAAE,CAAF,KAAQ,CAA1B;AACD,OAJM,MAIA,IAAI,SAAS,CAAT,CAAJ,EAAiB;AACtB;AACA,eAAO,OAAO,IAAP,CAAY,CAAZ,CAAP;AACA,aAAK,OAAL,CAAa,UAAU,CAAV,EAAa;AACxB,kBAAQ,IAAR,CAAa,IAAI,GAAJ,GAAU,EAAE,CAAF,CAAvB;AACA,oBAAU,CAAV,IAAe,EAAE,CAAF,CAAf;AACD,SAHD;AAID,OAPM,MAOA;AACL;AACD;AACF,KAnBD;AAoBD,GArBM,MAqBA,IAAI,SAAS,WAAT,CAAJ,EAA2B;AAChC;AACA,WAAO,OAAO,IAAP,CAAY,WAAZ,CAAP;AACA,SAAK,OAAL,CAAa,UAAU,GAAV,EAAe;AAC1B,cAAQ,IAAR,CAAa,MAAM,GAAN,GAAY,YAAY,GAAZ,CAAzB;AACA,gBAAU,GAAV,IAAiB,YAAY,GAAZ,CAAjB;AACD,KAHD;AAID;;AAED,SAAO;AACL,UAAM,QAAQ,IAAR,CAAa,GAAb,CADD,EACoB,MAAM,IAD1B,EACgC,WAAW;AAD3C,GAAP;AAGD,CA3CD;;AA6CA,IAAI,WAAW,QAAQ,QAAR,GAAmB,UAAU,GAAV,EAAe;AAC/C,SAAO,qBAAqB,OAAO,SAAP,CAAiB,QAAjB,CAA0B,IAA1B,CAA+B,GAA/B,CAA5B;AACD,CAFD;;AAIA,IAAI,eAAe,UAAU,WAAV,EAAuB,OAAvB,EAAgC;AACjD,MAAI,eAAe,EAAnB;AACA,cAAY,OAAZ,CAAoB,UAAU,CAAV,EAAa;AAC/B,iBAAa,CAAb,IAAkB,QAAQ,CAAR,CAAlB;AACD,GAFD;;AAIA,SAAO,YAAP;AACD,CAPD;;AASA,IAAI,kBAAkB,UAAU,OAAV,EAAmB,OAAnB,EAA4B,OAA5B,EAAqC;AACzD,OAAK,IAAI,IAAT,IAAiB,OAAjB,EAA0B;AACxB,QAAI,QAAQ,IAAR,KAAiB,IAArB,EAA2B,QAAQ,IAAR,IAAgB,QAAQ,IAAR,CAAhB;AAC5B;;AAED,SAAO,OAAP;AACD,CAND;;AAQA,IAAI,eAAe,UAAU,MAAV,EAAkB,MAAlB,EAA0B;AAC3C,OAAK,IAAI,IAAT,IAAiB,MAAjB,EAAyB;AACvB,WAAO,IAAP,IAAe,OAAO,IAAP,CAAf;AACD;;AAED,SAAO,MAAP;AACD,CAND;;AAQA;AACA,IAAI,mBAAmB,UAAU,MAAV,EAAkB,MAAlB,EAA0B;AAC/C,MAAI,eAAe;AACjB;AACA,aAAS,IAFQ,EAEF,UAAU,KAFR,EAEe,eAAe,oBAF9B,EAEoD,UAAU,KAF9D;AAGjB,eAAW,MAHM,EAGE,WAAW,YAHb;AAIjB;AACA,uBAAmB,eALF,EAKmB,oBAAoB,mBALvC;AAMjB;AACA,kBAAc,SAPG,EAOQ,WAAW,SAPnB,EAO8B,gCAAgC,mBAP9D;AAQjB,4BAAwB,gCARP;AASjB;AACA,2BAAuB;AAVN,GAAnB;;AAaA,OAAK,IAAI,IAAT,IAAiB,MAAjB,EAAyB;AACvB,QAAI,aAAa,IAAb,CAAJ,EAAwB;AACtB,aAAO,aAAa,IAAb,CAAP,IAA6B,OAAO,IAAP,CAA7B;AACD,KAFD,MAEO;AACL,aAAO,IAAP,IAAe,OAAO,IAAP,CAAf;AACD;AACF;;AAED,SAAO,MAAP;AACD,CAvBD;;AAyBA,IAAI,gBAAgB,UAAU,OAAV,EAAmB,KAAnB,EAA0B;AAC5C,MAAI,gBAAgB,EAApB;;AAEA,OAAK,IAAI,IAAT,IAAiB,OAAjB,EAA0B;AACxB,QAAI,MAAM,OAAN,CAAc,IAAd,KAAuB,CAAC,CAA5B,EAA+B,cAAc,IAAd,IAAsB,QAAQ,IAAR,CAAtB;AAChC;;AAED;AACA,SAAO,aAAP;AACD,CATD;;AAWA;AACA,IAAI,SAAS,OAAO,MAAP,GAAgB,OAAO,MAAvB,GAAgC,SAAS,MAAT,CAAgB,MAAhB,EAAwB;AACnE,MAAI,WAAW,SAAX,IAAwB,WAAW,IAAvC,EAA6C;AAC3C,UAAM,IAAI,SAAJ,CAAc,yCAAd,CAAN;AACD;;AAED,MAAI,KAAK,OAAO,MAAP,CAAT;AACA,OAAK,IAAI,IAAI,CAAb,EAAgB,IAAI,UAAU,MAA9B,EAAsC,GAAtC,EAA2C;AACzC,QAAI,aAAa,UAAU,CAAV,CAAjB;AACA,QAAI,eAAe,SAAf,IAA4B,eAAe,IAA/C,EAAqD;AACnD;AACD;;AAED,QAAI,YAAY,OAAO,IAAP,CAAY,OAAO,UAAP,CAAZ,CAAhB;AACA,SAAK,IAAI,YAAY,CAAhB,EAAmB,MAAM,UAAU,MAAxC,EAAgD,YAAY,GAA5D,EAAiE,WAAjE,EAA8E;AAC5E,UAAI,UAAU,UAAU,SAAV,CAAd;AACA,UAAI,OAAO,OAAO,wBAAP,CAAgC,UAAhC,EAA4C,OAA5C,CAAX;AACA,UAAI,SAAS,SAAT,IAAsB,KAAK,UAA/B,EAA2C;AACzC,WAAG,OAAH,IAAc,WAAW,OAAX,CAAd;AACD;AACF;AACF;AACD,SAAO,EAAP;AACD,CAtBD;;AAwBA;AACA,IAAI,mBAAmB,CAAC,GAAD,EAAM,GAAN,EAAW,UAAX,EAAuB,OAAvB,CAAvB;;AAEA;AACA,IAAI,8BAA8B,UAAU,aAAV,EAAyB,aAAzB,EAAwC,IAAxC,EAA8C,iBAA9C,EAAiE;AACjG;AACA,OAAK,IAAI,IAAI,CAAb,EAAgB,IAAI,KAAK,MAAzB,EAAiC,GAAjC,EAAsC;AACpC,QAAI,CAAC,cAAc,KAAK,CAAL,CAAd,CAAD,IAA2B,cAAc,KAAK,CAAL,CAAd,KAA0B,SAAzD,EAAoE;AAClE,oBAAc,KAAK,CAAL,CAAd,IAAyB,cAAc,KAAK,CAAL,CAAd,CAAzB;AACD;AACF;;AAED;AACA,MAAI,CAAC,iBAAL,EAAwB,OAAO,aAAP;;AAExB;AACA,MAAI,QAAQ,KAAZ;AACA,OAAK,IAAI,IAAI,CAAb,EAAgB,IAAI,iBAAiB,MAArC,EAA6C,GAA7C,EAAkD;AAChD,QAAI,cAAc,iBAAiB,CAAjB,CAAd,CAAJ,EAAwC;AACtC,cAAQ,IAAR;AACA;AACD;AACF;;AAED,MAAI,CAAC,KAAL,EAAY;AACV,SAAK,IAAI,IAAI,CAAb,EAAgB,IAAI,iBAAiB,MAArC,EAA6C,GAA7C,EAAkD;AAChD,UAAI,cAAc,iBAAiB,CAAjB,CAAd,CAAJ,EAAwC;AACtC,sBAAc,iBAAiB,CAAjB,CAAd,IAAqC,cAAc,iBAAiB,CAAjB,CAAd,CAArC;AACD;AACF;AACF;;AAED,SAAO,aAAP;AACD,CA7BD;;AA+BA,QAAQ,aAAR,GAAwB,aAAxB;AACA,QAAQ,YAAR,GAAuB,YAAvB;AACA,QAAQ,gBAAR,GAA2B,gBAA3B;AACA,QAAQ,YAAR,GAAuB,YAAvB;AACA,QAAQ,iBAAR,GAA4B,iBAA5B;AACA,QAAQ,mBAAR,GAA8B,mBAA9B;AACA,QAAQ,OAAR,GAAkB,OAAlB;AACA,QAAQ,oBAAR,GAA+B,oBAA/B;AACA,QAAQ,iBAAR,GAA4B,iBAA5B;AACA,QAAQ,kBAAR,GAA6B,kBAA7B;AACA,QAAQ,cAAR,GAAyB,cAAzB;AACA,QAAQ,eAAR,GAA0B,eAA1B;AACA,QAAQ,QAAR,GAAmB,QAAnB;AACA,QAAQ,YAAR,GAAuB,YAAvB;AACA,QAAQ,UAAR,GAAqB,gBAArB;AACA,QAAQ,MAAR,GAAiB,MAAjB;AACA,QAAQ,2BAAR,GAAsC,2BAAtC;AACA,QAAQ,iBAAR,GAA4B,iBAA5B;;AAEA","file":"utils-compiled-compiled.js","sourcesContent":["\"use strict\";\n\nvar MongoError = require('mongodb-core').MongoError,\n    ReadPreference = require('./read_preference'),\n    CoreReadPreference = require('mongodb-core').ReadPreference;\n\nvar shallowClone = function (obj) {\n  var copy = {};\n  for (var name in obj) copy[name] = obj[name];\n  return copy;\n};\n\n// Figure out the read preference\nvar getReadPreference = function (options) {\n  var r = null;\n  if (options.readPreference) {\n    r = options.readPreference;\n  } else {\n    return options;\n  }\n\n  if (r instanceof ReadPreference) {\n    options.readPreference = new CoreReadPreference(r.mode, r.tags, { maxStalenessSeconds: r.maxStalenessSeconds });\n  } else if (typeof r == 'string') {\n    options.readPreference = new CoreReadPreference(r);\n  } else if (r && !(r instanceof ReadPreference) && typeof r == 'object') {\n    var mode = r.mode || r.preference;\n    if (mode && typeof mode == 'string') {\n      options.readPreference = new CoreReadPreference(mode, r.tags, { maxStalenessSeconds: r.maxStalenessSeconds });\n    }\n  }\n\n  return options;\n};\n\n// Set simple property\nvar getSingleProperty = function (obj, name, value) {\n  Object.defineProperty(obj, name, {\n    enumerable: true,\n    get: function () {\n      return value;\n    }\n  });\n};\n\nvar formatSortValue = exports.formatSortValue = function (sortDirection) {\n  var value = (\"\" + sortDirection).toLowerCase();\n\n  switch (value) {\n    case 'ascending':\n    case 'asc':\n    case '1':\n      return 1;\n    case 'descending':\n    case 'desc':\n    case '-1':\n      return -1;\n    default:\n      throw new Error(\"Illegal sort clause, must be of the form \" + \"[['field1', '(ascending|descending)'], \" + \"['field2', '(ascending|descending)']]\");\n  }\n};\n\nvar formattedOrderClause = exports.formattedOrderClause = function (sortValue) {\n  var orderBy = {};\n  if (sortValue == null) return null;\n  if (Array.isArray(sortValue)) {\n    if (sortValue.length === 0) {\n      return null;\n    }\n\n    for (var i = 0; i < sortValue.length; i++) {\n      if (sortValue[i].constructor == String) {\n        orderBy[sortValue[i]] = 1;\n      } else {\n        orderBy[sortValue[i][0]] = formatSortValue(sortValue[i][1]);\n      }\n    }\n  } else if (sortValue != null && typeof sortValue == 'object') {\n    orderBy = sortValue;\n  } else if (typeof sortValue == 'string') {\n    orderBy[sortValue] = 1;\n  } else {\n    throw new Error(\"Illegal sort clause, must be of the form \" + \"[['field1', '(ascending|descending)'], ['field2', '(ascending|descending)']]\");\n  }\n\n  return orderBy;\n};\n\nvar checkCollectionName = function checkCollectionName(collectionName) {\n  if ('string' !== typeof collectionName) {\n    throw Error(\"collection name must be a String\");\n  }\n\n  if (!collectionName || collectionName.indexOf('..') != -1) {\n    throw Error(\"collection names cannot be empty\");\n  }\n\n  if (collectionName.indexOf('$') != -1 && collectionName.match(/((^\\$cmd)|(oplog\\.\\$main))/) == null) {\n    throw Error(\"collection names must not contain '$'\");\n  }\n\n  if (collectionName.match(/^\\.|\\.$/) != null) {\n    throw Error(\"collection names must not start or end with '.'\");\n  }\n\n  // Validate that we are not passing 0x00 in the colletion name\n  if (!!~collectionName.indexOf(\"\\x00\")) {\n    throw new Error(\"collection names cannot contain a null character\");\n  }\n};\n\nvar handleCallback = function (callback, err, value1, value2) {\n  try {\n    if (callback == null) return;\n    if (callback) {\n      return value2 ? callback(err, value1, value2) : callback(err, value1);\n    }\n  } catch (err) {\n    process.nextTick(function () {\n      throw err;\n    });\n    return false;\n  }\n\n  return true;\n};\n\n/**\n * Wrap a Mongo error document in an Error instance\n * @ignore\n * @api private\n */\nvar toError = function (error) {\n  if (error instanceof Error) return error;\n\n  var msg = error.err || error.errmsg || error.errMessage || error;\n  var e = MongoError.create({ message: msg, driver: true });\n\n  // Get all object keys\n  var keys = typeof error == 'object' ? Object.keys(error) : [];\n\n  for (var i = 0; i < keys.length; i++) {\n    try {\n      e[keys[i]] = error[keys[i]];\n    } catch (err) {\n      // continue\n    }\n  }\n\n  return e;\n};\n\n/**\n * @ignore\n */\nvar normalizeHintField = function normalizeHintField(hint) {\n  var finalHint = null;\n\n  if (typeof hint == 'string') {\n    finalHint = hint;\n  } else if (Array.isArray(hint)) {\n    finalHint = {};\n\n    hint.forEach(function (param) {\n      finalHint[param] = 1;\n    });\n  } else if (hint != null && typeof hint == 'object') {\n    finalHint = {};\n    for (var name in hint) {\n      finalHint[name] = hint[name];\n    }\n  }\n\n  return finalHint;\n};\n\n/**\n * Create index name based on field spec\n *\n * @ignore\n * @api private\n */\nvar parseIndexOptions = function (fieldOrSpec) {\n  var fieldHash = {};\n  var indexes = [];\n  var keys;\n\n  // Get all the fields accordingly\n  if ('string' == typeof fieldOrSpec) {\n    // 'type'\n    indexes.push(fieldOrSpec + '_' + 1);\n    fieldHash[fieldOrSpec] = 1;\n  } else if (Array.isArray(fieldOrSpec)) {\n    fieldOrSpec.forEach(function (f) {\n      if ('string' == typeof f) {\n        // [{location:'2d'}, 'type']\n        indexes.push(f + '_' + 1);\n        fieldHash[f] = 1;\n      } else if (Array.isArray(f)) {\n        // [['location', '2d'],['type', 1]]\n        indexes.push(f[0] + '_' + (f[1] || 1));\n        fieldHash[f[0]] = f[1] || 1;\n      } else if (isObject(f)) {\n        // [{location:'2d'}, {type:1}]\n        keys = Object.keys(f);\n        keys.forEach(function (k) {\n          indexes.push(k + '_' + f[k]);\n          fieldHash[k] = f[k];\n        });\n      } else {\n        // undefined (ignore)\n      }\n    });\n  } else if (isObject(fieldOrSpec)) {\n    // {location:'2d', type:1}\n    keys = Object.keys(fieldOrSpec);\n    keys.forEach(function (key) {\n      indexes.push(key + '_' + fieldOrSpec[key]);\n      fieldHash[key] = fieldOrSpec[key];\n    });\n  }\n\n  return {\n    name: indexes.join(\"_\"), keys: keys, fieldHash: fieldHash\n  };\n};\n\nvar isObject = exports.isObject = function (arg) {\n  return '[object Object]' == Object.prototype.toString.call(arg);\n};\n\nvar debugOptions = function (debugFields, options) {\n  var finaloptions = {};\n  debugFields.forEach(function (n) {\n    finaloptions[n] = options[n];\n  });\n\n  return finaloptions;\n};\n\nvar decorateCommand = function (command, options, exclude) {\n  for (var name in options) {\n    if (exclude[name] == null) command[name] = options[name];\n  }\n\n  return command;\n};\n\nvar mergeOptions = function (target, source) {\n  for (var name in source) {\n    target[name] = source[name];\n  }\n\n  return target;\n};\n\n// Merge options with translation\nvar translateOptions = function (target, source) {\n  var translations = {\n    // SSL translation options\n    'sslCA': 'ca', 'sslCRL': 'crl', 'sslValidate': 'rejectUnauthorized', 'sslKey': 'key',\n    'sslCert': 'cert', 'sslPass': 'passphrase',\n    // SocketTimeout translation options\n    'socketTimeoutMS': 'socketTimeout', 'connectTimeoutMS': 'connectionTimeout',\n    // Replicaset options\n    'replicaSet': 'setName', 'rs_name': 'setName', 'secondaryAcceptableLatencyMS': 'acceptableLatency',\n    'connectWithNoPrimary': 'secondaryOnlyConnectionAllowed',\n    // Mongos options\n    'acceptableLatencyMS': 'localThresholdMS'\n  };\n\n  for (var name in source) {\n    if (translations[name]) {\n      target[translations[name]] = source[name];\n    } else {\n      target[name] = source[name];\n    }\n  }\n\n  return target;\n};\n\nvar filterOptions = function (options, names) {\n  var filterOptions = {};\n\n  for (var name in options) {\n    if (names.indexOf(name) != -1) filterOptions[name] = options[name];\n  }\n\n  // Filtered options\n  return filterOptions;\n};\n\n// Object.assign method or polyfille\nvar assign = Object.assign ? Object.assign : function assign(target) {\n  if (target === undefined || target === null) {\n    throw new TypeError('Cannot convert first argument to object');\n  }\n\n  var to = Object(target);\n  for (var i = 1; i < arguments.length; i++) {\n    var nextSource = arguments[i];\n    if (nextSource === undefined || nextSource === null) {\n      continue;\n    }\n\n    var keysArray = Object.keys(Object(nextSource));\n    for (var nextIndex = 0, len = keysArray.length; nextIndex < len; nextIndex++) {\n      var nextKey = keysArray[nextIndex];\n      var desc = Object.getOwnPropertyDescriptor(nextSource, nextKey);\n      if (desc !== undefined && desc.enumerable) {\n        to[nextKey] = nextSource[nextKey];\n      }\n    }\n  }\n  return to;\n};\n\n// Write concern keys\nvar writeConcernKeys = ['w', 'j', 'wtimeout', 'fsync'];\n\n// Merge the write concern options\nvar mergeOptionsAndWriteConcern = function (targetOptions, sourceOptions, keys, mergeWriteConcern) {\n  // Mix in any allowed options\n  for (var i = 0; i < keys.length; i++) {\n    if (!targetOptions[keys[i]] && sourceOptions[keys[i]] != undefined) {\n      targetOptions[keys[i]] = sourceOptions[keys[i]];\n    }\n  }\n\n  // No merging of write concern\n  if (!mergeWriteConcern) return targetOptions;\n\n  // Found no write Concern options\n  var found = false;\n  for (var i = 0; i < writeConcernKeys.length; i++) {\n    if (targetOptions[writeConcernKeys[i]]) {\n      found = true;\n      break;\n    }\n  }\n\n  if (!found) {\n    for (var i = 0; i < writeConcernKeys.length; i++) {\n      if (sourceOptions[writeConcernKeys[i]]) {\n        targetOptions[writeConcernKeys[i]] = sourceOptions[writeConcernKeys[i]];\n      }\n    }\n  }\n\n  return targetOptions;\n};\n\nexports.filterOptions = filterOptions;\nexports.mergeOptions = mergeOptions;\nexports.translateOptions = translateOptions;\nexports.shallowClone = shallowClone;\nexports.getSingleProperty = getSingleProperty;\nexports.checkCollectionName = checkCollectionName;\nexports.toError = toError;\nexports.formattedOrderClause = formattedOrderClause;\nexports.parseIndexOptions = parseIndexOptions;\nexports.normalizeHintField = normalizeHintField;\nexports.handleCallback = handleCallback;\nexports.decorateCommand = decorateCommand;\nexports.isObject = isObject;\nexports.debugOptions = debugOptions;\nexports.MAX_JS_INT = 0x20000000000000;\nexports.assign = assign;\nexports.mergeOptionsAndWriteConcern = mergeOptionsAndWriteConcern;\nexports.getReadPreference = getReadPreference;\n\n//# sourceMappingURL=utils-compiled.js.map"]}